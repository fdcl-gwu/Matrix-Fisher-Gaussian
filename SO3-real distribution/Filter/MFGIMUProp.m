function [ MFGtdt ] = MFGIMUProp( omega, a, MFG, H, dt )
% disassemble variables
Miu = MFG.Miu;
Sigma = MFG.Sigma;
P = MFG.P;
U = MFG.U;
S = MFG.S;
V = MFG.V;

Hgu = H.Hgu;
Hgv = H.Hgv;
Hau = H.Hau;
Hav = H.Hav;

Ggu = Hgu*Hgu';
Ggv = Hgv*Hgv';
Gau = Hau*Hau';
Gav = Hav*Hav';

Miubg = Miu(1:3);
Miup = Miu(4:6);
Miuv = Miu(7:9);
Miuba = Miu(10:12);

Pbg = P(1:3,:);
Pp = P(4:6,:);
Pv = P(7:9,:);
Pba = P(10:12,:);

s = diag(S);
[EQ,EQQ,EQQQ] = pdf_MF_moment123(s);

%% E[R(t+dt)]
ERt = U*EQ*V';

EQ1a(1,1) = (V(3,2)*P(2,3)-V(2,2)*P(3,3))*EQ(2,2)+(V(2,3)*P(3,2)-V(3,3)*P(2,2))*EQ(3,3);
EQ1a(1,2) = (V(1,2)*P(3,3)-V(3,2)*P(1,3))*EQ(2,2)+(V(3,3)*P(1,2)-V(1,3)*P(3,2))*EQ(3,3);
EQ1a(1,3) = (V(2,2)*P(1,3)-V(1,2)*P(2,3))*EQ(2,2)+(V(1,3)*P(2,2)-V(2,3)*P(1,2))*EQ(3,3);
EQ1a(2,1) = (V(2,1)*P(3,3)-V(3,1)*P(2,3))*EQ(1,1)+(V(3,3)*P(2,1)-V(2,3)*P(3,1))*EQ(3,3);
EQ1a(2,2) = (V(3,1)*P(1,3)-V(1,1)*P(3,3))*EQ(1,1)+(V(1,3)*P(3,1)-V(3,3)*P(1,1))*EQ(3,3);
EQ1a(2,3) = (V(1,1)*P(2,3)-V(2,1)*P(1,3))*EQ(1,1)+(V(2,3)*P(1,1)-V(1,3)*P(2,1))*EQ(3,3);
EQ1a(3,1) = (V(3,1)*P(2,2)-V(2,1)*P(3,2))*EQ(1,1)+(V(2,2)*P(3,1)-V(3,2)*P(2,1))*EQ(2,2);
EQ1a(3,2) = (V(1,1)*P(3,2)-V(3,1)*P(1,2))*EQ(1,1)+(V(3,2)*P(1,1)-V(1,2)*P(3,1))*EQ(2,2);
EQ1a(3,3) = (V(2,1)*P(1,2)-V(1,1)*P(2,2))*EQ(1,1)+(V(1,2)*P(2,1)-V(2,2)*P(1,1))*EQ(2,2);
ERHatPvRt = U*EQ1a;

EHW2 = (Ggu-trace(Ggu)*eye(3))*dt;

ERtdt = (ERt*(eye(3)+EHW2/2) + dt*ERHatPvRt)*expRot((omega+Miubg)*dt);

[Utdt,D,Vtdt] = psvd(ERtdt);
Stdt = diag(pdf_MF_M2S(diag(D)));

MFGtdt.U = Utdt;
MFGtdt.S = Stdt;
MFGtdt.V = Vtdt;

%% E[x(t+dt)]
Ebgtdt = Miubg;
Eptdt = Miup + dt*Miuv;
Ebatdt = Miuba;

VPba = V'*Pba;
ERPbavRt(1,1) = (-VPba(2,3)*s(2))*EQQ(2,2) +(VPba(2,3)*s(1))*EQQ(2,4) +(VPba(3,2)*s(3))*EQQ(3,3) +(-VPba(3,2)*s(1))*EQQ(3,7);
ERPbavRt(2,1) = (VPba(1,3)*s(1))*EQQ(2,2) +(-VPba(1,3)*s(2))*EQQ(2,4) +(-VPba(3,1)*s(3))*EQQ(6,6) +(VPba(3,1)*s(2))*EQQ(6,8);
ERPbavRt(3,1) = (-VPba(1,2)*s(1))*EQQ(3,3) +(VPba(1,2)*s(3))*EQQ(3,7) +(VPba(2,1)*s(2))*EQQ(6,6) +(-VPba(2,1)*s(3))*EQQ(6,8);
ERPbavRt = U*ERPbavRt;

Evtdt = Miuv + ERt*(a+Miuba)*dt + ERPbavRt*dt;

Extdt = [Ebgtdt;Eptdt;Evtdt;Ebatdt];

%% E[x(t+dt)v'R(t+dt)]
UT = Utdt'*U;
VT = Vtdt'*expRot((omega+Miubg)*dt)'*V;
ST = UT'*Stdt*VT;

VTT = Vtdt'*expRot((omega+Miubg)*dt)'*Ggu'*V;
STT = UT'*Stdt*VTT;

EvRdRpt = UT*vee(EQ*ST'-ST*EQ');

EvRvRdRpt = [ST(2,2)*EQ(2,2)+ST(3,3)*EQ(3,3), -ST(1,2)*EQ(2,2), -ST(1,3)*EQ(3,3)
    -ST(2,1)*EQ(1,1), ST(1,1)*EQ(1,1)+ST(3,3)*EQ(3,3), -ST(2,3)*EQ(3,3)
    -ST(3,1)*EQ(1,1), -ST(3,2)*EQ(2,2), ST(1,1)*EQ(1,1)+ST(2,2)*EQ(2,2)];
EvRvRdRpt = EvRvRdRpt*UT';

% ExvRdRptdt
EbgvRdRpt = Miubg*EvRdRpt' + Pbg*EvRvRdRpt;
EpvRdRpt = Miup*EvRdRpt' + Pp*EvRvRdRpt;
EvvRdRpt = Miuv*EvRdRpt' + Pv*EvRvRdRpt;
EbavRdRpt = Miuba*EvRdRpt' + Pba*EvRvRdRpt;

Va = V'*(a+Miuba);
ERavRdRpt(1,1) = (-ST(3,2)*Va(1))*EQQ(1,5) +(ST(2,3)*Va(1))*EQQ(1,9) +(-ST(3,1)*Va(2))*EQQ(2,4) +(ST(2,1)*Va(3))*EQQ(3,7);
ERavRdRpt(1,2) = (ST(3,1)*Va(1))*EQQ(1,1) +(-ST(1,3)*Va(1))*EQQ(1,9) +(ST(3,2)*Va(2))*EQQ(2,2) +(ST(3,3)*Va(3))*EQQ(3,3) +(-ST(1,1)*Va(3))*EQQ(3,7);
ERavRdRpt(1,3) = (-ST(2,1)*Va(1))*EQQ(1,1) +(ST(1,2)*Va(1))*EQQ(1,5) +(-ST(2,2)*Va(2))*EQQ(2,2) +(ST(1,1)*Va(2))*EQQ(2,4) +(-ST(2,3)*Va(3))*EQQ(3,3);
ERavRdRpt(2,1) = (-ST(3,2)*Va(2))*EQQ(5,5) +(ST(2,3)*Va(2))*EQQ(5,9) +(-ST(3,1)*Va(1))*EQQ(2,2) +(-ST(3,3)*Va(3))*EQQ(6,6) +(ST(2,2)*Va(3))*EQQ(6,8);
ERavRdRpt(2,2) = (ST(3,1)*Va(2))*EQQ(1,5) +(-ST(1,3)*Va(2))*EQQ(5,9) +(ST(3,2)*Va(1))*EQQ(2,4) +(-ST(1,2)*Va(3))*EQQ(6,8);
ERavRdRpt(2,3) = (-ST(2,1)*Va(2))*EQQ(1,5) +(ST(1,2)*Va(2))*EQQ(5,5) +(ST(1,1)*Va(1))*EQQ(2,2) +(-ST(2,2)*Va(1))*EQQ(2,4) +(ST(1,3)*Va(3))*EQQ(6,6);
ERavRdRpt(3,1) = (-ST(3,2)*Va(3))*EQQ(5,9) +(ST(2,3)*Va(3))*EQQ(9,9) +(ST(2,1)*Va(1))*EQQ(3,3) +(ST(2,2)*Va(2))*EQQ(6,6) +(-ST(3,3)*Va(2))*EQQ(6,8);
ERavRdRpt(3,2) = (ST(3,1)*Va(3))*EQQ(1,9) +(-ST(1,3)*Va(3))*EQQ(9,9) +(-ST(1,1)*Va(1))*EQQ(3,3) +(ST(3,3)*Va(1))*EQQ(3,7) +(-ST(1,2)*Va(2))*EQQ(6,6);
ERavRdRpt(3,3) = (-ST(2,1)*Va(3))*EQQ(1,9) +(ST(1,2)*Va(3))*EQQ(5,9) +(-ST(2,3)*Va(1))*EQQ(3,7) +(ST(1,3)*Va(2))*EQQ(6,8);
ERavRdRpt = U*ERavRdRpt*UT';

VPba = V'*Pba;
ERPbavRvRdRpt(1,1) = (-ST(3,1)*VPba(1,3)*s(1))*EQQQ(1,2,2) +(ST(3,1)*VPba(1,3)*s(2))*EQQQ(1,2,4) +(-ST(2,1)*VPba(1,2)*s(1))*EQQQ(1,3,3) +(ST(2,1)*VPba(1,2)*s(3))*EQQQ(1,3,7) +(ST(2,2)*VPba(1,1)*s(2)+ST(3,3)*VPba(1,1)*s(3))*EQQQ(1,6,6) +(-ST(2,2)*VPba(1,1)*s(3)-ST(3,3)*VPba(1,1)*s(2))*EQQQ(1,6,8) +(ST(3,2)*VPba(2,3)*s(2))*EQQQ(5,2,2) +(-ST(3,2)*VPba(2,3)*s(1))*EQQQ(5,2,4) +(-ST(3,2)*VPba(3,2)*s(3))*EQQQ(5,3,3) +(ST(3,2)*VPba(3,2)*s(1))*EQQQ(5,3,7) +(-ST(2,3)*VPba(2,3)*s(2))*EQQQ(9,2,2) +(ST(2,3)*VPba(2,3)*s(1))*EQQQ(9,2,4) +(ST(2,3)*VPba(3,2)*s(3))*EQQQ(9,3,3) +(-ST(2,3)*VPba(3,2)*s(1))*EQQQ(9,3,7) +(ST(2,2)*VPba(3,3)*s(1)-ST(2,1)*VPba(2,1)*s(3)+ST(3,3)*VPba(2,2)*s(1)-ST(3,1)*VPba(3,1)*s(2))*EQQQ(2,6,7) +(ST(2,1)*VPba(2,1)*s(2)-ST(2,2)*VPba(2,2)*s(1)+ST(3,1)*VPba(3,1)*s(3)-ST(3,3)*VPba(3,3)*s(1))*EQQQ(4,3,6) +(ST(3,3)*VPba(3,3)*s(2)-ST(3,3)*VPba(2,2)*s(3))*EQQQ(2,6,3) +(ST(2,2)*VPba(2,2)*s(3)-ST(2,2)*VPba(3,3)*s(2))*EQQQ(3,8,2);
ERPbavRvRdRpt(1,2) = (-ST(3,2)*VPba(1,3)*s(2)-ST(3,1)*VPba(2,3)*s(2))*EQQQ(1,2,2) +(ST(3,2)*VPba(1,3)*s(1)+ST(3,1)*VPba(2,3)*s(1))*EQQQ(1,2,4) +(ST(1,1)*VPba(1,2)*s(1)+ST(3,3)*VPba(1,2)*s(3)+ST(3,1)*VPba(3,2)*s(3))*EQQQ(1,3,3) +(-ST(1,1)*VPba(1,2)*s(3)-ST(3,3)*VPba(1,2)*s(1)-ST(3,1)*VPba(3,2)*s(1))*EQQQ(1,3,7) +(-ST(1,2)*VPba(1,1)*s(2))*EQQQ(1,6,6) +(ST(1,2)*VPba(1,1)*s(3))*EQQQ(1,6,8) +(ST(1,3)*VPba(2,3)*s(2))*EQQQ(9,2,2) +(-ST(1,3)*VPba(2,3)*s(1))*EQQQ(9,2,4) +(-ST(1,3)*VPba(3,2)*s(3))*EQQQ(9,3,3) +(ST(1,3)*VPba(3,2)*s(1))*EQQQ(9,3,7) +(ST(1,1)*VPba(2,1)*s(3)-ST(1,2)*VPba(3,3)*s(1))*EQQQ(2,6,7) +(ST(1,2)*VPba(2,2)*s(1)-ST(1,1)*VPba(2,1)*s(2))*EQQQ(4,3,6) +(-ST(3,3)*VPba(2,1)*s(3)-ST(3,2)*VPba(3,1)*s(3))*EQQQ(2,6,3) +(ST(1,2)*VPba(3,3)*s(2)-ST(1,2)*VPba(2,2)*s(3)+ST(3,3)*VPba(2,1)*s(2)+ST(3,2)*VPba(3,1)*s(2))*EQQQ(3,8,2);
ERPbavRvRdRpt(1,3) = (ST(1,1)*VPba(1,3)*s(1)+ST(2,2)*VPba(1,3)*s(2)+ST(2,1)*VPba(2,3)*s(2))*EQQQ(1,2,2) +(-ST(1,1)*VPba(1,3)*s(2)-ST(2,2)*VPba(1,3)*s(1)-ST(2,1)*VPba(2,3)*s(1))*EQQQ(1,2,4) +(-ST(2,3)*VPba(1,2)*s(3)-ST(2,1)*VPba(3,2)*s(3))*EQQQ(1,3,3) +(ST(2,3)*VPba(1,2)*s(1)+ST(2,1)*VPba(3,2)*s(1))*EQQQ(1,3,7) +(-ST(1,3)*VPba(1,1)*s(3))*EQQQ(1,6,6) +(ST(1,3)*VPba(1,1)*s(2))*EQQQ(1,6,8) +(-ST(1,2)*VPba(2,3)*s(2))*EQQQ(5,2,2) +(ST(1,2)*VPba(2,3)*s(1))*EQQQ(5,2,4) +(ST(1,2)*VPba(3,2)*s(3))*EQQQ(5,3,3) +(-ST(1,2)*VPba(3,2)*s(1))*EQQQ(5,3,7) +(ST(1,1)*VPba(3,1)*s(2)-ST(1,3)*VPba(2,2)*s(1))*EQQQ(2,6,7) +(ST(1,3)*VPba(3,3)*s(1)-ST(1,1)*VPba(3,1)*s(3))*EQQQ(4,3,6) +(ST(1,3)*VPba(2,2)*s(3)+ST(2,3)*VPba(2,1)*s(3)-ST(1,3)*VPba(3,3)*s(2)+ST(2,2)*VPba(3,1)*s(3))*EQQQ(2,6,3) +(-ST(2,3)*VPba(2,1)*s(2)-ST(2,2)*VPba(3,1)*s(2))*EQQQ(3,8,2);
ERPbavRvRdRpt(2,1) = (-ST(3,2)*VPba(1,3)*s(1)-ST(3,1)*VPba(2,3)*s(1))*EQQQ(5,2,2) +(ST(3,2)*VPba(1,3)*s(2)+ST(3,1)*VPba(2,3)*s(2))*EQQQ(5,2,4) +(-ST(2,1)*VPba(2,2)*s(1))*EQQQ(5,3,3) +(ST(2,1)*VPba(2,2)*s(3))*EQQQ(5,3,7) +(ST(2,2)*VPba(2,1)*s(2)+ST(3,3)*VPba(2,1)*s(3)+ST(3,2)*VPba(3,1)*s(3))*EQQQ(5,6,6) +(-ST(2,2)*VPba(2,1)*s(3)-ST(3,3)*VPba(2,1)*s(2)-ST(3,2)*VPba(3,1)*s(2))*EQQQ(5,6,8) +(ST(2,3)*VPba(1,3)*s(1))*EQQQ(9,2,2) +(-ST(2,3)*VPba(1,3)*s(2))*EQQQ(9,2,4) +(-ST(2,3)*VPba(3,1)*s(3))*EQQQ(9,6,6) +(ST(2,3)*VPba(3,1)*s(2))*EQQQ(9,6,8) +(ST(2,2)*VPba(1,2)*s(3)-ST(2,1)*VPba(3,3)*s(2))*EQQQ(2,6,7) +(-ST(3,3)*VPba(1,2)*s(3)-ST(3,1)*VPba(3,2)*s(3))*EQQQ(4,3,6) +(ST(2,1)*VPba(1,1)*s(2)-ST(2,2)*VPba(1,2)*s(1))*EQQQ(2,6,3) +(ST(3,3)*VPba(1,2)*s(1)-ST(2,1)*VPba(1,1)*s(3)+ST(2,1)*VPba(3,3)*s(1)+ST(3,1)*VPba(3,2)*s(1))*EQQQ(3,8,2);
ERPbavRvRdRpt(2,2) = (ST(3,1)*VPba(1,3)*s(1))*EQQQ(1,2,2) +(-ST(3,1)*VPba(1,3)*s(2))*EQQQ(1,2,4) +(-ST(3,1)*VPba(3,1)*s(3))*EQQQ(1,6,6) +(ST(3,1)*VPba(3,1)*s(2))*EQQQ(1,6,8) +(-ST(3,2)*VPba(2,3)*s(2))*EQQQ(5,2,2) +(ST(3,2)*VPba(2,3)*s(1))*EQQQ(5,2,4) +(ST(1,1)*VPba(2,2)*s(1)+ST(3,3)*VPba(2,2)*s(3))*EQQQ(5,3,3) +(-ST(1,1)*VPba(2,2)*s(3)-ST(3,3)*VPba(2,2)*s(1))*EQQQ(5,3,7) +(-ST(1,2)*VPba(2,1)*s(2))*EQQQ(5,6,6) +(ST(1,2)*VPba(2,1)*s(3))*EQQQ(5,6,8) +(-ST(1,3)*VPba(1,3)*s(1))*EQQQ(9,2,2) +(ST(1,3)*VPba(1,3)*s(2))*EQQQ(9,2,4) +(ST(1,3)*VPba(3,1)*s(3))*EQQQ(9,6,6) +(-ST(1,3)*VPba(3,1)*s(2))*EQQQ(9,6,8) +(ST(1,1)*VPba(3,3)*s(2)-ST(1,2)*VPba(1,2)*s(3)+ST(3,3)*VPba(1,1)*s(2)-ST(3,2)*VPba(3,2)*s(1))*EQQQ(2,6,7) +(ST(3,3)*VPba(3,3)*s(1)-ST(3,3)*VPba(1,1)*s(3))*EQQQ(4,3,6) +(ST(1,2)*VPba(1,2)*s(1)-ST(1,1)*VPba(1,1)*s(2)+ST(3,2)*VPba(3,2)*s(3)-ST(3,3)*VPba(3,3)*s(2))*EQQQ(2,6,3) +(ST(1,1)*VPba(1,1)*s(3)-ST(1,1)*VPba(3,3)*s(1))*EQQQ(3,8,2);
ERPbavRvRdRpt(2,3) = (-ST(2,1)*VPba(1,3)*s(1))*EQQQ(1,2,2) +(ST(2,1)*VPba(1,3)*s(2))*EQQQ(1,2,4) +(ST(2,1)*VPba(3,1)*s(3))*EQQQ(1,6,6) +(-ST(2,1)*VPba(3,1)*s(2))*EQQQ(1,6,8) +(ST(1,2)*VPba(1,3)*s(1)+ST(1,1)*VPba(2,3)*s(1)+ST(2,2)*VPba(2,3)*s(2))*EQQQ(5,2,2) +(-ST(1,2)*VPba(1,3)*s(2)-ST(1,1)*VPba(2,3)*s(2)-ST(2,2)*VPba(2,3)*s(1))*EQQQ(5,2,4) +(-ST(2,3)*VPba(2,2)*s(3))*EQQQ(5,3,3) +(ST(2,3)*VPba(2,2)*s(1))*EQQQ(5,3,7) +(-ST(1,3)*VPba(2,1)*s(3)-ST(1,2)*VPba(3,1)*s(3))*EQQQ(5,6,6) +(ST(1,3)*VPba(2,1)*s(2)+ST(1,2)*VPba(3,1)*s(2))*EQQQ(5,6,8) +(ST(2,2)*VPba(3,2)*s(1)-ST(2,3)*VPba(1,1)*s(2))*EQQQ(2,6,7) +(ST(1,3)*VPba(1,2)*s(3)+ST(2,3)*VPba(1,1)*s(3)+ST(1,1)*VPba(3,2)*s(3)-ST(2,3)*VPba(3,3)*s(1))*EQQQ(4,3,6) +(ST(2,3)*VPba(3,3)*s(2)-ST(2,2)*VPba(3,2)*s(3))*EQQQ(2,6,3) +(-ST(1,3)*VPba(1,2)*s(1)-ST(1,1)*VPba(3,2)*s(1))*EQQQ(3,8,2);
ERPbavRvRdRpt(3,1) = (ST(3,2)*VPba(1,2)*s(1))*EQQQ(5,3,3) +(-ST(3,2)*VPba(1,2)*s(3))*EQQQ(5,3,7) +(-ST(3,2)*VPba(2,1)*s(2))*EQQQ(5,6,6) +(ST(3,2)*VPba(2,1)*s(3))*EQQQ(5,6,8) +(-ST(3,1)*VPba(3,3)*s(1))*EQQQ(9,2,2) +(ST(3,1)*VPba(3,3)*s(2))*EQQQ(9,2,4) +(-ST(2,3)*VPba(1,2)*s(1)-ST(2,1)*VPba(3,2)*s(1))*EQQQ(9,3,3) +(ST(2,3)*VPba(1,2)*s(3)+ST(2,1)*VPba(3,2)*s(3))*EQQQ(9,3,7) +(ST(2,3)*VPba(2,1)*s(2)+ST(2,2)*VPba(3,1)*s(2)+ST(3,3)*VPba(3,1)*s(3))*EQQQ(9,6,6) +(-ST(2,3)*VPba(2,1)*s(3)-ST(2,2)*VPba(3,1)*s(3)-ST(3,3)*VPba(3,1)*s(2))*EQQQ(9,6,8) +(ST(3,3)*VPba(1,3)*s(2)-ST(3,1)*VPba(2,2)*s(3))*EQQQ(2,6,7) +(-ST(2,2)*VPba(1,3)*s(2)-ST(2,1)*VPba(2,3)*s(2))*EQQQ(4,3,6) +(ST(2,2)*VPba(1,3)*s(1)-ST(3,1)*VPba(1,1)*s(2)+ST(2,1)*VPba(2,3)*s(1)+ST(3,1)*VPba(2,2)*s(1))*EQQQ(2,6,3) +(ST(3,1)*VPba(1,1)*s(3)-ST(3,3)*VPba(1,3)*s(1))*EQQQ(3,8,2);
ERPbavRvRdRpt(3,2) = (-ST(3,1)*VPba(1,2)*s(1))*EQQQ(1,3,3) +(ST(3,1)*VPba(1,2)*s(3))*EQQQ(1,3,7) +(ST(3,1)*VPba(2,1)*s(2))*EQQQ(1,6,6) +(-ST(3,1)*VPba(2,1)*s(3))*EQQQ(1,6,8) +(-ST(3,2)*VPba(3,3)*s(2))*EQQQ(9,2,2) +(ST(3,2)*VPba(3,3)*s(1))*EQQQ(9,2,4) +(ST(1,3)*VPba(1,2)*s(1)+ST(1,1)*VPba(3,2)*s(1)+ST(3,3)*VPba(3,2)*s(3))*EQQQ(9,3,3) +(-ST(1,3)*VPba(1,2)*s(3)-ST(1,1)*VPba(3,2)*s(3)-ST(3,3)*VPba(3,2)*s(1))*EQQQ(9,3,7) +(-ST(1,3)*VPba(2,1)*s(2)-ST(1,2)*VPba(3,1)*s(2))*EQQQ(9,6,6) +(ST(1,3)*VPba(2,1)*s(3)+ST(1,2)*VPba(3,1)*s(3))*EQQQ(9,6,8) +(ST(3,3)*VPba(2,3)*s(1)-ST(3,2)*VPba(1,1)*s(3))*EQQQ(2,6,7) +(ST(1,2)*VPba(1,3)*s(2)+ST(1,1)*VPba(2,3)*s(2)+ST(3,2)*VPba(1,1)*s(2)-ST(3,2)*VPba(2,2)*s(1))*EQQQ(4,3,6) +(-ST(1,2)*VPba(1,3)*s(1)-ST(1,1)*VPba(2,3)*s(1))*EQQQ(2,6,3) +(ST(3,2)*VPba(2,2)*s(3)-ST(3,3)*VPba(2,3)*s(2))*EQQQ(3,8,2);
ERPbavRvRdRpt(3,3) = (ST(2,1)*VPba(1,2)*s(1))*EQQQ(1,3,3) +(-ST(2,1)*VPba(1,2)*s(3))*EQQQ(1,3,7) +(-ST(2,1)*VPba(2,1)*s(2))*EQQQ(1,6,6) +(ST(2,1)*VPba(2,1)*s(3))*EQQQ(1,6,8) +(-ST(1,2)*VPba(1,2)*s(1))*EQQQ(5,3,3) +(ST(1,2)*VPba(1,2)*s(3))*EQQQ(5,3,7) +(ST(1,2)*VPba(2,1)*s(2))*EQQQ(5,6,6) +(-ST(1,2)*VPba(2,1)*s(3))*EQQQ(5,6,8) +(ST(1,1)*VPba(3,3)*s(1)+ST(2,2)*VPba(3,3)*s(2))*EQQQ(9,2,2) +(-ST(1,1)*VPba(3,3)*s(2)-ST(2,2)*VPba(3,3)*s(1))*EQQQ(9,2,4) +(-ST(2,3)*VPba(3,2)*s(3))*EQQQ(9,3,3) +(ST(2,3)*VPba(3,2)*s(1))*EQQQ(9,3,7) +(-ST(1,3)*VPba(3,1)*s(3))*EQQQ(9,6,6) +(ST(1,3)*VPba(3,1)*s(2))*EQQQ(9,6,8) +(ST(1,1)*VPba(2,2)*s(3)-ST(1,3)*VPba(1,3)*s(2)+ST(2,2)*VPba(1,1)*s(3)-ST(2,3)*VPba(2,3)*s(1))*EQQQ(2,6,7) +(ST(2,2)*VPba(2,2)*s(1)-ST(2,2)*VPba(1,1)*s(2))*EQQQ(4,3,6) +(ST(1,1)*VPba(1,1)*s(2)-ST(1,1)*VPba(2,2)*s(1))*EQQQ(2,6,3) +(ST(1,3)*VPba(1,3)*s(1)-ST(1,1)*VPba(1,1)*s(3)-ST(2,2)*VPba(2,2)*s(3)+ST(2,3)*VPba(2,3)*s(2))*EQQQ(3,8,2);
ERPbavRvRdRpt = U*ERPbavRvRdRpt*UT';

EbgvRdRptdt = EbgvRdRpt;
EpvRdRptdt = EpvRdRpt + dt*EvvRdRpt;
EvvRdRptdt = EvvRdRpt + dt*ERavRdRpt + dt*ERPbavRvRdRpt;
EbavRdRptdt = EbavRdRpt;

ExvRdRptdt = [EbgvRdRptdt;EpvRdRptdt;EvvRdRptdt;EbavRdRptdt];

% ExvRhatbdRptdt
EGQt = [ST(2,2)*EQ(3,3)+ST(3,3)*EQ(2,2), -ST(1,2)*EQ(3,3), -ST(1,3)*EQ(2,2);
      -ST(2,1)*EQ(3,3), ST(1,1)*EQ(3,3)+ST(3,3)*EQ(1,1), -ST(2,3)*EQ(1,1);
      -ST(3,1)*EQ(2,2), -ST(3,2)*EQ(1,1), ST(1,1)*EQ(2,2)+ST(2,2)*EQ(1,1)];

PV = Pbg'*V;
EvRPbgVGQt(1) = (PV(3,3)*ST(3,2)+PV(2,3)*ST(2,2)-PV(3,2)*ST(3,3)-PV(2,2)*ST(2,3))*EQ(1,1)...
    +(PV(1,3)*ST(2,1)-PV(1,1)*ST(2,3))*EQ(2,2)+(PV(1,1)*ST(3,2)-PV(1,2)*ST(3,1))*EQ(3,3);
EvRPbgVGQt(2) = (PV(1,1)*ST(1,3)+PV(3,1)*ST(3,3)-PV(1,3)*ST(1,1)-PV(3,3)*ST(3,1))*EQ(2,2)...
    +(PV(2,1)*ST(3,2)-PV(2,2)*ST(3,1))*EQ(3,3)+(PV(2,2)*ST(1,3)-PV(2,3)*ST(1,2))*EQ(1,1);
EvRPbgVGQt(3) = (PV(2,2)*ST(2,1)+PV(1,2)*ST(1,1)-PV(2,1)*ST(2,2)-PV(1,1)*ST(1,2))*EQ(3,3)...
    +(PV(3,2)*ST(1,3)-PV(3,3)*ST(1,2))*EQ(1,1)+(PV(3,3)*ST(2,1)-PV(3,1)*ST(2,3))*EQ(2,2);

EvRvRPbgVGQt(1,1) = (PV(1,1)*ST(3,3)*s(2)^2-PV(1,3)*ST(3,1)*s(2)^2+PV(1,1)*ST(3,3)*s(3)^2-PV(1,3)*ST(3,1)*s(3)^2)*EQQQ(5,6,6)...
    +(2*PV(1,3)*ST(3,1)*s(2)*s(3)-2*PV(1,1)*ST(3,3)*s(2)*s(3))*EQQQ(5,6,8)...
    +(PV(1,1)*ST(2,2)*s(2)^2-PV(1,2)*ST(2,1)*s(2)^2+PV(1,1)*ST(2,2)*s(3)^2-PV(1,2)*ST(2,1)*s(3)^2)*EQQQ(9,6,6)...
    +(2*PV(1,2)*ST(2,1)*s(2)*s(3)-2*PV(1,1)*ST(2,2)*s(2)*s(3))*EQQQ(9,6,8)...
    +(PV(2,3)*ST(3,2)*s(2)*s(3)-PV(2,2)*ST(3,3)*s(2)*s(3)+PV(3,2)*ST(2,3)*s(2)*s(3)-PV(3,3)*ST(2,2)*s(2)*s(3))*EQQQ(2,6,7)...
    +(PV(3,3)*ST(2,2)*s(2)^2-PV(3,2)*ST(2,3)*s(2)^2+PV(2,2)*ST(3,3)*s(3)^2-PV(2,3)*ST(3,2)*s(3)^2)*EQQQ(4,3,6)...
    +(PV(2,2)*ST(3,3)*s(1)*s(2)-PV(2,3)*ST(3,2)*s(1)*s(2)+PV(3,2)*ST(2,3)*s(1)*s(2)-PV(3,3)*ST(2,2)*s(1)*s(2))*EQQQ(2,6,3)...
    +(PV(2,3)*ST(3,2)*s(1)*s(3)-PV(2,2)*ST(3,3)*s(1)*s(3)-PV(3,2)*ST(2,3)*s(1)*s(3)+PV(3,3)*ST(2,2)*s(1)*s(3))*EQQQ(3,8,2);
EvRvRPbgVGQt(1,2) = (PV(1,2)*ST(3,3)*s(2)^2-PV(1,3)*ST(3,2)*s(2)^2+PV(1,2)*ST(3,3)*s(3)^2-PV(1,3)*ST(3,2)*s(3)^2)*EQQQ(1,6,6)...
    +(2*PV(1,3)*ST(3,2)*s(2)*s(3)-2*PV(1,2)*ST(3,3)*s(2)*s(3))*EQQQ(1,6,8)...
    +(PV(1,2)*ST(1,1)*s(2)^2-PV(1,1)*ST(1,2)*s(2)^2-PV(1,1)*ST(1,2)*s(3)^2+PV(1,2)*ST(1,1)*s(3)^2)*EQQQ(9,6,6)...
    +(2*PV(1,1)*ST(1,2)*s(2)*s(3)-2*PV(1,2)*ST(1,1)*s(2)*s(3))*EQQQ(9,6,8)...
    +(PV(3,3)*ST(1,2)*s(2)*s(3)-PV(3,2)*ST(1,3)*s(2)*s(3)-PV(2,1)*ST(3,3)*s(1)*s(3)+PV(2,3)*ST(3,1)*s(1)*s(3)+PV(3,1)*ST(3,2)*s(1)*s(2)-PV(3,2)*ST(3,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(3,2)*ST(1,3)*s(2)^2-PV(3,3)*ST(1,2)*s(2)^2+PV(2,1)*ST(3,3)*s(1)*s(2)-PV(2,3)*ST(3,1)*s(1)*s(2)-PV(3,1)*ST(3,2)*s(1)*s(3)+PV(3,2)*ST(3,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(2,1)*ST(3,3)*s(3)^2-PV(2,3)*ST(3,1)*s(3)^2-PV(3,2)*ST(1,3)*s(1)*s(2)+PV(3,3)*ST(1,2)*s(1)*s(2)+PV(3,1)*ST(3,2)*s(2)*s(3)-PV(3,2)*ST(3,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(3,2)*ST(3,1)*s(2)^2-PV(3,1)*ST(3,2)*s(2)^2+PV(3,2)*ST(1,3)*s(1)*s(3)-PV(3,3)*ST(1,2)*s(1)*s(3)-PV(2,1)*ST(3,3)*s(2)*s(3)+PV(2,3)*ST(3,1)*s(2)*s(3))*EQQQ(3,8,2);
EvRvRPbgVGQt(1,3) = (PV(1,3)*ST(2,2)*s(2)^2-PV(1,2)*ST(2,3)*s(2)^2-PV(1,2)*ST(2,3)*s(3)^2+PV(1,3)*ST(2,2)*s(3)^2)*EQQQ(1,6,6)...
    +(2*PV(1,2)*ST(2,3)*s(2)*s(3)-2*PV(1,3)*ST(2,2)*s(2)*s(3))*EQQQ(1,6,8)...
    +(PV(1,3)*ST(1,1)*s(2)^2-PV(1,1)*ST(1,3)*s(2)^2-PV(1,1)*ST(1,3)*s(3)^2+PV(1,3)*ST(1,1)*s(3)^2)*EQQQ(5,6,6)...
    +(2*PV(1,1)*ST(1,3)*s(2)*s(3)-2*PV(1,3)*ST(1,1)*s(2)*s(3))*EQQQ(5,6,8)...
    +(PV(2,2)*ST(1,3)*s(2)*s(3)-PV(2,3)*ST(1,2)*s(2)*s(3)+PV(2,1)*ST(2,3)*s(1)*s(3)-PV(2,3)*ST(2,1)*s(1)*s(3)-PV(3,1)*ST(2,2)*s(1)*s(2)+PV(3,2)*ST(2,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(2,3)*ST(1,2)*s(3)^2-PV(2,2)*ST(1,3)*s(3)^2-PV(2,1)*ST(2,3)*s(1)*s(2)+PV(2,3)*ST(2,1)*s(1)*s(2)+PV(3,1)*ST(2,2)*s(1)*s(3)-PV(3,2)*ST(2,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(2,3)*ST(2,1)*s(3)^2-PV(2,1)*ST(2,3)*s(3)^2-PV(2,2)*ST(1,3)*s(1)*s(2)+PV(2,3)*ST(1,2)*s(1)*s(2)-PV(3,1)*ST(2,2)*s(2)*s(3)+PV(3,2)*ST(2,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(3,1)*ST(2,2)*s(2)^2-PV(3,2)*ST(2,1)*s(2)^2+PV(2,2)*ST(1,3)*s(1)*s(3)-PV(2,3)*ST(1,2)*s(1)*s(3)+PV(2,1)*ST(2,3)*s(2)*s(3)-PV(2,3)*ST(2,1)*s(2)*s(3))*EQQQ(3,8,2);
EvRvRPbgVGQt(2,1) = (PV(2,1)*ST(3,3)*s(1)^2-PV(2,3)*ST(3,1)*s(1)^2+PV(2,1)*ST(3,3)*s(3)^2-PV(2,3)*ST(3,1)*s(3)^2)*EQQQ(5,3,3)...
    +(2*PV(2,3)*ST(3,1)*s(1)*s(3)-2*PV(2,1)*ST(3,3)*s(1)*s(3))*EQQQ(5,3,7)...
    +(PV(2,1)*ST(2,2)*s(1)^2-PV(2,2)*ST(2,1)*s(1)^2+PV(2,1)*ST(2,2)*s(3)^2-PV(2,2)*ST(2,1)*s(3)^2)*EQQQ(9,3,3)...
    +(2*PV(2,2)*ST(2,1)*s(1)*s(3)-2*PV(2,1)*ST(2,2)*s(1)*s(3))*EQQQ(9,3,7)...
    +(PV(1,3)*ST(3,2)*s(2)*s(3)-PV(1,2)*ST(3,3)*s(2)*s(3)-PV(3,1)*ST(2,3)*s(1)*s(3)+PV(3,3)*ST(2,1)*s(1)*s(3)-PV(3,1)*ST(3,2)*s(1)*s(2)+PV(3,2)*ST(3,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(1,2)*ST(3,3)*s(3)^2-PV(1,3)*ST(3,2)*s(3)^2-PV(3,1)*ST(2,3)*s(1)*s(2)+PV(3,3)*ST(2,1)*s(1)*s(2)-PV(3,1)*ST(3,2)*s(1)*s(3)+PV(3,2)*ST(3,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(3,1)*ST(2,3)*s(1)^2-PV(3,3)*ST(2,1)*s(1)^2+PV(1,2)*ST(3,3)*s(1)*s(2)-PV(1,3)*ST(3,2)*s(1)*s(2)+PV(3,1)*ST(3,2)*s(2)*s(3)-PV(3,2)*ST(3,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(3,1)*ST(3,2)*s(1)^2-PV(3,2)*ST(3,1)*s(1)^2-PV(1,2)*ST(3,3)*s(1)*s(3)+PV(1,3)*ST(3,2)*s(1)*s(3)+PV(3,1)*ST(2,3)*s(2)*s(3)-PV(3,3)*ST(2,1)*s(2)*s(3))*EQQQ(3,8,2);
EvRvRPbgVGQt(2,2) = (PV(2,2)*ST(3,3)*s(1)^2-PV(2,3)*ST(3,2)*s(1)^2+PV(2,2)*ST(3,3)*s(3)^2-PV(2,3)*ST(3,2)*s(3)^2)*EQQQ(1,3,3)...
    +(2*PV(2,3)*ST(3,2)*s(1)*s(3)-2*PV(2,2)*ST(3,3)*s(1)*s(3))*EQQQ(1,3,7)...
    +(PV(2,2)*ST(1,1)*s(1)^2-PV(2,1)*ST(1,2)*s(1)^2-PV(2,1)*ST(1,2)*s(3)^2+PV(2,2)*ST(1,1)*s(3)^2)*EQQQ(9,3,3)...
    +(2*PV(2,1)*ST(1,2)*s(1)*s(3)-2*PV(2,2)*ST(1,1)*s(1)*s(3))*EQQQ(9,3,7)...
    +(PV(1,3)*ST(3,1)*s(1)*s(3)-PV(1,1)*ST(3,3)*s(1)*s(3)+PV(3,1)*ST(1,3)*s(1)*s(3)-PV(3,3)*ST(1,1)*s(1)*s(3))*EQQQ(2,6,7)...
    +(PV(1,1)*ST(3,3)*s(1)*s(2)-PV(1,3)*ST(3,1)*s(1)*s(2)+PV(3,1)*ST(1,3)*s(1)*s(2)-PV(3,3)*ST(1,1)*s(1)*s(2))*EQQQ(4,3,6)...
    +(PV(3,3)*ST(1,1)*s(1)^2-PV(3,1)*ST(1,3)*s(1)^2+PV(1,1)*ST(3,3)*s(3)^2-PV(1,3)*ST(3,1)*s(3)^2)*EQQQ(2,6,3)...
    +(PV(1,3)*ST(3,1)*s(2)*s(3)-PV(1,1)*ST(3,3)*s(2)*s(3)-PV(3,1)*ST(1,3)*s(2)*s(3)+PV(3,3)*ST(1,1)*s(2)*s(3))*EQQQ(3,8,2);
EvRvRPbgVGQt(2,3) = (PV(2,3)*ST(2,2)*s(1)^2-PV(2,2)*ST(2,3)*s(1)^2-PV(2,2)*ST(2,3)*s(3)^2+PV(2,3)*ST(2,2)*s(3)^2)*EQQQ(1,3,3)...
    +(2*PV(2,2)*ST(2,3)*s(1)*s(3)-2*PV(2,3)*ST(2,2)*s(1)*s(3))*EQQQ(1,3,7)...
    +(PV(2,3)*ST(1,1)*s(1)^2-PV(2,1)*ST(1,3)*s(1)^2-PV(2,1)*ST(1,3)*s(3)^2+PV(2,3)*ST(1,1)*s(3)^2)*EQQQ(5,3,3)...
    +(2*PV(2,1)*ST(1,3)*s(1)*s(3)-2*PV(2,3)*ST(1,1)*s(1)*s(3))*EQQQ(5,3,7)...
    +(PV(1,2)*ST(1,3)*s(2)*s(3)-PV(1,3)*ST(1,2)*s(2)*s(3)+PV(1,1)*ST(2,3)*s(1)*s(3)-PV(1,3)*ST(2,1)*s(1)*s(3)+PV(3,1)*ST(1,2)*s(1)*s(2)-PV(3,2)*ST(1,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(1,3)*ST(1,2)*s(3)^2-PV(1,2)*ST(1,3)*s(3)^2-PV(1,1)*ST(2,3)*s(1)*s(2)+PV(1,3)*ST(2,1)*s(1)*s(2)+PV(3,1)*ST(1,2)*s(1)*s(3)-PV(3,2)*ST(1,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(1,3)*ST(2,1)*s(3)^2-PV(1,1)*ST(2,3)*s(3)^2-PV(1,2)*ST(1,3)*s(1)*s(2)+PV(1,3)*ST(1,2)*s(1)*s(2)-PV(3,1)*ST(1,2)*s(2)*s(3)+PV(3,2)*ST(1,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(3,2)*ST(1,1)*s(1)^2-PV(3,1)*ST(1,2)*s(1)^2+PV(1,2)*ST(1,3)*s(1)*s(3)-PV(1,3)*ST(1,2)*s(1)*s(3)+PV(1,1)*ST(2,3)*s(2)*s(3)-PV(1,3)*ST(2,1)*s(2)*s(3))*EQQQ(3,8,2);
EvRvRPbgVGQt(3,1) = (PV(3,1)*ST(3,3)*s(1)^2-PV(3,3)*ST(3,1)*s(1)^2+PV(3,1)*ST(3,3)*s(2)^2-PV(3,3)*ST(3,1)*s(2)^2)*EQQQ(5,2,2)...
    +(2*PV(3,3)*ST(3,1)*s(1)*s(2)-2*PV(3,1)*ST(3,3)*s(1)*s(2))*EQQQ(5,2,4)...
    +(PV(3,1)*ST(2,2)*s(1)^2-PV(3,2)*ST(2,1)*s(1)^2+PV(3,1)*ST(2,2)*s(2)^2-PV(3,2)*ST(2,1)*s(2)^2)*EQQQ(9,2,2)...
    +(2*PV(3,2)*ST(2,1)*s(1)*s(2)-2*PV(3,1)*ST(2,2)*s(1)*s(2))*EQQQ(9,2,4)...
    +(PV(1,2)*ST(2,3)*s(2)*s(3)-PV(1,3)*ST(2,2)*s(2)*s(3)-PV(2,1)*ST(2,3)*s(1)*s(3)+PV(2,3)*ST(2,1)*s(1)*s(3)-PV(2,1)*ST(3,2)*s(1)*s(2)+PV(2,2)*ST(3,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(1,3)*ST(2,2)*s(2)^2-PV(1,2)*ST(2,3)*s(2)^2-PV(2,1)*ST(2,3)*s(1)*s(2)+PV(2,3)*ST(2,1)*s(1)*s(2)-PV(2,1)*ST(3,2)*s(1)*s(3)+PV(2,2)*ST(3,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(2,1)*ST(2,3)*s(1)^2-PV(2,3)*ST(2,1)*s(1)^2+PV(1,2)*ST(2,3)*s(1)*s(2)-PV(1,3)*ST(2,2)*s(1)*s(2)+PV(2,1)*ST(3,2)*s(2)*s(3)-PV(2,2)*ST(3,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(2,1)*ST(3,2)*s(1)^2-PV(2,2)*ST(3,1)*s(1)^2-PV(1,2)*ST(2,3)*s(1)*s(3)+PV(1,3)*ST(2,2)*s(1)*s(3)+PV(2,1)*ST(2,3)*s(2)*s(3)-PV(2,3)*ST(2,1)*s(2)*s(3))*EQQQ(3,8,2);
EvRvRPbgVGQt(3,2) = (PV(3,2)*ST(3,3)*s(1)^2-PV(3,3)*ST(3,2)*s(1)^2+PV(3,2)*ST(3,3)*s(2)^2-PV(3,3)*ST(3,2)*s(2)^2)*EQQQ(1,2,2)...
    +(2*PV(3,3)*ST(3,2)*s(1)*s(2)-2*PV(3,2)*ST(3,3)*s(1)*s(2))*EQQQ(1,2,4)...
    +(PV(3,2)*ST(1,1)*s(1)^2-PV(3,1)*ST(1,2)*s(1)^2-PV(3,1)*ST(1,2)*s(2)^2+PV(3,2)*ST(1,1)*s(2)^2)*EQQQ(9,2,2)...
    +(2*PV(3,1)*ST(1,2)*s(1)*s(2)-2*PV(3,2)*ST(1,1)*s(1)*s(2))*EQQQ(9,2,4)...
    +(PV(1,3)*ST(1,2)*s(2)*s(3)-PV(1,2)*ST(1,3)*s(2)*s(3)+PV(2,1)*ST(1,3)*s(1)*s(3)-PV(2,3)*ST(1,1)*s(1)*s(3)+PV(1,1)*ST(3,2)*s(1)*s(2)-PV(1,2)*ST(3,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(1,2)*ST(1,3)*s(2)^2-PV(1,3)*ST(1,2)*s(2)^2+PV(2,1)*ST(1,3)*s(1)*s(2)-PV(2,3)*ST(1,1)*s(1)*s(2)-PV(1,1)*ST(3,2)*s(1)*s(3)+PV(1,2)*ST(3,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(2,3)*ST(1,1)*s(1)^2-PV(2,1)*ST(1,3)*s(1)^2-PV(1,2)*ST(1,3)*s(1)*s(2)+PV(1,3)*ST(1,2)*s(1)*s(2)+PV(1,1)*ST(3,2)*s(2)*s(3)-PV(1,2)*ST(3,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(1,2)*ST(3,1)*s(2)^2-PV(1,1)*ST(3,2)*s(2)^2+PV(1,2)*ST(1,3)*s(1)*s(3)-PV(1,3)*ST(1,2)*s(1)*s(3)-PV(2,1)*ST(1,3)*s(2)*s(3)+PV(2,3)*ST(1,1)*s(2)*s(3))*EQQQ(3,8,2);
EvRvRPbgVGQt(3,3) = (PV(3,3)*ST(2,2)*s(1)^2-PV(3,2)*ST(2,3)*s(1)^2-PV(3,2)*ST(2,3)*s(2)^2+PV(3,3)*ST(2,2)*s(2)^2)*EQQQ(1,2,2)...
    +(2*PV(3,2)*ST(2,3)*s(1)*s(2)-2*PV(3,3)*ST(2,2)*s(1)*s(2))*EQQQ(1,2,4)...
    +(PV(3,3)*ST(1,1)*s(1)^2-PV(3,1)*ST(1,3)*s(1)^2-PV(3,1)*ST(1,3)*s(2)^2+PV(3,3)*ST(1,1)*s(2)^2)*EQQQ(5,2,2)...
    +(2*PV(3,1)*ST(1,3)*s(1)*s(2)-2*PV(3,3)*ST(1,1)*s(1)*s(2))*EQQQ(5,2,4)...
    +(PV(1,2)*ST(2,1)*s(1)*s(2)-PV(1,1)*ST(2,2)*s(1)*s(2)+PV(2,1)*ST(1,2)*s(1)*s(2)-PV(2,2)*ST(1,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(1,1)*ST(2,2)*s(1)*s(3)-PV(1,2)*ST(2,1)*s(1)*s(3)+PV(2,1)*ST(1,2)*s(1)*s(3)-PV(2,2)*ST(1,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(1,2)*ST(2,1)*s(2)*s(3)-PV(1,1)*ST(2,2)*s(2)*s(3)-PV(2,1)*ST(1,2)*s(2)*s(3)+PV(2,2)*ST(1,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(2,2)*ST(1,1)*s(1)^2-PV(2,1)*ST(1,2)*s(1)^2+PV(1,1)*ST(2,2)*s(2)^2-PV(1,2)*ST(2,1)*s(2)^2)*EQQQ(3,8,2);

SigmaMInv = diag([S(2,2)+S(3,3),S(1,1)+S(3,3),S(1,1)+S(2,2)]);
Sigmac = Sigma-P*SigmaMInv*P';
Sigmacxbg = Sigmac(:,1:3);

ExvRhatbdRptdt = (Sigmacxbg*V*EGQt' + Miu*EvRPbgVGQt + P*EvRvRPbgVGQt)*UT';

% ExvRhatWdRptdt
EvRGdRpt = UT*vee(EQ*STT'-STT*EQ');
EvRvRGdRpt = [STT(2,2)*EQ(2,2)+STT(3,3)*EQ(3,3), -STT(1,2)*EQ(2,2), -STT(1,3)*EQ(3,3)
    -STT(2,1)*EQ(1,1), STT(1,1)*EQ(1,1)+STT(3,3)*EQ(3,3), -STT(2,3)*EQ(3,3)
    -STT(3,1)*EQ(1,1), -STT(3,2)*EQ(2,2), STT(1,1)*EQ(1,1)+STT(2,2)*EQ(2,2)];

ExvRGdRpt = Miu*EvRGdRpt' + P*EvRvRGdRpt;
ExvRdRpt = Miu*EvRdRpt' + P*EvRvRdRpt;

ExvRhatWdRptdt = dt*ExvRGdRpt - dt*trace(Ggu)*ExvRdRpt;

% final result
ExvRptdt = ExvRdRptdt + dt*ExvRhatbdRptdt + 0.5*ExvRhatWdRptdt;

%% E[v'R(t+dt)v'R(t+dt)]
% EvRwpvRwpt
EvRwpvRwpt(1,1) = (ST(3,2)^2)*EQQ(5,5)+(-2*ST(2,3)*ST(3,2))*EQQ(5,9)+(ST(2,3)^2)*EQQ(9,9)...
    +(ST(3,1)^2)*EQQ(2,2)+(ST(2,1)^2)*EQQ(3,3)+(ST(2,2)^2+ST(3,3)^2)*EQQ(6,6)+(-2*ST(2,2)*ST(3,3))*EQQ(6,8);
EvRwpvRwpt(1,2) = (-ST(3,1)*ST(3,2))*EQQ(1,5)+(ST(2,3)*ST(3,1))*EQQ(1,9)+(ST(1,3)*ST(3,2))*EQQ(5,9)+(-ST(1,3)*ST(2,3))*EQQ(9,9)...
    +(-ST(3,1)*ST(3,2))*EQQ(2,4)+(-ST(1,1)*ST(2,1))*EQQ(3,3)+(ST(2,1)*ST(3,3))*EQQ(3,7)+(-ST(1,2)*ST(2,2))*EQQ(6,6)+(ST(1,2)*ST(3,3))*EQQ(6,8);
EvRwpvRwpt(1,3) = (ST(2,1)*ST(3,2))*EQQ(1,5)+(-ST(2,1)*ST(2,3))*EQQ(1,9)+(-ST(1,2)*ST(3,2))*EQQ(5,5)+(ST(1,2)*ST(2,3))*EQQ(5,9)...
    +(-ST(1,1)*ST(3,1))*EQQ(2,2)+(ST(2,2)*ST(3,1))*EQQ(2,4)+(-ST(2,1)*ST(2,3))*EQQ(3,7)+(-ST(1,3)*ST(3,3))*EQQ(6,6)+(ST(1,3)*ST(2,2))*EQQ(6,8);
EvRwpvRwpt(2,1) = (-ST(3,1)*ST(3,2))*EQQ(1,5)+(ST(2,3)*ST(3,1))*EQQ(1,9)+(ST(1,3)*ST(3,2))*EQQ(5,9)+(-ST(1,3)*ST(2,3))*EQQ(9,9)...
    +(-ST(3,1)*ST(3,2))*EQQ(2,4)+(-ST(1,1)*ST(2,1))*EQQ(3,3)+(ST(2,1)*ST(3,3))*EQQ(3,7) +(-ST(1,2)*ST(2,2))*EQQ(6,6)+(ST(1,2)*ST(3,3))*EQQ(6,8);
EvRwpvRwpt(2,2) = (ST(3,1)^2)*EQQ(1,1)+(-2*ST(1,3)*ST(3,1))*EQQ(1,9)+(ST(1,3)^2)*EQQ(9,9)...
    +(ST(3,2)^2)*EQQ(2,2)+(ST(1,1)^2+ST(3,3)^2)*EQQ(3,3)+(-2*ST(1,1)*ST(3,3))*EQQ(3,7)+(ST(1,2)^2)*EQQ(6,6);
EvRwpvRwpt(2,3) = (-ST(2,1)*ST(3,1))*EQQ(1,1)+(ST(1,2)*ST(3,1))*EQQ(1,5)+(ST(1,3)*ST(2,1))*EQQ(1,9)+(-ST(1,2)*ST(1,3))*EQQ(5,9)...
    +(-ST(2,2)*ST(3,2))*EQQ(2,2)+(ST(1,1)*ST(3,2))*EQQ(2,4)+(-ST(2,3)*ST(3,3))*EQQ(3,3)+(ST(1,1)*ST(2,3))*EQQ(3,7)+(-ST(1,2)*ST(1,3))*EQQ(6,8);
EvRwpvRwpt(3,1) = (ST(2,1)*ST(3,2))*EQQ(1,5)+(-ST(2,1)*ST(2,3))*EQQ(1,9)+(-ST(1,2)*ST(3,2))*EQQ(5,5)+(ST(1,2)*ST(2,3))*EQQ(5,9)...
    +(-ST(1,1)*ST(3,1))*EQQ(2,2)+(ST(2,2)*ST(3,1))*EQQ(2,4)+(-ST(2,1)*ST(2,3))*EQQ(3,7)+(-ST(1,3)*ST(3,3))*EQQ(6,6)+(ST(1,3)*ST(2,2))*EQQ(6,8);
EvRwpvRwpt(3,2) = (-ST(2,1)*ST(3,1))*EQQ(1,1)+(ST(1,2)*ST(3,1))*EQQ(1,5)+(ST(1,3)*ST(2,1))*EQQ(1,9)+(-ST(1,2)*ST(1,3))*EQQ(5,9)...
    +(-ST(2,2)*ST(3,2))*EQQ(2,2)+(ST(1,1)*ST(3,2))*EQQ(2,4)+(-ST(2,3)*ST(3,3))*EQQ(3,3)+(ST(1,1)*ST(2,3))*EQQ(3,7)+(-ST(1,2)*ST(1,3))*EQQ(6,8);
EvRwpvRwpt(3,3) = (ST(2,1)^2)*EQQ(1,1)+(-2*ST(1,2)*ST(2,1))*EQQ(1,5)+(ST(1,2)^2)*EQQ(5,5)...
    +(ST(1,1)^2+ST(2,2)^2)*EQQ(2,2)+(-2*ST(1,1)*ST(2,2))*EQQ(2,4)+(ST(2,3)^2)*EQQ(3,3)+(ST(1,3)^2)*EQQ(6,6);

EvRwpvRwpt = UT*EvRwpvRwpt*UT';

% EvRwpvRhatxwpt
EQ3b(1,1) = (PV(3,3)*ST(3,1)^2*s(1)-PV(3,3)*ST(3,2)^2*s(1)-PV(3,1)*ST(3,1)*ST(3,3)*s(1)+PV(3,2)*ST(3,2)*ST(3,3)*s(1))*EQQQ(5,2,2)...
    + (PV(3,3)*ST(3,2)^2*s(2)-PV(3,3)*ST(3,1)^2*s(2)+PV(3,1)*ST(3,1)*ST(3,3)*s(2)-PV(3,2)*ST(3,2)*ST(3,3)*s(2))*EQQQ(5,2,4)...
    + (PV(2,3)*ST(2,1)*ST(3,1)*s(1)-PV(2,1)*ST(2,1)*ST(3,3)*s(1)+PV(2,2)*ST(2,3)*ST(3,2)*s(1)-PV(2,3)*ST(2,2)*ST(3,2)*s(1))*EQQQ(5,3,3)...
    + (PV(2,1)*ST(2,1)*ST(3,3)*s(3)-PV(2,3)*ST(2,1)*ST(3,1)*s(3)-PV(2,2)*ST(2,3)*ST(3,2)*s(3)+PV(2,3)*ST(2,2)*ST(3,2)*s(3))*EQQQ(5,3,7)...
    + (PV(1,1)*ST(3,3)^2*s(3)-PV(1,1)*ST(3,2)^2*s(3)+PV(1,1)*ST(2,2)*ST(3,3)*s(2)+PV(1,1)*ST(2,3)*ST(3,2)*s(2)-PV(1,3)*ST(2,1)*ST(3,2)*s(2)-PV(1,3)*ST(2,2)*ST(3,1)*s(2)+PV(1,2)*ST(3,1)*ST(3,2)*s(3)-PV(1,3)*ST(3,1)*ST(3,3)*s(3))*EQQQ(5,6,6)...
    + (PV(1,1)*ST(3,2)^2*s(2)-PV(1,1)*ST(3,3)^2*s(2)-PV(1,1)*ST(2,2)*ST(3,3)*s(3)-PV(1,1)*ST(2,3)*ST(3,2)*s(3)+PV(1,3)*ST(2,1)*ST(3,2)*s(3)+PV(1,3)*ST(2,2)*ST(3,1)*s(3)-PV(1,2)*ST(3,1)*ST(3,2)*s(2)+PV(1,3)*ST(3,1)*ST(3,3)*s(2))*EQQQ(5,6,8)...
    + (PV(3,2)*ST(2,1)*ST(3,1)*s(1)-PV(3,1)*ST(2,2)*ST(3,1)*s(1)-PV(3,2)*ST(2,3)*ST(3,3)*s(1)+PV(3,3)*ST(2,3)*ST(3,2)*s(1))*EQQQ(9,2,2)...
    + (PV(3,1)*ST(2,2)*ST(3,1)*s(2)-PV(3,2)*ST(2,1)*ST(3,1)*s(2)+PV(3,2)*ST(2,3)*ST(3,3)*s(2)-PV(3,3)*ST(2,3)*ST(3,2)*s(2))*EQQQ(9,2,4)...
    + (PV(2,2)*ST(2,1)^2*s(1)-PV(2,2)*ST(2,3)^2*s(1)-PV(2,1)*ST(2,1)*ST(2,2)*s(1)+PV(2,3)*ST(2,2)*ST(2,3)*s(1))*EQQQ(9,3,3)...
    + (PV(2,2)*ST(2,3)^2*s(3)-PV(2,2)*ST(2,1)^2*s(3)+PV(2,1)*ST(2,1)*ST(2,2)*s(3)-PV(2,3)*ST(2,2)*ST(2,3)*s(3))*EQQQ(9,3,7)...
    + (PV(1,1)*ST(2,2)^2*s(2)-PV(1,1)*ST(2,3)^2*s(2)-PV(1,2)*ST(2,1)*ST(2,2)*s(2)+PV(1,3)*ST(2,1)*ST(2,3)*s(2)+PV(1,1)*ST(2,2)*ST(3,3)*s(3)+PV(1,1)*ST(2,3)*ST(3,2)*s(3)-PV(1,2)*ST(2,1)*ST(3,3)*s(3)-PV(1,2)*ST(2,3)*ST(3,1)*s(3))*EQQQ(9,6,6)...
    + (PV(1,1)*ST(2,3)^2*s(3)-PV(1,1)*ST(2,2)^2*s(3)+PV(1,2)*ST(2,1)*ST(2,2)*s(3)-PV(1,3)*ST(2,1)*ST(2,3)*s(3)-PV(1,1)*ST(2,2)*ST(3,3)*s(2)-PV(1,1)*ST(2,3)*ST(3,2)*s(2)+PV(1,2)*ST(2,1)*ST(3,3)*s(2)+PV(1,2)*ST(2,3)*ST(3,1)*s(2))*EQQQ(9,6,8)...
    + (PV(2,1)*ST(2,3)*ST(3,1)*s(3)-PV(2,3)*ST(2,1)*ST(3,1)*s(3)-PV(2,2)*ST(2,2)*ST(3,3)*s(3)+PV(2,3)*ST(2,2)*ST(3,2)*s(3)+PV(3,1)*ST(2,1)*ST(3,2)*s(2)-PV(3,2)*ST(2,1)*ST(3,1)*s(2)+PV(3,2)*ST(2,3)*ST(3,3)*s(2)-PV(3,3)*ST(2,2)*ST(3,3)*s(2))*EQQQ(2,6,7)...
    + (PV(3,3)*ST(2,2)^2*s(2)-PV(3,3)*ST(2,1)^2*s(2)-PV(2,2)*ST(3,1)^2*s(3)+PV(2,2)*ST(3,3)^2*s(3)+PV(3,1)*ST(2,1)*ST(2,3)*s(2)-PV(3,2)*ST(2,2)*ST(2,3)*s(2)+PV(2,1)*ST(3,1)*ST(3,2)*s(3)-PV(2,3)*ST(3,2)*ST(3,3)*s(3))*EQQQ(4,3,6)...
    + (PV(3,3)*ST(2,1)^2*s(1)-PV(3,3)*ST(2,2)^2*s(1)-PV(1,2)*ST(2,1)*ST(3,3)*s(2)-PV(1,2)*ST(2,3)*ST(3,1)*s(2)+PV(1,3)*ST(2,1)*ST(3,2)*s(2)+PV(1,3)*ST(2,2)*ST(3,1)*s(2)-PV(2,1)*ST(2,3)*ST(3,1)*s(1)+PV(2,3)*ST(2,1)*ST(3,1)*s(1)-PV(3,1)*ST(2,1)*ST(2,3)*s(1)+PV(2,2)*ST(2,2)*ST(3,3)*s(1)-PV(2,3)*ST(2,2)*ST(3,2)*s(1)+PV(3,2)*ST(2,2)*ST(2,3)*s(1))*EQQQ(2,6,3)...
    + (PV(2,2)*ST(3,1)^2*s(1)-PV(2,2)*ST(3,3)^2*s(1)+PV(1,2)*ST(2,1)*ST(3,3)*s(3)+PV(1,2)*ST(2,3)*ST(3,1)*s(3)-PV(1,3)*ST(2,1)*ST(3,2)*s(3)-PV(1,3)*ST(2,2)*ST(3,1)*s(3)-PV(2,1)*ST(3,1)*ST(3,2)*s(1)-PV(3,1)*ST(2,1)*ST(3,2)*s(1)+PV(3,2)*ST(2,1)*ST(3,1)*s(1)+PV(2,3)*ST(3,2)*ST(3,3)*s(1)-PV(3,2)*ST(2,3)*ST(3,3)*s(1)+PV(3,3)*ST(2,2)*ST(3,3)*s(1))*EQQQ(3,8,2);
EQ3b(1,2) = (PV(3,3)*ST(3,1)*ST(3,2)*s(1)-PV(3,2)*ST(3,1)*ST(3,3)*s(1))*EQQQ(1,2,2)...
    + (PV(3,2)*ST(3,1)*ST(3,3)*s(2)-PV(3,3)*ST(3,1)*ST(3,2)*s(2))*EQQQ(1,2,4)...
    + (PV(2,3)*ST(2,1)*ST(3,2)*s(1)-PV(2,2)*ST(2,1)*ST(3,3)*s(1))*EQQQ(1,3,3)...
    + (PV(2,2)*ST(2,1)*ST(3,3)*s(3)-PV(2,3)*ST(2,1)*ST(3,2)*s(3))*EQQQ(1,3,7)...
    + (PV(1,2)*ST(3,3)^2*s(3)+PV(1,2)*ST(2,2)*ST(3,3)*s(2)-PV(1,3)*ST(2,2)*ST(3,2)*s(2)-PV(1,3)*ST(3,2)*ST(3,3)*s(3))*EQQQ(1,6,6)...
    + (PV(1,3)*ST(2,2)*ST(3,2)*s(3)-PV(1,2)*ST(2,2)*ST(3,3)*s(3)-PV(1,2)*ST(3,3)^2*s(2)+PV(1,3)*ST(3,2)*ST(3,3)*s(2))*EQQQ(1,6,8)...
    + (PV(3,3)*ST(3,1)*ST(3,2)*s(2)-PV(3,1)*ST(3,2)*ST(3,3)*s(2))*EQQQ(5,2,2)...
    + (PV(3,1)*ST(3,2)*ST(3,3)*s(1)-PV(3,3)*ST(3,1)*ST(3,2)*s(1))*EQQQ(5,2,4)...
    + (PV(2,3)*ST(1,2)*ST(3,2)*s(1)-PV(2,2)*ST(1,3)*ST(3,2)*s(1)-PV(2,1)*ST(3,2)^2*s(3)+PV(2,2)*ST(3,1)*ST(3,2)*s(3))*EQQQ(5,3,3)...
    + (PV(2,1)*ST(3,2)^2*s(1)+PV(2,2)*ST(1,3)*ST(3,2)*s(3)-PV(2,3)*ST(1,2)*ST(3,2)*s(3)-PV(2,2)*ST(3,1)*ST(3,2)*s(1))*EQQQ(5,3,7)...
    + (PV(1,3)*ST(1,1)*ST(3,2)*s(2)-PV(1,1)*ST(1,3)*ST(3,2)*s(2))*EQQQ(5,6,6)...
    + (PV(1,1)*ST(1,3)*ST(3,2)*s(3)-PV(1,3)*ST(1,1)*ST(3,2)*s(3))*EQQQ(5,6,8)...
    + (PV(3,1)*ST(1,2)*ST(3,1)*s(1)-PV(3,2)*ST(1,1)*ST(3,1)*s(1)+PV(3,1)*ST(2,3)*ST(3,3)*s(2)-PV(3,3)*ST(2,3)*ST(3,1)*s(2))*EQQQ(9,2,2)...
    + (PV(3,2)*ST(1,1)*ST(3,1)*s(2)-PV(3,1)*ST(1,2)*ST(3,1)*s(2)-PV(3,1)*ST(2,3)*ST(3,3)*s(1)+PV(3,3)*ST(2,3)*ST(3,1)*s(1))*EQQQ(9,2,4)...
    + (PV(2,1)*ST(1,2)*ST(2,1)*s(1)-PV(2,2)*ST(1,1)*ST(2,1)*s(1)+PV(2,2)*ST(1,3)*ST(2,3)*s(1)-PV(2,3)*ST(1,2)*ST(2,3)*s(1)+PV(2,1)*ST(2,3)*ST(3,2)*s(3)-PV(2,2)*ST(2,3)*ST(3,1)*s(3))*EQQQ(9,3,3)...
    + (PV(2,2)*ST(1,1)*ST(2,1)*s(3)-PV(2,1)*ST(1,2)*ST(2,1)*s(3)-PV(2,2)*ST(1,3)*ST(2,3)*s(3)+PV(2,3)*ST(1,2)*ST(2,3)*s(3)-PV(2,1)*ST(2,3)*ST(3,2)*s(1)+PV(2,2)*ST(2,3)*ST(3,1)*s(1))*EQQQ(9,3,7)...
    + (PV(1,2)*ST(1,1)*ST(2,2)*s(2)-PV(1,1)*ST(1,2)*ST(2,2)*s(2)+PV(1,1)*ST(1,3)*ST(2,3)*s(2)-PV(1,3)*ST(1,1)*ST(2,3)*s(2)-PV(1,1)*ST(1,2)*ST(3,3)*s(3)+PV(1,2)*ST(1,1)*ST(3,3)*s(3))*EQQQ(9,6,6)...
    + (PV(1,1)*ST(1,2)*ST(2,2)*s(3)-PV(1,2)*ST(1,1)*ST(2,2)*s(3)-PV(1,1)*ST(1,3)*ST(2,3)*s(3)+PV(1,3)*ST(1,1)*ST(2,3)*s(3)+PV(1,1)*ST(1,2)*ST(3,3)*s(2)-PV(1,2)*ST(1,1)*ST(3,3)*s(2))*EQQQ(9,6,8)...
    + (PV(1,2)*ST(3,1)^2*s(2)-PV(2,1)*ST(3,3)^2*s(1)+PV(1,1)*ST(2,1)*ST(3,3)*s(3)-PV(1,3)*ST(2,1)*ST(3,1)*s(3)-PV(2,1)*ST(1,3)*ST(3,1)*s(3)+PV(2,3)*ST(1,1)*ST(3,1)*s(3)-PV(1,1)*ST(3,1)*ST(3,2)*s(2)-PV(3,2)*ST(1,3)*ST(3,3)*s(2)+PV(3,3)*ST(1,2)*ST(3,3)*s(2)+PV(3,1)*ST(2,2)*ST(3,2)*s(1)-PV(3,2)*ST(2,2)*ST(3,1)*s(1)+PV(2,3)*ST(3,1)*ST(3,3)*s(1))*EQQQ(2,6,7)...
    + (PV(1,3)*ST(2,1)*ST(3,1)*s(2)-PV(1,1)*ST(2,1)*ST(3,3)*s(2)-PV(1,2)*ST(3,1)^2*s(3)-PV(3,1)*ST(1,3)*ST(2,1)*s(2)+PV(3,3)*ST(1,1)*ST(2,1)*s(2)+PV(3,2)*ST(1,3)*ST(2,2)*s(2)-PV(3,3)*ST(1,2)*ST(2,2)*s(2)+PV(1,1)*ST(3,1)*ST(3,2)*s(3)+PV(2,1)*ST(2,2)*ST(3,3)*s(1)-PV(2,3)*ST(2,2)*ST(3,1)*s(1)-PV(3,1)*ST(3,2)*ST(3,3)*s(1)+PV(3,2)*ST(3,1)*ST(3,3)*s(1))*EQQQ(4,3,6)...
    + (PV(2,1)*ST(3,3)^2*s(3)+PV(1,2)*ST(1,3)*ST(3,1)*s(2)-PV(1,3)*ST(1,2)*ST(3,1)*s(2)+PV(2,1)*ST(1,3)*ST(3,1)*s(1)-PV(2,3)*ST(1,1)*ST(3,1)*s(1)+PV(3,1)*ST(1,3)*ST(2,1)*s(1)-PV(3,3)*ST(1,1)*ST(2,1)*s(1)-PV(3,2)*ST(1,3)*ST(2,2)*s(1)+PV(3,3)*ST(1,2)*ST(2,2)*s(1)-PV(2,3)*ST(3,1)*ST(3,3)*s(3)+PV(3,1)*ST(3,2)*ST(3,3)*s(2)-PV(3,2)*ST(3,1)*ST(3,3)*s(2))*EQQQ(2,6,3)...
    + (PV(1,3)*ST(1,2)*ST(3,1)*s(3)-PV(1,2)*ST(1,3)*ST(3,1)*s(3)-PV(2,1)*ST(2,2)*ST(3,3)*s(3)+PV(2,3)*ST(2,2)*ST(3,1)*s(3)+PV(3,2)*ST(1,3)*ST(3,3)*s(1)-PV(3,3)*ST(1,2)*ST(3,3)*s(1)-PV(3,1)*ST(2,2)*ST(3,2)*s(2)+PV(3,2)*ST(2,2)*ST(3,1)*s(2))*EQQQ(3,8,2);
EQ3b(1,3) = (PV(3,2)*ST(2,3)*ST(3,1)*s(1)-PV(3,3)*ST(2,2)*ST(3,1)*s(1))*EQQQ(1,2,2)...
    + (PV(3,3)*ST(2,2)*ST(3,1)*s(2)-PV(3,2)*ST(2,3)*ST(3,1)*s(2))*EQQQ(1,2,4)...
    + (PV(2,2)*ST(2,1)*ST(2,3)*s(1)-PV(2,3)*ST(2,1)*ST(2,2)*s(1))*EQQQ(1,3,3)...
    + (PV(2,3)*ST(2,1)*ST(2,2)*s(3)-PV(2,2)*ST(2,1)*ST(2,3)*s(3))*EQQQ(1,3,7)...
    + (PV(1,3)*ST(2,2)^2*s(2)-PV(1,2)*ST(2,2)*ST(2,3)*s(2)-PV(1,2)*ST(2,3)*ST(3,3)*s(3)+PV(1,3)*ST(2,2)*ST(3,3)*s(3))*EQQQ(1,6,6)...
    + (PV(1,2)*ST(2,2)*ST(2,3)*s(3)-PV(1,3)*ST(2,2)^2*s(3)+PV(1,2)*ST(2,3)*ST(3,3)*s(2)-PV(1,3)*ST(2,2)*ST(3,3)*s(2))*EQQQ(1,6,8)...
    + (PV(3,1)*ST(1,3)*ST(3,1)*s(1)-PV(3,3)*ST(1,1)*ST(3,1)*s(1)-PV(3,2)*ST(1,3)*ST(3,2)*s(1)+PV(3,3)*ST(1,2)*ST(3,2)*s(1)+PV(3,1)*ST(2,3)*ST(3,2)*s(2)-PV(3,3)*ST(2,1)*ST(3,2)*s(2))*EQQQ(5,2,2)...
    + (PV(3,3)*ST(1,1)*ST(3,1)*s(2)-PV(3,1)*ST(1,3)*ST(3,1)*s(2)+PV(3,2)*ST(1,3)*ST(3,2)*s(2)-PV(3,3)*ST(1,2)*ST(3,2)*s(2)-PV(3,1)*ST(2,3)*ST(3,2)*s(1)+PV(3,3)*ST(2,1)*ST(3,2)*s(1))*EQQQ(5,2,4)...
    + (PV(2,1)*ST(1,3)*ST(2,1)*s(1)-PV(2,3)*ST(1,1)*ST(2,1)*s(1)+PV(2,1)*ST(2,2)*ST(3,2)*s(3)-PV(2,2)*ST(2,1)*ST(3,2)*s(3))*EQQQ(5,3,3)...
    + (PV(2,3)*ST(1,1)*ST(2,1)*s(3)-PV(2,1)*ST(1,3)*ST(2,1)*s(3)-PV(2,1)*ST(2,2)*ST(3,2)*s(1)+PV(2,2)*ST(2,1)*ST(3,2)*s(1))*EQQQ(5,3,7)...
    + (PV(1,3)*ST(1,1)*ST(2,2)*s(2)-PV(1,1)*ST(1,3)*ST(2,2)*s(2)+PV(1,1)*ST(1,2)*ST(3,2)*s(3)-PV(1,2)*ST(1,1)*ST(3,2)*s(3)-PV(1,1)*ST(1,3)*ST(3,3)*s(3)+PV(1,3)*ST(1,1)*ST(3,3)*s(3))*EQQQ(5,6,6)...
    + (PV(1,1)*ST(1,3)*ST(2,2)*s(3)-PV(1,3)*ST(1,1)*ST(2,2)*s(3)-PV(1,1)*ST(1,2)*ST(3,2)*s(2)+PV(1,2)*ST(1,1)*ST(3,2)*s(2)+PV(1,1)*ST(1,3)*ST(3,3)*s(2)-PV(1,3)*ST(1,1)*ST(3,3)*s(2))*EQQQ(5,6,8)...
    + (PV(3,2)*ST(1,3)*ST(2,3)*s(1)-PV(3,1)*ST(2,3)^2*s(2)-PV(3,3)*ST(1,2)*ST(2,3)*s(1)+PV(3,3)*ST(2,1)*ST(2,3)*s(2))*EQQQ(9,2,2)...
    + (PV(3,1)*ST(2,3)^2*s(1)-PV(3,2)*ST(1,3)*ST(2,3)*s(2)+PV(3,3)*ST(1,2)*ST(2,3)*s(2)-PV(3,3)*ST(2,1)*ST(2,3)*s(1))*EQQQ(9,2,4)...
    + (PV(2,2)*ST(2,1)*ST(2,3)*s(3)-PV(2,1)*ST(2,2)*ST(2,3)*s(3))*EQQQ(9,3,3) +(PV(2,1)*ST(2,2)*ST(2,3)*s(1)-PV(2,2)*ST(2,1)*ST(2,3)*s(1))*EQQQ(9,3,7)...
    + (PV(1,2)*ST(1,1)*ST(2,3)*s(3)-PV(1,1)*ST(1,2)*ST(2,3)*s(3))*EQQQ(9,6,6) +(PV(1,1)*ST(1,2)*ST(2,3)*s(2)-PV(1,2)*ST(1,1)*ST(2,3)*s(2))*EQQQ(9,6,8)...
    + (PV(1,3)*ST(2,1)^2*s(3)-PV(3,1)*ST(2,2)^2*s(1)-PV(1,1)*ST(2,1)*ST(2,3)*s(3)+PV(2,2)*ST(1,3)*ST(2,2)*s(3)-PV(2,3)*ST(1,2)*ST(2,2)*s(3)+PV(1,1)*ST(2,2)*ST(3,1)*s(2)-PV(1,2)*ST(2,1)*ST(3,1)*s(2)-PV(3,1)*ST(1,2)*ST(2,1)*s(2)+PV(3,2)*ST(1,1)*ST(2,1)*s(2)+PV(3,2)*ST(2,1)*ST(2,2)*s(1)+PV(2,1)*ST(2,3)*ST(3,3)*s(1)-PV(2,3)*ST(2,1)*ST(3,3)*s(1))*EQQQ(2,6,7)...
    + (PV(1,1)*ST(2,1)*ST(2,3)*s(2)-PV(1,3)*ST(2,1)^2*s(2)-PV(1,1)*ST(2,2)*ST(3,1)*s(3)+PV(1,2)*ST(2,1)*ST(3,1)*s(3)-PV(2,1)*ST(1,2)*ST(3,1)*s(3)-PV(2,1)*ST(2,2)*ST(2,3)*s(1)+PV(2,2)*ST(1,1)*ST(3,1)*s(3)+PV(2,3)*ST(2,1)*ST(2,2)*s(1)-PV(2,2)*ST(1,3)*ST(3,3)*s(3)+PV(2,3)*ST(1,2)*ST(3,3)*s(3)+PV(3,1)*ST(2,2)*ST(3,3)*s(1)-PV(3,2)*ST(2,1)*ST(3,3)*s(1))*EQQQ(4,3,6)...
    + (PV(1,2)*ST(1,3)*ST(2,1)*s(2)-PV(1,3)*ST(1,2)*ST(2,1)*s(2)-PV(2,2)*ST(1,3)*ST(2,2)*s(1)+PV(2,3)*ST(1,2)*ST(2,2)*s(1)-PV(2,1)*ST(2,3)*ST(3,3)*s(3)+PV(2,3)*ST(2,1)*ST(3,3)*s(3)-PV(3,1)*ST(2,2)*ST(3,3)*s(2)+PV(3,2)*ST(2,1)*ST(3,3)*s(2))*EQQQ(2,6,3)...
    + (PV(3,1)*ST(2,2)^2*s(2)-PV(1,2)*ST(1,3)*ST(2,1)*s(3)+PV(1,3)*ST(1,2)*ST(2,1)*s(3)+PV(2,1)*ST(1,2)*ST(3,1)*s(1)-PV(2,2)*ST(1,1)*ST(3,1)*s(1)+PV(3,1)*ST(1,2)*ST(2,1)*s(1)-PV(3,2)*ST(1,1)*ST(2,1)*s(1)+PV(2,1)*ST(2,2)*ST(2,3)*s(3)+PV(2,2)*ST(1,3)*ST(3,3)*s(1)-PV(2,3)*ST(1,2)*ST(3,3)*s(1)-PV(2,3)*ST(2,1)*ST(2,2)*s(3)-PV(3,2)*ST(2,1)*ST(2,2)*s(2))*EQQQ(3,8,2);
EQ3b(2,1) = (PV(3,3)*ST(3,1)*ST(3,2)*s(1)-PV(3,2)*ST(3,1)*ST(3,3)*s(1))*EQQQ(1,2,2)...
    + (PV(3,2)*ST(3,1)*ST(3,3)*s(2)-PV(3,3)*ST(3,1)*ST(3,2)*s(2))*EQQQ(1,2,4)...
    + (PV(2,3)*ST(2,2)*ST(3,1)*s(1)-PV(2,2)*ST(2,3)*ST(3,1)*s(1))*EQQQ(1,3,3)...
    + (PV(2,2)*ST(2,3)*ST(3,1)*s(3)-PV(2,3)*ST(2,2)*ST(3,1)*s(3))*EQQQ(1,3,7)...
    + (PV(1,3)*ST(2,1)*ST(3,1)*s(2)-PV(1,1)*ST(2,3)*ST(3,1)*s(2)-PV(1,2)*ST(3,1)^2*s(3)+PV(1,1)*ST(3,1)*ST(3,2)*s(3))*EQQQ(1,6,6)...
    + (PV(1,2)*ST(3,1)^2*s(2)+PV(1,1)*ST(2,3)*ST(3,1)*s(3)-PV(1,3)*ST(2,1)*ST(3,1)*s(3)-PV(1,1)*ST(3,1)*ST(3,2)*s(2))*EQQQ(1,6,8)...
    + (PV(3,3)*ST(3,1)*ST(3,2)*s(2)-PV(3,1)*ST(3,2)*ST(3,3)*s(2))*EQQQ(5,2,2) +(PV(3,1)*ST(3,2)*ST(3,3)*s(1)-PV(3,3)*ST(3,1)*ST(3,2)*s(1))*EQQQ(5,2,4)...
    + (PV(2,1)*ST(3,3)^2*s(3)+PV(2,1)*ST(1,1)*ST(3,3)*s(1)-PV(2,3)*ST(1,1)*ST(3,1)*s(1)-PV(2,3)*ST(3,1)*ST(3,3)*s(3))*EQQQ(5,3,3)...
    + (PV(2,3)*ST(1,1)*ST(3,1)*s(3)-PV(2,1)*ST(1,1)*ST(3,3)*s(3)-PV(2,1)*ST(3,3)^2*s(1)+PV(2,3)*ST(3,1)*ST(3,3)*s(1))*EQQQ(5,3,7)...
    + (PV(1,3)*ST(1,2)*ST(3,1)*s(2)-PV(1,1)*ST(1,2)*ST(3,3)*s(2))*EQQQ(5,6,6) +(PV(1,1)*ST(1,2)*ST(3,3)*s(3)-PV(1,3)*ST(1,2)*ST(3,1)*s(3))*EQQQ(5,6,8)...
    + (PV(3,2)*ST(1,3)*ST(3,3)*s(1)-PV(3,3)*ST(1,3)*ST(3,2)*s(1)-PV(3,1)*ST(2,2)*ST(3,2)*s(2)+PV(3,2)*ST(2,1)*ST(3,2)*s(2))*EQQQ(9,2,2)...
    + (PV(3,3)*ST(1,3)*ST(3,2)*s(2)-PV(3,2)*ST(1,3)*ST(3,3)*s(2)+PV(3,1)*ST(2,2)*ST(3,2)*s(1)-PV(3,2)*ST(2,1)*ST(3,2)*s(1))*EQQQ(9,2,4)...
    + (PV(2,1)*ST(1,1)*ST(2,2)*s(1)-PV(2,2)*ST(1,1)*ST(2,1)*s(1)+PV(2,2)*ST(1,3)*ST(2,3)*s(1)-PV(2,3)*ST(1,3)*ST(2,2)*s(1)+PV(2,1)*ST(2,2)*ST(3,3)*s(3)-PV(2,2)*ST(2,1)*ST(3,3)*s(3))*EQQQ(9,3,3)...
    + (PV(2,2)*ST(1,1)*ST(2,1)*s(3)-PV(2,1)*ST(1,1)*ST(2,2)*s(3)-PV(2,2)*ST(1,3)*ST(2,3)*s(3)+PV(2,3)*ST(1,3)*ST(2,2)*s(3)-PV(2,1)*ST(2,2)*ST(3,3)*s(1)+PV(2,2)*ST(2,1)*ST(3,3)*s(1))*EQQQ(9,3,7)...
    + (PV(1,2)*ST(1,2)*ST(2,1)*s(2)-PV(1,1)*ST(1,2)*ST(2,2)*s(2)+PV(1,1)*ST(1,3)*ST(2,3)*s(2)-PV(1,3)*ST(1,3)*ST(2,1)*s(2)-PV(1,1)*ST(1,3)*ST(3,2)*s(3)+PV(1,2)*ST(1,3)*ST(3,1)*s(3))*EQQQ(9,6,6)...
    + (PV(1,1)*ST(1,2)*ST(2,2)*s(3)-PV(1,2)*ST(1,2)*ST(2,1)*s(3)-PV(1,1)*ST(1,3)*ST(2,3)*s(3)+PV(1,3)*ST(1,3)*ST(2,1)*s(3)+PV(1,1)*ST(1,3)*ST(3,2)*s(2)-PV(1,2)*ST(1,3)*ST(3,1)*s(2))*EQQQ(9,6,8)...
    + (PV(2,1)*ST(3,2)^2*s(1)-PV(1,2)*ST(3,3)^2*s(2)-PV(1,2)*ST(2,3)*ST(3,2)*s(3)+PV(1,3)*ST(2,2)*ST(3,2)*s(3)+PV(2,2)*ST(1,2)*ST(3,3)*s(3)-PV(2,3)*ST(1,2)*ST(3,2)*s(3)-PV(3,1)*ST(1,1)*ST(3,2)*s(2)+PV(3,2)*ST(1,1)*ST(3,1)*s(2)+PV(1,3)*ST(3,2)*ST(3,3)*s(2)-PV(2,2)*ST(3,1)*ST(3,2)*s(1)-PV(3,1)*ST(2,3)*ST(3,3)*s(1)+PV(3,3)*ST(2,1)*ST(3,3)*s(1))*EQQQ(2,6,7)...
    + (PV(1,2)*ST(3,3)^2*s(3)-PV(3,1)*ST(1,1)*ST(2,3)*s(2)+PV(3,3)*ST(1,1)*ST(2,1)*s(2)+PV(1,2)*ST(2,3)*ST(3,2)*s(2)-PV(1,3)*ST(2,2)*ST(3,2)*s(2)+PV(3,2)*ST(1,2)*ST(2,3)*s(2)-PV(3,3)*ST(1,2)*ST(2,2)*s(2)+PV(2,1)*ST(2,3)*ST(3,2)*s(1)-PV(2,3)*ST(2,1)*ST(3,2)*s(1)-PV(1,3)*ST(3,2)*ST(3,3)*s(3)-PV(3,1)*ST(3,2)*ST(3,3)*s(1)+PV(3,2)*ST(3,1)*ST(3,3)*s(1))*EQQQ(4,3,6)...
    + (PV(1,2)*ST(1,1)*ST(3,3)*s(2)-PV(2,1)*ST(3,2)^2*s(3)-PV(1,3)*ST(1,1)*ST(3,2)*s(2)+PV(3,1)*ST(1,1)*ST(2,3)*s(1)-PV(3,3)*ST(1,1)*ST(2,1)*s(1)-PV(2,2)*ST(1,2)*ST(3,3)*s(1)+PV(2,3)*ST(1,2)*ST(3,2)*s(1)-PV(3,2)*ST(1,2)*ST(2,3)*s(1)+PV(3,3)*ST(1,2)*ST(2,2)*s(1)+PV(2,2)*ST(3,1)*ST(3,2)*s(3)+PV(3,1)*ST(3,2)*ST(3,3)*s(2)-PV(3,2)*ST(3,1)*ST(3,3)*s(2))*EQQQ(2,6,3)...
    + (PV(1,3)*ST(1,1)*ST(3,2)*s(3)-PV(1,2)*ST(1,1)*ST(3,3)*s(3)+PV(3,1)*ST(1,1)*ST(3,2)*s(1)-PV(3,2)*ST(1,1)*ST(3,1)*s(1)-PV(2,1)*ST(2,3)*ST(3,2)*s(3)+PV(2,3)*ST(2,1)*ST(3,2)*s(3)+PV(3,1)*ST(2,3)*ST(3,3)*s(2)-PV(3,3)*ST(2,1)*ST(3,3)*s(2))*EQQQ(3,8,2);
EQ3b(2,2) = (PV(3,3)*ST(3,2)^2*s(2)-PV(3,3)*ST(3,1)^2*s(2)+PV(3,1)*ST(3,1)*ST(3,3)*s(2)-PV(3,2)*ST(3,2)*ST(3,3)*s(2))*EQQQ(1,2,2)...
    + (PV(3,3)*ST(3,1)^2*s(1)-PV(3,3)*ST(3,2)^2*s(1)-PV(3,1)*ST(3,1)*ST(3,3)*s(1)+PV(3,2)*ST(3,2)*ST(3,3)*s(1))*EQQQ(1,2,4)...
    + (PV(2,2)*ST(3,3)^2*s(3)-PV(2,2)*ST(3,1)^2*s(3)+PV(2,2)*ST(1,1)*ST(3,3)*s(1)+PV(2,2)*ST(1,3)*ST(3,1)*s(1)-PV(2,3)*ST(1,1)*ST(3,2)*s(1)-PV(2,3)*ST(1,2)*ST(3,1)*s(1)+PV(2,1)*ST(3,1)*ST(3,2)*s(3)-PV(2,3)*ST(3,2)*ST(3,3)*s(3))*EQQQ(1,3,3)...
    + (PV(2,2)*ST(3,1)^2*s(1)-PV(2,2)*ST(3,3)^2*s(1)-PV(2,2)*ST(1,1)*ST(3,3)*s(3)-PV(2,2)*ST(1,3)*ST(3,1)*s(3)+PV(2,3)*ST(1,1)*ST(3,2)*s(3)+PV(2,3)*ST(1,2)*ST(3,1)*s(3)-PV(2,1)*ST(3,1)*ST(3,2)*s(1)+PV(2,3)*ST(3,2)*ST(3,3)*s(1))*EQQQ(1,3,7)...
    + (PV(1,1)*ST(1,3)*ST(3,1)*s(2)-PV(1,3)*ST(1,1)*ST(3,1)*s(2)-PV(1,2)*ST(1,2)*ST(3,3)*s(2)+PV(1,3)*ST(1,2)*ST(3,2)*s(2))*EQQQ(1,6,6)...
    + (PV(1,3)*ST(1,1)*ST(3,1)*s(3)-PV(1,1)*ST(1,3)*ST(3,1)*s(3)+PV(1,2)*ST(1,2)*ST(3,3)*s(3)-PV(1,3)*ST(1,2)*ST(3,2)*s(3))*EQQQ(1,6,8)...
    + (PV(3,1)*ST(1,2)*ST(3,2)*s(2)-PV(3,2)*ST(1,1)*ST(3,2)*s(2)-PV(3,1)*ST(1,3)*ST(3,3)*s(2)+PV(3,3)*ST(1,3)*ST(3,1)*s(2))*EQQQ(9,2,2)...
    + (PV(3,2)*ST(1,1)*ST(3,2)*s(1)-PV(3,1)*ST(1,2)*ST(3,2)*s(1)+PV(3,1)*ST(1,3)*ST(3,3)*s(1)-PV(3,3)*ST(1,3)*ST(3,1)*s(1))*EQQQ(9,2,4)...
    + (PV(2,2)*ST(1,1)^2*s(1)-PV(2,2)*ST(1,3)^2*s(1)-PV(2,1)*ST(1,1)*ST(1,2)*s(1)+PV(2,3)*ST(1,2)*ST(1,3)*s(1)-PV(2,1)*ST(1,2)*ST(3,3)*s(3)-PV(2,1)*ST(1,3)*ST(3,2)*s(3)+PV(2,2)*ST(1,1)*ST(3,3)*s(3)+PV(2,2)*ST(1,3)*ST(3,1)*s(3))*EQQQ(9,3,3)...
    + (PV(2,2)*ST(1,3)^2*s(3)-PV(2,2)*ST(1,1)^2*s(3)+PV(2,1)*ST(1,1)*ST(1,2)*s(3)-PV(2,3)*ST(1,2)*ST(1,3)*s(3)+PV(2,1)*ST(1,2)*ST(3,3)*s(1)+PV(2,1)*ST(1,3)*ST(3,2)*s(1)-PV(2,2)*ST(1,1)*ST(3,3)*s(1)-PV(2,2)*ST(1,3)*ST(3,1)*s(1))*EQQQ(9,3,7)...
    + (PV(1,1)*ST(1,2)^2*s(2)-PV(1,1)*ST(1,3)^2*s(2)-PV(1,2)*ST(1,1)*ST(1,2)*s(2)+PV(1,3)*ST(1,1)*ST(1,3)*s(2))*EQQQ(9,6,6)...
    + (PV(1,1)*ST(1,3)^2*s(3)-PV(1,1)*ST(1,2)^2*s(3)+PV(1,2)*ST(1,1)*ST(1,2)*s(3)-PV(1,3)*ST(1,1)*ST(1,3)*s(3))*EQQQ(9,6,8)...
    + (PV(1,3)*ST(1,1)*ST(3,1)*s(3)-PV(1,1)*ST(1,1)*ST(3,3)*s(3)+PV(1,2)*ST(1,3)*ST(3,2)*s(3)-PV(1,3)*ST(1,2)*ST(3,2)*s(3)-PV(3,1)*ST(1,2)*ST(3,2)*s(1)+PV(3,2)*ST(1,2)*ST(3,1)*s(1)+PV(3,1)*ST(1,3)*ST(3,3)*s(1)-PV(3,3)*ST(1,1)*ST(3,3)*s(1))*EQQQ(2,6,7)...
    + (PV(3,3)*ST(1,2)^2*s(2)-PV(3,3)*ST(1,1)^2*s(2)+PV(1,1)*ST(1,1)*ST(3,3)*s(2)-PV(1,3)*ST(1,1)*ST(3,1)*s(2)+PV(3,1)*ST(1,1)*ST(1,3)*s(2)-PV(1,2)*ST(1,3)*ST(3,2)*s(2)+PV(1,3)*ST(1,2)*ST(3,2)*s(2)-PV(3,2)*ST(1,2)*ST(1,3)*s(2)-PV(2,1)*ST(1,2)*ST(3,3)*s(1)-PV(2,1)*ST(1,3)*ST(3,2)*s(1)+PV(2,3)*ST(1,1)*ST(3,2)*s(1)+PV(2,3)*ST(1,2)*ST(3,1)*s(1))*EQQQ(4,3,6)...
    + (PV(3,3)*ST(1,1)^2*s(1)-PV(1,1)*ST(3,2)^2*s(3)-PV(3,3)*ST(1,2)^2*s(1)+PV(1,1)*ST(3,3)^2*s(3)-PV(3,1)*ST(1,1)*ST(1,3)*s(1)+PV(3,2)*ST(1,2)*ST(1,3)*s(1)+PV(1,2)*ST(3,1)*ST(3,2)*s(3)-PV(1,3)*ST(3,1)*ST(3,3)*s(3))*EQQQ(2,6,3)...
    + (PV(1,1)*ST(3,2)^2*s(2)-PV(1,1)*ST(3,3)^2*s(2)+PV(2,1)*ST(1,2)*ST(3,3)*s(3)+PV(2,1)*ST(1,3)*ST(3,2)*s(3)-PV(2,3)*ST(1,1)*ST(3,2)*s(3)-PV(2,3)*ST(1,2)*ST(3,1)*s(3)-PV(1,2)*ST(3,1)*ST(3,2)*s(2)+PV(3,1)*ST(1,2)*ST(3,2)*s(2)-PV(3,2)*ST(1,2)*ST(3,1)*s(2)+PV(1,3)*ST(3,1)*ST(3,3)*s(2)-PV(3,1)*ST(1,3)*ST(3,3)*s(2)+PV(3,3)*ST(1,1)*ST(3,3)*s(2))*EQQQ(3,8,2);
EQ3b(2,3) = (PV(3,2)*ST(1,3)*ST(3,1)*s(1)-PV(3,3)*ST(1,2)*ST(3,1)*s(1)-PV(3,1)*ST(2,3)*ST(3,1)*s(2)+PV(3,3)*ST(2,1)*ST(3,1)*s(2)+PV(3,2)*ST(2,3)*ST(3,2)*s(2)-PV(3,3)*ST(2,2)*ST(3,2)*s(2))*EQQQ(1,2,2)...
    + (PV(3,3)*ST(1,2)*ST(3,1)*s(2)-PV(3,2)*ST(1,3)*ST(3,1)*s(2)+PV(3,1)*ST(2,3)*ST(3,1)*s(1)-PV(3,3)*ST(2,1)*ST(3,1)*s(1)-PV(3,2)*ST(2,3)*ST(3,2)*s(1)+PV(3,3)*ST(2,2)*ST(3,2)*s(1))*EQQQ(1,2,4)...
    + (PV(2,3)*ST(1,1)*ST(2,2)*s(1)-PV(2,2)*ST(1,1)*ST(2,3)*s(1)-PV(2,1)*ST(2,2)*ST(3,1)*s(3)+PV(2,2)*ST(2,1)*ST(3,1)*s(3)-PV(2,2)*ST(2,3)*ST(3,3)*s(3)+PV(2,3)*ST(2,2)*ST(3,3)*s(3))*EQQQ(1,3,3)...
    + (PV(2,2)*ST(1,1)*ST(2,3)*s(3)-PV(2,3)*ST(1,1)*ST(2,2)*s(3)+PV(2,1)*ST(2,2)*ST(3,1)*s(1)-PV(2,2)*ST(2,1)*ST(3,1)*s(1)+PV(2,2)*ST(2,3)*ST(3,3)*s(1)-PV(2,3)*ST(2,2)*ST(3,3)*s(1))*EQQQ(1,3,7)...
    + (PV(1,2)*ST(1,2)*ST(2,3)*s(2)-PV(1,3)*ST(1,2)*ST(2,2)*s(2)-PV(1,1)*ST(1,2)*ST(3,1)*s(3)+PV(1,2)*ST(1,1)*ST(3,1)*s(3))*EQQQ(1,6,6)...
    + (PV(1,3)*ST(1,2)*ST(2,2)*s(3)-PV(1,2)*ST(1,2)*ST(2,3)*s(3)+PV(1,1)*ST(1,2)*ST(3,1)*s(2)-PV(1,2)*ST(1,1)*ST(3,1)*s(2))*EQQQ(1,6,8)...
    + (PV(3,1)*ST(1,3)*ST(3,2)*s(2)-PV(3,3)*ST(1,1)*ST(3,2)*s(2))*EQQQ(5,2,2)...
    + (PV(3,3)*ST(1,1)*ST(3,2)*s(1)-PV(3,1)*ST(1,3)*ST(3,2)*s(1))*EQQQ(5,2,4)...
    + (PV(2,3)*ST(1,1)^2*s(1)-PV(2,1)*ST(1,1)*ST(1,3)*s(1)-PV(2,1)*ST(1,3)*ST(3,3)*s(3)+PV(2,3)*ST(1,1)*ST(3,3)*s(3))*EQQQ(5,3,3)...
    + (PV(2,1)*ST(1,1)*ST(1,3)*s(3)-PV(2,3)*ST(1,1)^2*s(3)+PV(2,1)*ST(1,3)*ST(3,3)*s(1)-PV(2,3)*ST(1,1)*ST(3,3)*s(1))*EQQQ(5,3,7)...
    + (PV(1,1)*ST(1,2)*ST(1,3)*s(2)-PV(1,3)*ST(1,1)*ST(1,2)*s(2))*EQQQ(5,6,6)...
    + (PV(1,3)*ST(1,1)*ST(1,2)*s(3)-PV(1,1)*ST(1,2)*ST(1,3)*s(3))*EQQQ(5,6,8)...
    + (PV(3,3)*ST(1,2)*ST(1,3)*s(1)-PV(3,2)*ST(1,3)^2*s(1)+PV(3,1)*ST(1,3)*ST(2,3)*s(2)-PV(3,3)*ST(1,3)*ST(2,1)*s(2))*EQQQ(9,2,2)...
    + (PV(3,2)*ST(1,3)^2*s(2)-PV(3,3)*ST(1,2)*ST(1,3)*s(2)-PV(3,1)*ST(1,3)*ST(2,3)*s(1)+PV(3,3)*ST(1,3)*ST(2,1)*s(1))*EQQQ(9,2,4)...
    + (PV(2,1)*ST(1,3)*ST(2,2)*s(3)-PV(2,2)*ST(1,3)*ST(2,1)*s(3))*EQQQ(9,3,3)...
    + (PV(2,2)*ST(1,3)*ST(2,1)*s(1)-PV(2,1)*ST(1,3)*ST(2,2)*s(1))*EQQQ(9,3,7)...
    + (PV(1,1)*ST(1,2)*ST(1,3)*s(3)-PV(1,2)*ST(1,1)*ST(1,3)*s(3))*EQQQ(9,6,6)...
    + (PV(1,2)*ST(1,1)*ST(1,3)*s(2)-PV(1,1)*ST(1,2)*ST(1,3)*s(2))*EQQQ(9,6,8)...
    + (PV(2,3)*ST(1,2)^2*s(3)-PV(3,2)*ST(1,1)^2*s(2)+PV(1,1)*ST(1,1)*ST(2,3)*s(3)-PV(1,3)*ST(1,1)*ST(2,1)*s(3)-PV(2,2)*ST(1,2)*ST(1,3)*s(3)+PV(3,1)*ST(1,1)*ST(1,2)*s(2)+PV(1,2)*ST(1,3)*ST(3,3)*s(2)-PV(1,3)*ST(1,2)*ST(3,3)*s(2)-PV(2,1)*ST(1,2)*ST(3,2)*s(1)+PV(2,2)*ST(1,1)*ST(3,2)*s(1)+PV(3,1)*ST(1,2)*ST(2,2)*s(1)-PV(3,2)*ST(1,2)*ST(2,1)*s(1))*EQQQ(2,6,7)...
    + (PV(1,3)*ST(1,1)*ST(2,1)*s(2)-PV(1,1)*ST(1,1)*ST(2,3)*s(2)+PV(2,1)*ST(1,2)*ST(2,3)*s(1)-PV(2,3)*ST(1,2)*ST(2,1)*s(1)-PV(1,2)*ST(1,3)*ST(3,3)*s(3)+PV(1,3)*ST(1,2)*ST(3,3)*s(3)+PV(3,1)*ST(1,2)*ST(3,3)*s(1)-PV(3,2)*ST(1,1)*ST(3,3)*s(1))*EQQQ(4,3,6)...
    + (PV(1,3)*ST(1,1)*ST(1,2)*s(2)-PV(1,2)*ST(1,1)*ST(1,3)*s(2)-PV(2,3)*ST(1,2)^2*s(1)+PV(2,2)*ST(1,2)*ST(1,3)*s(1)+PV(1,1)*ST(2,2)*ST(3,2)*s(3)-PV(1,2)*ST(2,1)*ST(3,2)*s(3)+PV(2,1)*ST(1,2)*ST(3,2)*s(3)-PV(2,2)*ST(1,1)*ST(3,2)*s(3)-PV(1,1)*ST(2,3)*ST(3,3)*s(3)+PV(1,3)*ST(2,1)*ST(3,3)*s(3)-PV(3,1)*ST(1,2)*ST(3,3)*s(2)+PV(3,2)*ST(1,1)*ST(3,3)*s(2))*EQQQ(2,6,3)...
    + (PV(3,2)*ST(1,1)^2*s(1)+PV(1,2)*ST(1,1)*ST(1,3)*s(3)-PV(1,3)*ST(1,1)*ST(1,2)*s(3)-PV(3,1)*ST(1,1)*ST(1,2)*s(1)-PV(2,1)*ST(1,2)*ST(2,3)*s(3)+PV(2,3)*ST(1,2)*ST(2,1)*s(3)-PV(1,1)*ST(2,2)*ST(3,2)*s(2)+PV(1,2)*ST(2,1)*ST(3,2)*s(2)-PV(3,1)*ST(1,2)*ST(2,2)*s(2)+PV(3,2)*ST(1,2)*ST(2,1)*s(2)+PV(1,1)*ST(2,3)*ST(3,3)*s(2)-PV(1,3)*ST(2,1)*ST(3,3)*s(2))*EQQQ(3,8,2);
EQ3b(3,1) = (PV(3,2)*ST(2,1)*ST(3,3)*s(1)-PV(3,3)*ST(2,1)*ST(3,2)*s(1))*EQQQ(1,2,2)...
    + (PV(3,3)*ST(2,1)*ST(3,2)*s(2)-PV(3,2)*ST(2,1)*ST(3,3)*s(2))*EQQQ(1,2,4)...
    + (PV(2,2)*ST(2,1)*ST(2,3)*s(1)-PV(2,3)*ST(2,1)*ST(2,2)*s(1))*EQQQ(1,3,3)...
    + (PV(2,3)*ST(2,1)*ST(2,2)*s(3)-PV(2,2)*ST(2,1)*ST(2,3)*s(3))*EQQQ(1,3,7)...
    + (PV(1,1)*ST(2,1)*ST(2,3)*s(2)-PV(1,3)*ST(2,1)^2*s(2)-PV(1,1)*ST(2,1)*ST(3,2)*s(3)+PV(1,2)*ST(2,1)*ST(3,1)*s(3))*EQQQ(1,6,6)...
    + (PV(1,3)*ST(2,1)^2*s(3)-PV(1,1)*ST(2,1)*ST(2,3)*s(3)+PV(1,1)*ST(2,1)*ST(3,2)*s(2)-PV(1,2)*ST(2,1)*ST(3,1)*s(2))*EQQQ(1,6,8)...
    + (PV(3,1)*ST(1,1)*ST(3,3)*s(1)-PV(3,3)*ST(1,1)*ST(3,1)*s(1)-PV(3,2)*ST(1,2)*ST(3,3)*s(1)+PV(3,3)*ST(1,2)*ST(3,2)*s(1)+PV(3,1)*ST(2,2)*ST(3,3)*s(2)-PV(3,3)*ST(2,2)*ST(3,1)*s(2))*EQQQ(5,2,2)...
    + (PV(3,3)*ST(1,1)*ST(3,1)*s(2)-PV(3,1)*ST(1,1)*ST(3,3)*s(2)+PV(3,2)*ST(1,2)*ST(3,3)*s(2)-PV(3,3)*ST(1,2)*ST(3,2)*s(2)-PV(3,1)*ST(2,2)*ST(3,3)*s(1)+PV(3,3)*ST(2,2)*ST(3,1)*s(1))*EQQQ(5,2,4)...
    + (PV(2,3)*ST(1,2)*ST(2,2)*s(1)-PV(2,2)*ST(1,2)*ST(2,3)*s(1)-PV(2,1)*ST(2,3)*ST(3,3)*s(3)+PV(2,3)*ST(2,3)*ST(3,1)*s(3))*EQQQ(5,3,3)...
    + (PV(2,2)*ST(1,2)*ST(2,3)*s(3)-PV(2,3)*ST(1,2)*ST(2,2)*s(3)+PV(2,1)*ST(2,3)*ST(3,3)*s(1)-PV(2,3)*ST(2,3)*ST(3,1)*s(1))*EQQQ(5,3,7)...
    + (PV(1,3)*ST(1,2)*ST(2,1)*s(2)-PV(1,1)*ST(1,2)*ST(2,3)*s(2)+PV(1,1)*ST(1,2)*ST(3,2)*s(3)-PV(1,2)*ST(1,2)*ST(3,1)*s(3)-PV(1,1)*ST(1,3)*ST(3,3)*s(3)+PV(1,3)*ST(1,3)*ST(3,1)*s(3))*EQQQ(5,6,6)...
    + (PV(1,1)*ST(1,2)*ST(2,3)*s(3)-PV(1,3)*ST(1,2)*ST(2,1)*s(3)-PV(1,1)*ST(1,2)*ST(3,2)*s(2)+PV(1,2)*ST(1,2)*ST(3,1)*s(2)+PV(1,1)*ST(1,3)*ST(3,3)*s(2)-PV(1,3)*ST(1,3)*ST(3,1)*s(2))*EQQQ(5,6,8)...
    + (PV(3,1)*ST(2,2)^2*s(2)+PV(3,1)*ST(1,1)*ST(2,2)*s(1)-PV(3,2)*ST(1,1)*ST(2,1)*s(1)-PV(3,2)*ST(2,1)*ST(2,2)*s(2))*EQQQ(9,2,2)...
    + (PV(3,2)*ST(1,1)*ST(2,1)*s(2)-PV(3,1)*ST(1,1)*ST(2,2)*s(2)-PV(3,1)*ST(2,2)^2*s(1)+PV(3,2)*ST(2,1)*ST(2,2)*s(1))*EQQQ(9,2,4)...
    + (PV(2,2)*ST(2,1)*ST(2,3)*s(3)-PV(2,1)*ST(2,2)*ST(2,3)*s(3))*EQQQ(9,3,3) +(PV(2,1)*ST(2,2)*ST(2,3)*s(1)-PV(2,2)*ST(2,1)*ST(2,3)*s(1))*EQQQ(9,3,7)...
    + (PV(1,2)*ST(1,3)*ST(2,1)*s(3)-PV(1,1)*ST(1,3)*ST(2,2)*s(3))*EQQQ(9,6,6) +(PV(1,1)*ST(1,3)*ST(2,2)*s(2)-PV(1,2)*ST(1,3)*ST(2,1)*s(2))*EQQQ(9,6,8)...
    + (PV(3,1)*ST(2,3)^2*s(1)-PV(1,3)*ST(2,2)^2*s(3)-PV(2,1)*ST(1,1)*ST(2,3)*s(3)+PV(2,3)*ST(1,1)*ST(2,1)*s(3)+PV(1,2)*ST(2,2)*ST(2,3)*s(3)+PV(1,2)*ST(2,3)*ST(3,3)*s(2)-PV(1,3)*ST(2,3)*ST(3,2)*s(2)-PV(3,2)*ST(1,3)*ST(2,3)*s(2)+PV(3,3)*ST(1,3)*ST(2,2)*s(2)-PV(2,1)*ST(2,2)*ST(3,2)*s(1)+PV(2,2)*ST(2,2)*ST(3,1)*s(1)-PV(3,3)*ST(2,1)*ST(2,3)*s(1))*EQQQ(2,6,7)...
    + (PV(1,3)*ST(2,2)^2*s(2)-PV(1,2)*ST(2,2)*ST(2,3)*s(2)-PV(2,1)*ST(1,1)*ST(3,2)*s(3)-PV(2,1)*ST(2,2)*ST(2,3)*s(1)+PV(2,2)*ST(1,1)*ST(3,1)*s(3)+PV(2,3)*ST(2,1)*ST(2,2)*s(1)-PV(1,2)*ST(2,3)*ST(3,3)*s(3)+PV(1,3)*ST(2,3)*ST(3,2)*s(3)-PV(2,2)*ST(1,3)*ST(3,3)*s(3)+PV(2,3)*ST(1,3)*ST(3,2)*s(3)+PV(3,1)*ST(2,3)*ST(3,2)*s(1)-PV(3,2)*ST(2,3)*ST(3,1)*s(1))*EQQQ(4,3,6)...
    + (PV(1,2)*ST(1,1)*ST(2,3)*s(2)-PV(1,3)*ST(1,1)*ST(2,2)*s(2)+PV(2,1)*ST(1,1)*ST(2,3)*s(1)-PV(2,3)*ST(1,1)*ST(2,1)*s(1)+PV(2,1)*ST(2,2)*ST(3,2)*s(3)-PV(2,2)*ST(2,2)*ST(3,1)*s(3)-PV(3,1)*ST(2,3)*ST(3,2)*s(2)+PV(3,2)*ST(2,3)*ST(3,1)*s(2))*EQQQ(2,6,3)...
    + (PV(1,3)*ST(1,1)*ST(2,2)*s(3)-PV(1,2)*ST(1,1)*ST(2,3)*s(3)-PV(3,1)*ST(2,3)^2*s(2)+PV(2,1)*ST(1,1)*ST(3,2)*s(1)-PV(2,2)*ST(1,1)*ST(3,1)*s(1)+PV(2,1)*ST(2,2)*ST(2,3)*s(3)+PV(2,2)*ST(1,3)*ST(3,3)*s(1)-PV(2,3)*ST(1,3)*ST(3,2)*s(1)-PV(2,3)*ST(2,1)*ST(2,2)*s(3)+PV(3,2)*ST(1,3)*ST(2,3)*s(1)-PV(3,3)*ST(1,3)*ST(2,2)*s(1)+PV(3,3)*ST(2,1)*ST(2,3)*s(2))*EQQQ(3,8,2);
EQ3b(3,2) = (PV(3,2)*ST(1,1)*ST(3,3)*s(1)-PV(3,3)*ST(1,1)*ST(3,2)*s(1)-PV(3,1)*ST(2,1)*ST(3,3)*s(2)+PV(3,3)*ST(2,1)*ST(3,1)*s(2)+PV(3,2)*ST(2,2)*ST(3,3)*s(2)-PV(3,3)*ST(2,2)*ST(3,2)*s(2))*EQQQ(1,2,2)...
    + (PV(3,3)*ST(1,1)*ST(3,2)*s(2)-PV(3,2)*ST(1,1)*ST(3,3)*s(2)+PV(3,1)*ST(2,1)*ST(3,3)*s(1)-PV(3,3)*ST(2,1)*ST(3,1)*s(1)-PV(3,2)*ST(2,2)*ST(3,3)*s(1)+PV(3,3)*ST(2,2)*ST(3,2)*s(1))*EQQQ(1,2,4)...
    + (PV(2,3)*ST(1,2)*ST(2,1)*s(1)-PV(2,2)*ST(1,3)*ST(2,1)*s(1)-PV(2,1)*ST(2,1)*ST(3,2)*s(3)+PV(2,2)*ST(2,1)*ST(3,1)*s(3)-PV(2,2)*ST(2,3)*ST(3,3)*s(3)+PV(2,3)*ST(2,3)*ST(3,2)*s(3))*EQQQ(1,3,3)...
    + (PV(2,2)*ST(1,3)*ST(2,1)*s(3)-PV(2,3)*ST(1,2)*ST(2,1)*s(3)+PV(2,1)*ST(2,1)*ST(3,2)*s(1)-PV(2,2)*ST(2,1)*ST(3,1)*s(1)+PV(2,2)*ST(2,3)*ST(3,3)*s(1)-PV(2,3)*ST(2,3)*ST(3,2)*s(1))*EQQQ(1,3,7)...
    + (PV(1,3)*ST(1,1)*ST(2,1)*s(2)-PV(1,1)*ST(1,3)*ST(2,1)*s(2)-PV(1,2)*ST(1,3)*ST(3,3)*s(3)+PV(1,3)*ST(1,3)*ST(3,2)*s(3))*EQQQ(1,6,6)...
    + (PV(1,1)*ST(1,3)*ST(2,1)*s(3)-PV(1,3)*ST(1,1)*ST(2,1)*s(3)+PV(1,2)*ST(1,3)*ST(3,3)*s(2)-PV(1,3)*ST(1,3)*ST(3,2)*s(2))*EQQQ(1,6,8)...
    + (PV(3,1)*ST(1,2)*ST(3,3)*s(2)-PV(3,3)*ST(1,2)*ST(3,1)*s(2))*EQQQ(5,2,2)...
    + (PV(3,3)*ST(1,2)*ST(3,1)*s(1)-PV(3,1)*ST(1,2)*ST(3,3)*s(1))*EQQQ(5,2,4)...
    + (PV(2,2)*ST(1,2)*ST(1,3)*s(1)-PV(2,3)*ST(1,2)^2*s(1)+PV(2,1)*ST(1,2)*ST(3,2)*s(3)-PV(2,2)*ST(1,2)*ST(3,1)*s(3))*EQQQ(5,3,3)...
    + (PV(2,3)*ST(1,2)^2*s(3)-PV(2,2)*ST(1,2)*ST(1,3)*s(3)-PV(2,1)*ST(1,2)*ST(3,2)*s(1)+PV(2,2)*ST(1,2)*ST(3,1)*s(1))*EQQQ(5,3,7)...
    + (PV(1,1)*ST(1,2)*ST(1,3)*s(2)-PV(1,3)*ST(1,1)*ST(1,2)*s(2))*EQQQ(5,6,6)...
    + (PV(1,3)*ST(1,1)*ST(1,2)*s(3)-PV(1,1)*ST(1,2)*ST(1,3)*s(3))*EQQQ(5,6,8)...
    + (PV(3,2)*ST(1,1)^2*s(1)-PV(3,1)*ST(1,1)*ST(1,2)*s(1)-PV(3,1)*ST(1,2)*ST(2,2)*s(2)+PV(3,2)*ST(1,1)*ST(2,2)*s(2))*EQQQ(9,2,2)...
    + (PV(3,1)*ST(1,1)*ST(1,2)*s(2)-PV(3,2)*ST(1,1)^2*s(2)+PV(3,1)*ST(1,2)*ST(2,2)*s(1)-PV(3,2)*ST(1,1)*ST(2,2)*s(1))*EQQQ(9,2,4)...
    + (PV(2,1)*ST(1,2)*ST(2,3)*s(3)-PV(2,2)*ST(1,1)*ST(2,3)*s(3))*EQQQ(9,3,3)...
    + (PV(2,2)*ST(1,1)*ST(2,3)*s(1)-PV(2,1)*ST(1,2)*ST(2,3)*s(1))*EQQQ(9,3,7)...
    + (PV(1,1)*ST(1,2)*ST(1,3)*s(3)-PV(1,2)*ST(1,1)*ST(1,3)*s(3))*EQQQ(9,6,6)...
    + (PV(1,2)*ST(1,1)*ST(1,3)*s(2)-PV(1,1)*ST(1,2)*ST(1,3)*s(2))*EQQQ(9,6,8)...
    + (PV(3,2)*ST(1,3)^2*s(2)-PV(2,3)*ST(1,1)^2*s(3)+PV(2,1)*ST(1,1)*ST(1,3)*s(3)-PV(1,2)*ST(1,3)*ST(2,2)*s(3)+PV(1,3)*ST(1,2)*ST(2,2)*s(3)+PV(1,1)*ST(1,1)*ST(3,2)*s(2)-PV(1,2)*ST(1,1)*ST(3,1)*s(2)-PV(3,3)*ST(1,2)*ST(1,3)*s(2)+PV(2,1)*ST(1,3)*ST(3,3)*s(1)-PV(2,3)*ST(1,3)*ST(3,1)*s(1)-PV(3,1)*ST(1,3)*ST(2,3)*s(1)+PV(3,3)*ST(1,1)*ST(2,3)*s(1))*EQQQ(2,6,7)...
    + (PV(1,2)*ST(1,3)*ST(2,2)*s(2)-PV(1,3)*ST(1,2)*ST(2,2)*s(2)-PV(1,1)*ST(1,1)*ST(3,2)*s(3)+PV(1,2)*ST(1,1)*ST(3,1)*s(3)+PV(2,1)*ST(1,3)*ST(2,2)*s(1)-PV(2,3)*ST(1,1)*ST(2,2)*s(1)+PV(3,1)*ST(1,3)*ST(3,2)*s(1)-PV(3,2)*ST(1,3)*ST(3,1)*s(1))*EQQQ(4,3,6)...
    + (PV(2,3)*ST(1,1)^2*s(1)-PV(1,2)*ST(1,1)*ST(1,3)*s(2)+PV(1,3)*ST(1,1)*ST(1,2)*s(2)-PV(2,1)*ST(1,1)*ST(1,3)*s(1)+PV(1,1)*ST(2,2)*ST(3,2)*s(3)-PV(1,2)*ST(2,2)*ST(3,1)*s(3)-PV(1,1)*ST(2,3)*ST(3,3)*s(3)+PV(1,3)*ST(2,3)*ST(3,1)*s(3)-PV(2,1)*ST(1,3)*ST(3,3)*s(3)+PV(2,3)*ST(1,3)*ST(3,1)*s(3)-PV(3,1)*ST(1,3)*ST(3,2)*s(2)+PV(3,2)*ST(1,3)*ST(3,1)*s(2))*EQQQ(2,6,3)...
    + (PV(1,2)*ST(1,1)*ST(1,3)*s(3)-PV(3,2)*ST(1,3)^2*s(1)-PV(1,3)*ST(1,1)*ST(1,2)*s(3)-PV(2,1)*ST(1,3)*ST(2,2)*s(3)+PV(2,3)*ST(1,1)*ST(2,2)*s(3)+PV(3,3)*ST(1,2)*ST(1,3)*s(1)-PV(1,1)*ST(2,2)*ST(3,2)*s(2)+PV(1,2)*ST(2,2)*ST(3,1)*s(2)+PV(1,1)*ST(2,3)*ST(3,3)*s(2)-PV(1,3)*ST(2,3)*ST(3,1)*s(2)+PV(3,1)*ST(1,3)*ST(2,3)*s(2)-PV(3,3)*ST(1,1)*ST(2,3)*s(2))*EQQQ(3,8,2);
EQ3b(3,3) = (PV(3,3)*ST(2,2)^2*s(2)-PV(3,3)*ST(2,1)^2*s(2)-PV(3,2)*ST(1,1)*ST(2,3)*s(1)-PV(3,2)*ST(1,3)*ST(2,1)*s(1)+PV(3,3)*ST(1,1)*ST(2,2)*s(1)+PV(3,3)*ST(1,2)*ST(2,1)*s(1)+PV(3,1)*ST(2,1)*ST(2,3)*s(2)-PV(3,2)*ST(2,2)*ST(2,3)*s(2))*EQQQ(1,2,2)...
    + (PV(3,3)*ST(2,1)^2*s(1)-PV(3,3)*ST(2,2)^2*s(1)+PV(3,2)*ST(1,1)*ST(2,3)*s(2)+PV(3,2)*ST(1,3)*ST(2,1)*s(2)-PV(3,3)*ST(1,1)*ST(2,2)*s(2)-PV(3,3)*ST(1,2)*ST(2,1)*s(2)-PV(3,1)*ST(2,1)*ST(2,3)*s(1)+PV(3,2)*ST(2,2)*ST(2,3)*s(1))*EQQQ(1,2,4)...
    + (PV(2,2)*ST(2,3)^2*s(3)-PV(2,2)*ST(2,1)^2*s(3)+PV(2,1)*ST(2,1)*ST(2,2)*s(3)-PV(2,3)*ST(2,2)*ST(2,3)*s(3))*EQQQ(1,3,3)...
    + (PV(2,2)*ST(2,1)^2*s(1)-PV(2,2)*ST(2,3)^2*s(1)-PV(2,1)*ST(2,1)*ST(2,2)*s(1)+PV(2,3)*ST(2,2)*ST(2,3)*s(1))*EQQQ(1,3,7)...
    + (PV(1,1)*ST(1,2)*ST(2,1)*s(3)-PV(1,2)*ST(1,1)*ST(2,1)*s(3)+PV(1,2)*ST(1,3)*ST(2,3)*s(3)-PV(1,3)*ST(1,3)*ST(2,2)*s(3))*EQQQ(1,6,6)...
    + (PV(1,2)*ST(1,1)*ST(2,1)*s(2)-PV(1,1)*ST(1,2)*ST(2,1)*s(2)-PV(1,2)*ST(1,3)*ST(2,3)*s(2)+PV(1,3)*ST(1,3)*ST(2,2)*s(2))*EQQQ(1,6,8)...
    + (PV(3,3)*ST(1,1)^2*s(1)-PV(3,3)*ST(1,2)^2*s(1)-PV(3,1)*ST(1,1)*ST(1,3)*s(1)+PV(3,2)*ST(1,2)*ST(1,3)*s(1)-PV(3,1)*ST(1,2)*ST(2,3)*s(2)-PV(3,1)*ST(1,3)*ST(2,2)*s(2)+PV(3,3)*ST(1,1)*ST(2,2)*s(2)+PV(3,3)*ST(1,2)*ST(2,1)*s(2))*EQQQ(5,2,2)...
    + (PV(3,3)*ST(1,2)^2*s(2)-PV(3,3)*ST(1,1)^2*s(2)+PV(3,1)*ST(1,1)*ST(1,3)*s(2)-PV(3,2)*ST(1,2)*ST(1,3)*s(2)+PV(3,1)*ST(1,2)*ST(2,3)*s(1)+PV(3,1)*ST(1,3)*ST(2,2)*s(1)-PV(3,3)*ST(1,1)*ST(2,2)*s(1)-PV(3,3)*ST(1,2)*ST(2,1)*s(1))*EQQQ(5,2,4)...
    + (PV(2,2)*ST(1,2)*ST(2,1)*s(3)-PV(2,1)*ST(1,2)*ST(2,2)*s(3)+PV(2,1)*ST(1,3)*ST(2,3)*s(3)-PV(2,3)*ST(1,1)*ST(2,3)*s(3))*EQQQ(5,3,3)...
    + (PV(2,1)*ST(1,2)*ST(2,2)*s(1)-PV(2,2)*ST(1,2)*ST(2,1)*s(1)-PV(2,1)*ST(1,3)*ST(2,3)*s(1)+PV(2,3)*ST(1,1)*ST(2,3)*s(1))*EQQQ(5,3,7)...
    + (PV(1,1)*ST(1,3)^2*s(3)-PV(1,1)*ST(1,2)^2*s(3)+PV(1,2)*ST(1,1)*ST(1,2)*s(3)-PV(1,3)*ST(1,1)*ST(1,3)*s(3))*EQQQ(5,6,6)...
    + (PV(1,1)*ST(1,2)^2*s(2)-PV(1,1)*ST(1,3)^2*s(2)-PV(1,2)*ST(1,1)*ST(1,2)*s(2)+PV(1,3)*ST(1,1)*ST(1,3)*s(2))*EQQQ(5,6,8)...
    + (PV(1,2)*ST(1,1)*ST(2,1)*s(2)-PV(1,1)*ST(1,1)*ST(2,2)*s(2)-PV(1,2)*ST(1,3)*ST(2,3)*s(2)+PV(1,3)*ST(1,2)*ST(2,3)*s(2)+PV(2,1)*ST(1,2)*ST(2,2)*s(1)-PV(2,2)*ST(1,1)*ST(2,2)*s(1)-PV(2,1)*ST(1,3)*ST(2,3)*s(1)+PV(2,3)*ST(1,3)*ST(2,1)*s(1))*EQQQ(2,6,7)...
    + (PV(2,2)*ST(1,3)^2*s(3)-PV(2,2)*ST(1,1)^2*s(3)+PV(1,1)*ST(1,1)*ST(2,2)*s(3)-PV(1,2)*ST(1,1)*ST(2,1)*s(3)+PV(2,1)*ST(1,1)*ST(1,2)*s(3)+PV(1,2)*ST(1,3)*ST(2,3)*s(3)-PV(1,3)*ST(1,2)*ST(2,3)*s(3)-PV(2,3)*ST(1,2)*ST(1,3)*s(3)-PV(3,1)*ST(1,2)*ST(2,3)*s(1)-PV(3,1)*ST(1,3)*ST(2,2)*s(1)+PV(3,2)*ST(1,1)*ST(2,3)*s(1)+PV(3,2)*ST(1,3)*ST(2,1)*s(1))*EQQQ(4,3,6)...
    + (PV(1,1)*ST(2,3)^2*s(3)-PV(1,1)*ST(2,2)^2*s(3)+PV(1,2)*ST(2,1)*ST(2,2)*s(3)-PV(2,1)*ST(1,2)*ST(2,2)*s(3)+PV(2,2)*ST(1,1)*ST(2,2)*s(3)-PV(1,3)*ST(2,1)*ST(2,3)*s(3)+PV(2,1)*ST(1,3)*ST(2,3)*s(3)-PV(2,3)*ST(1,3)*ST(2,1)*s(3)+PV(3,1)*ST(1,2)*ST(2,3)*s(2)+PV(3,1)*ST(1,3)*ST(2,2)*s(2)-PV(3,2)*ST(1,1)*ST(2,3)*s(2)-PV(3,2)*ST(1,3)*ST(2,1)*s(2))*EQQQ(2,6,3)...
    + (PV(2,2)*ST(1,1)^2*s(1)+PV(1,1)*ST(2,2)^2*s(2)-PV(1,1)*ST(2,3)^2*s(2)-PV(2,2)*ST(1,3)^2*s(1)-PV(2,1)*ST(1,1)*ST(1,2)*s(1)+PV(2,3)*ST(1,2)*ST(1,3)*s(1)-PV(1,2)*ST(2,1)*ST(2,2)*s(2)+PV(1,3)*ST(2,1)*ST(2,3)*s(2))*EQQQ(3,8,2);

EvRwpvRhatxwpt = UT*EQ3b*UT';

% EvRwpvRhatHWwpt
EQ3c(1,1) = (ST(3,2)*STT(3,2))*EQQ(5,5)+(-ST(2,3)*STT(3,2)-ST(3,2)*STT(2,3))*EQQ(5,9)+(ST(2,3)*STT(2,3))*EQQ(9,9)...
    +(ST(3,1)*STT(3,1))*EQQ(2,2)+(ST(2,1)*STT(2,1))*EQQ(3,3)+(ST(2,2)*STT(2,2)+ST(3,3)*STT(3,3))*EQQ(6,6)+(-ST(2,2)*STT(3,3)-ST(3,3)*STT(2,2))*EQQ(6,8);
EQ3c(1,2) = (-ST(3,2)*STT(3,1))*EQQ(1,5)+(ST(2,3)*STT(3,1))*EQQ(1,9)+(ST(3,2)*STT(1,3))*EQQ(5,9)+(-ST(2,3)*STT(1,3))*EQQ(9,9)...
    +(-ST(3,1)*STT(3,2))*EQQ(2,4)+(-ST(2,1)*STT(1,1))*EQQ(3,3)+(ST(2,1)*STT(3,3))*EQQ(3,7)+(-ST(2,2)*STT(1,2))*EQQ(6,6)+(ST(3,3)*STT(1,2))*EQQ(6,8);
EQ3c(1,3) = (ST(3,2)*STT(2,1))*EQQ(1,5)+(-ST(2,3)*STT(2,1))*EQQ(1,9)+(-ST(3,2)*STT(1,2))*EQQ(5,5)+(ST(2,3)*STT(1,2))*EQQ(5,9)...
    +(-ST(3,1)*STT(1,1))*EQQ(2,2)+(ST(3,1)*STT(2,2))*EQQ(2,4)+(-ST(2,1)*STT(2,3))*EQQ(3,7)+(-ST(3,3)*STT(1,3))*EQQ(6,6)+(ST(2,2)*STT(1,3))*EQQ(6,8);
EQ3c(2,1) = (-ST(3,1)*STT(3,2))*EQQ(1,5)+(ST(3,1)*STT(2,3))*EQQ(1,9)+(ST(1,3)*STT(3,2))*EQQ(5,9)+(-ST(1,3)*STT(2,3))*EQQ(9,9)...
    +(-ST(3,2)*STT(3,1))*EQQ(2,4)+(-ST(1,1)*STT(2,1))*EQQ(3,3)+(ST(3,3)*STT(2,1))*EQQ(3,7)+(-ST(1,2)*STT(2,2))*EQQ(6,6)+(ST(1,2)*STT(3,3))*EQQ(6,8);
EQ3c(2,2) = (ST(3,1)*STT(3,1))*EQQ(1,1)+(-ST(1,3)*STT(3,1)-ST(3,1)*STT(1,3))*EQQ(1,9)+(ST(1,3)*STT(1,3))*EQQ(9,9)...
    +(ST(3,2)*STT(3,2))*EQQ(2,2)+(ST(1,1)*STT(1,1)+ST(3,3)*STT(3,3))*EQQ(3,3)+(-ST(1,1)*STT(3,3)-ST(3,3)*STT(1,1))*EQQ(3,7)+(ST(1,2)*STT(1,2))*EQQ(6,6);
EQ3c(2,3) = (-ST(3,1)*STT(2,1))*EQQ(1,1)+(ST(3,1)*STT(1,2))*EQQ(1,5)+(ST(1,3)*STT(2,1))*EQQ(1,9)+(-ST(1,3)*STT(1,2))*EQQ(5,9)...
    +(-ST(3,2)*STT(2,2))*EQQ(2,2)+(ST(3,2)*STT(1,1))*EQQ(2,4)+(-ST(3,3)*STT(2,3))*EQQ(3,3)+(ST(1,1)*STT(2,3))*EQQ(3,7)+(-ST(1,2)*STT(1,3))*EQQ(6,8);
EQ3c(3,1) = (ST(2,1)*STT(3,2))*EQQ(1,5)+(-ST(2,1)*STT(2,3))*EQQ(1,9)+(-ST(1,2)*STT(3,2))*EQQ(5,5)+(ST(1,2)*STT(2,3))*EQQ(5,9)...
    +(-ST(1,1)*STT(3,1))*EQQ(2,2)+(ST(2,2)*STT(3,1))*EQQ(2,4)+(-ST(2,3)*STT(2,1))*EQQ(3,7)+(-ST(1,3)*STT(3,3))*EQQ(6,6)+(ST(1,3)*STT(2,2))*EQQ(6,8);
EQ3c(3,2) = (-ST(2,1)*STT(3,1))*EQQ(1,1)+(ST(1,2)*STT(3,1))*EQQ(1,5)+(ST(2,1)*STT(1,3))*EQQ(1,9)+(-ST(1,2)*STT(1,3))*EQQ(5,9)...
    +(-ST(2,2)*STT(3,2))*EQQ(2,2)+(ST(1,1)*STT(3,2))*EQQ(2,4)+(-ST(2,3)*STT(3,3))*EQQ(3,3)+(ST(2,3)*STT(1,1))*EQQ(3,7)+(-ST(1,3)*STT(1,2))*EQQ(6,8);
EQ3c(3,3) = (ST(2,1)*STT(2,1))*EQQ(1,1)+(-ST(1,2)*STT(2,1)-ST(2,1)*STT(1,2))*EQQ(1,5)+(ST(1,2)*STT(1,2))*EQQ(5,5)...
    +(ST(1,1)*STT(1,1)+ST(2,2)*STT(2,2))*EQQ(2,2)+(-ST(1,1)*STT(2,2)-ST(2,2)*STT(1,1))*EQQ(2,4)+(ST(2,3)*STT(2,3))*EQQ(3,3)+(ST(1,3)*STT(1,3))*EQQ(6,6);
EvRwpvRGwpt = UT*EQ3c*UT';

EvRwpvRhatHWwpt = dt*EvRwpvRGwpt - dt*trace(Ggu)*EvRwpvRwpt;

% EvRhatHWwpvRhatHWwpt
GT = V'*Ggu*V;

EQ3d(1,1) = (GT(1,1)*ST(3,3)^2+GT(3,3)*ST(3,1)^2-GT(1,3)*ST(3,1)*ST(3,3)-GT(3,1)*ST(3,1)*ST(3,3))*EQQ(5,5)...
    + (2*GT(1,1)*ST(2,2)*ST(3,3)-GT(1,2)*ST(2,1)*ST(3,3)-GT(1,3)*ST(2,2)*ST(3,1)-GT(2,1)*ST(2,1)*ST(3,3)+GT(2,3)*ST(2,1)*ST(3,1)-GT(3,1)*ST(2,2)*ST(3,1)+GT(3,2)*ST(2,1)*ST(3,1))*EQQ(5,9)...
    + (GT(1,1)*ST(2,2)^2+GT(2,2)*ST(2,1)^2-GT(1,2)*ST(2,1)*ST(2,2)-GT(2,1)*ST(2,1)*ST(2,2))*EQQ(9,9)...
    + (GT(2,2)*ST(3,3)^2+GT(3,3)*ST(3,2)^2-GT(2,3)*ST(3,2)*ST(3,3)-GT(3,2)*ST(3,2)*ST(3,3))*EQQ(2,2)...
    + (GT(2,2)*ST(2,3)^2+GT(3,3)*ST(2,2)^2-GT(2,3)*ST(2,2)*ST(2,3)-GT(3,2)*ST(2,2)*ST(2,3))*EQQ(3,3)...
    + (GT(1,1)*ST(2,3)^2+GT(1,1)*ST(3,2)^2+GT(2,2)*ST(3,1)^2+GT(3,3)*ST(2,1)^2-GT(1,3)*ST(2,1)*ST(2,3)-GT(1,2)*ST(3,1)*ST(3,2)-GT(3,1)*ST(2,1)*ST(2,3)-GT(2,1)*ST(3,1)*ST(3,2))*EQQ(6,6)...
    + (2*GT(1,1)*ST(2,3)*ST(3,2)-GT(1,2)*ST(2,3)*ST(3,1)-GT(1,3)*ST(2,1)*ST(3,2)-GT(2,1)*ST(2,3)*ST(3,1)+GT(2,3)*ST(2,1)*ST(3,1)-GT(3,1)*ST(2,1)*ST(3,2)+GT(3,2)*ST(2,1)*ST(3,1))*EQQ(6,8);
EQ3d(1,2) = (GT(1,2)*ST(3,3)^2-GT(1,3)*ST(3,2)*ST(3,3)-GT(3,2)*ST(3,1)*ST(3,3)+GT(3,3)*ST(3,1)*ST(3,2))*EQQ(1,5)...
    + (GT(1,2)*ST(2,2)*ST(3,3)-GT(1,3)*ST(2,2)*ST(3,2)-GT(2,2)*ST(2,1)*ST(3,3)+GT(2,3)*ST(2,1)*ST(3,2))*EQQ(1,9)...
    + (GT(1,2)*ST(1,1)*ST(3,3)-GT(1,1)*ST(1,2)*ST(3,3)+GT(3,1)*ST(1,2)*ST(3,1)-GT(3,2)*ST(1,1)*ST(3,1))*EQQ(5,9)...
    + (GT(1,2)*ST(1,1)*ST(2,2)-GT(1,1)*ST(1,2)*ST(2,2)+GT(2,1)*ST(1,2)*ST(2,1)-GT(2,2)*ST(1,1)*ST(2,1))*EQQ(9,9)...
    + (GT(2,1)*ST(3,3)^2-GT(2,3)*ST(3,1)*ST(3,3)-GT(3,1)*ST(3,2)*ST(3,3)+GT(3,3)*ST(3,1)*ST(3,2))*EQQ(2,4)...
    + (GT(2,3)*ST(1,2)*ST(2,3)-GT(2,2)*ST(1,3)*ST(2,3)+GT(3,2)*ST(1,3)*ST(2,2)-GT(3,3)*ST(1,2)*ST(2,2))*EQQ(3,3)...
    + (GT(2,1)*ST(2,3)*ST(3,2)-GT(2,2)*ST(2,3)*ST(3,1)-GT(3,1)*ST(2,2)*ST(3,2)+GT(3,2)*ST(2,2)*ST(3,1))*EQQ(3,7)...
    + (GT(1,3)*ST(1,1)*ST(2,3)-GT(1,1)*ST(1,3)*ST(2,3)+GT(3,1)*ST(1,3)*ST(2,1)-GT(3,3)*ST(1,1)*ST(2,1))*EQQ(6,6)...
    + (GT(1,3)*ST(1,1)*ST(3,2)-GT(1,1)*ST(1,3)*ST(3,2)+GT(2,1)*ST(1,3)*ST(3,1)-GT(2,3)*ST(1,1)*ST(3,1))*EQQ(6,8);
EQ3d(1,3) = (GT(1,3)*ST(2,2)*ST(3,3)-GT(1,2)*ST(2,3)*ST(3,3)+GT(3,2)*ST(2,3)*ST(3,1)-GT(3,3)*ST(2,2)*ST(3,1))*EQQ(1,5)...
    + (GT(1,3)*ST(2,2)^2-GT(1,2)*ST(2,2)*ST(2,3)+GT(2,2)*ST(2,1)*ST(2,3)-GT(2,3)*ST(2,1)*ST(2,2))*EQQ(1,9)...
    + (GT(1,3)*ST(1,1)*ST(3,3)-GT(1,1)*ST(1,3)*ST(3,3)+GT(3,1)*ST(1,3)*ST(3,1)-GT(3,3)*ST(1,1)*ST(3,1))*EQQ(5,5)...
    + (GT(1,3)*ST(1,1)*ST(2,2)-GT(1,1)*ST(1,3)*ST(2,2)+GT(2,1)*ST(1,3)*ST(2,1)-GT(2,3)*ST(1,1)*ST(2,1))*EQQ(5,9)...
    + (GT(2,3)*ST(1,2)*ST(3,3)-GT(2,2)*ST(1,3)*ST(3,3)+GT(3,2)*ST(1,3)*ST(3,2)-GT(3,3)*ST(1,2)*ST(3,2))*EQQ(2,2)...
    + (GT(2,3)*ST(2,1)*ST(3,3)-GT(2,1)*ST(2,3)*ST(3,3)+GT(3,1)*ST(2,3)*ST(3,2)-GT(3,3)*ST(2,1)*ST(3,2))*EQQ(2,4)...
    + (GT(3,1)*ST(2,2)^2-GT(2,1)*ST(2,2)*ST(2,3)+GT(2,2)*ST(2,1)*ST(2,3)-GT(3,2)*ST(2,1)*ST(2,2))*EQQ(3,7)...
    + (GT(1,2)*ST(1,1)*ST(3,2)-GT(1,1)*ST(1,2)*ST(3,2)+GT(2,1)*ST(1,2)*ST(3,1)-GT(2,2)*ST(1,1)*ST(3,1))*EQQ(6,6)...
    + (GT(1,2)*ST(1,1)*ST(2,3)-GT(1,1)*ST(1,2)*ST(2,3)+GT(3,1)*ST(1,2)*ST(2,1)-GT(3,2)*ST(1,1)*ST(2,1))*EQQ(6,8);
EQ3d(2,1) = (GT(2,1)*ST(3,3)^2-GT(2,3)*ST(3,1)*ST(3,3)-GT(3,1)*ST(3,2)*ST(3,3)+GT(3,3)*ST(3,1)*ST(3,2))*EQQ(1,5)...
    + (GT(2,1)*ST(2,2)*ST(3,3)-GT(2,2)*ST(2,1)*ST(3,3)-GT(3,1)*ST(2,2)*ST(3,2)+GT(3,2)*ST(2,1)*ST(3,2))*EQQ(1,9)...
    + (GT(1,3)*ST(1,2)*ST(3,1)-GT(1,1)*ST(1,2)*ST(3,3)+GT(2,1)*ST(1,1)*ST(3,3)-GT(2,3)*ST(1,1)*ST(3,1))*EQQ(5,9)...
    + (GT(1,2)*ST(1,2)*ST(2,1)-GT(1,1)*ST(1,2)*ST(2,2)+GT(2,1)*ST(1,1)*ST(2,2)-GT(2,2)*ST(1,1)*ST(2,1))*EQQ(9,9)...
    + (GT(1,2)*ST(3,3)^2-GT(1,3)*ST(3,2)*ST(3,3)-GT(3,2)*ST(3,1)*ST(3,3)+GT(3,3)*ST(3,1)*ST(3,2))*EQQ(2,4)...
    + (GT(2,3)*ST(1,3)*ST(2,2)-GT(2,2)*ST(1,3)*ST(2,3)+GT(3,2)*ST(1,2)*ST(2,3)-GT(3,3)*ST(1,2)*ST(2,2))*EQQ(3,3)...
    + (GT(1,2)*ST(2,3)*ST(3,2)-GT(1,3)*ST(2,2)*ST(3,2)-GT(2,2)*ST(2,3)*ST(3,1)+GT(2,3)*ST(2,2)*ST(3,1))*EQQ(3,7)...
    + (GT(1,3)*ST(1,3)*ST(2,1)-GT(1,1)*ST(1,3)*ST(2,3)+GT(3,1)*ST(1,1)*ST(2,3)-GT(3,3)*ST(1,1)*ST(2,1))*EQQ(6,6)...
    + (GT(1,2)*ST(1,3)*ST(3,1)-GT(1,1)*ST(1,3)*ST(3,2)+GT(3,1)*ST(1,1)*ST(3,2)-GT(3,2)*ST(1,1)*ST(3,1))*EQQ(6,8);
EQ3d(2,2) = (GT(2,2)*ST(3,3)^2+GT(3,3)*ST(3,2)^2-GT(2,3)*ST(3,2)*ST(3,3)-GT(3,2)*ST(3,2)*ST(3,3))*EQQ(1,1)...
    + (GT(1,3)*ST(1,2)*ST(3,2)-GT(1,2)*ST(1,2)*ST(3,3)-GT(2,1)*ST(1,2)*ST(3,3)+2*GT(2,2)*ST(1,1)*ST(3,3)-GT(2,3)*ST(1,1)*ST(3,2)+GT(3,1)*ST(1,2)*ST(3,2)-GT(3,2)*ST(1,1)*ST(3,2))*EQQ(1,9)...
    + (GT(1,1)*ST(1,2)^2+GT(2,2)*ST(1,1)^2-GT(1,2)*ST(1,1)*ST(1,2)-GT(2,1)*ST(1,1)*ST(1,2))*EQQ(9,9)...
    + (GT(1,1)*ST(3,3)^2+GT(3,3)*ST(3,1)^2-GT(1,3)*ST(3,1)*ST(3,3)-GT(3,1)*ST(3,1)*ST(3,3))*EQQ(2,2)...
    + (GT(2,2)*ST(1,3)^2+GT(1,1)*ST(3,2)^2+GT(3,3)*ST(1,2)^2+GT(2,2)*ST(3,1)^2-GT(2,3)*ST(1,2)*ST(1,3)-GT(3,2)*ST(1,2)*ST(1,3)-GT(1,2)*ST(3,1)*ST(3,2)-GT(2,1)*ST(3,1)*ST(3,2))*EQQ(3,3)...
    + (GT(1,3)*ST(1,2)*ST(3,2)-GT(1,2)*ST(1,3)*ST(3,2)-GT(2,1)*ST(1,3)*ST(3,2)+2*GT(2,2)*ST(1,3)*ST(3,1)-GT(2,3)*ST(1,2)*ST(3,1)+GT(3,1)*ST(1,2)*ST(3,2)-GT(3,2)*ST(1,2)*ST(3,1))*EQQ(3,7)...
    + (GT(1,1)*ST(1,3)^2+GT(3,3)*ST(1,1)^2-GT(1,3)*ST(1,1)*ST(1,3)-GT(3,1)*ST(1,1)*ST(1,3))*EQQ(6,6);
EQ3d(2,3) = (GT(2,3)*ST(2,2)*ST(3,3)-GT(2,2)*ST(2,3)*ST(3,3)+GT(3,2)*ST(2,3)*ST(3,2)-GT(3,3)*ST(2,2)*ST(3,2))*EQQ(1,1)...
    + (GT(2,3)*ST(1,1)*ST(3,3)-GT(2,1)*ST(1,3)*ST(3,3)+GT(3,1)*ST(1,3)*ST(3,2)-GT(3,3)*ST(1,1)*ST(3,2))*EQQ(1,5)...
    + (GT(1,2)*ST(1,2)*ST(2,3)-GT(1,3)*ST(1,2)*ST(2,2)-GT(2,2)*ST(1,1)*ST(2,3)+GT(2,3)*ST(1,1)*ST(2,2))*EQQ(1,9)...
    + (GT(2,3)*ST(1,1)^2+GT(1,1)*ST(1,2)*ST(1,3)-GT(1,3)*ST(1,1)*ST(1,2)-GT(2,1)*ST(1,1)*ST(1,3))*EQQ(5,9)...
    + (GT(1,3)*ST(2,1)*ST(3,3)-GT(1,1)*ST(2,3)*ST(3,3)+GT(3,1)*ST(2,3)*ST(3,1)-GT(3,3)*ST(2,1)*ST(3,1))*EQQ(2,2)...
    + (GT(1,3)*ST(1,2)*ST(3,3)-GT(1,2)*ST(1,3)*ST(3,3)+GT(3,2)*ST(1,3)*ST(3,1)-GT(3,3)*ST(1,2)*ST(3,1))*EQQ(2,4)...
    + (GT(1,2)*ST(2,1)*ST(3,2)-GT(1,1)*ST(2,2)*ST(3,2)+GT(2,1)*ST(2,2)*ST(3,1)-GT(2,2)*ST(2,1)*ST(3,1))*EQQ(3,3)...
    + (GT(2,1)*ST(1,3)*ST(2,2)-GT(2,2)*ST(1,3)*ST(2,1)-GT(3,1)*ST(1,2)*ST(2,2)+GT(3,2)*ST(1,2)*ST(2,1))*EQQ(3,7)...
    + (GT(3,2)*ST(1,1)^2+GT(1,1)*ST(1,2)*ST(1,3)-GT(1,2)*ST(1,1)*ST(1,3)-GT(3,1)*ST(1,1)*ST(1,2))*EQQ(6,8);
EQ3d(3,1) = (GT(2,3)*ST(2,3)*ST(3,1)-GT(2,1)*ST(2,3)*ST(3,3)+GT(3,1)*ST(2,2)*ST(3,3)-GT(3,3)*ST(2,2)*ST(3,1))*EQQ(1,5)...
    + (GT(3,1)*ST(2,2)^2-GT(2,1)*ST(2,2)*ST(2,3)+GT(2,2)*ST(2,1)*ST(2,3)-GT(3,2)*ST(2,1)*ST(2,2))*EQQ(1,9)...
    + (GT(1,3)*ST(1,3)*ST(3,1)-GT(1,1)*ST(1,3)*ST(3,3)+GT(3,1)*ST(1,1)*ST(3,3)-GT(3,3)*ST(1,1)*ST(3,1))*EQQ(5,5)...
    + (GT(1,2)*ST(1,3)*ST(2,1)-GT(1,1)*ST(1,3)*ST(2,2)+GT(3,1)*ST(1,1)*ST(2,2)-GT(3,2)*ST(1,1)*ST(2,1))*EQQ(5,9)...
    + (GT(2,3)*ST(1,3)*ST(3,2)-GT(2,2)*ST(1,3)*ST(3,3)+GT(3,2)*ST(1,2)*ST(3,3)-GT(3,3)*ST(1,2)*ST(3,2))*EQQ(2,2)...
    + (GT(1,3)*ST(2,3)*ST(3,2)-GT(1,2)*ST(2,3)*ST(3,3)+GT(3,2)*ST(2,1)*ST(3,3)-GT(3,3)*ST(2,1)*ST(3,2))*EQQ(2,4)...
    + (GT(1,3)*ST(2,2)^2-GT(1,2)*ST(2,2)*ST(2,3)+GT(2,2)*ST(2,1)*ST(2,3)-GT(2,3)*ST(2,1)*ST(2,2))*EQQ(3,7)...
    + (GT(1,2)*ST(1,2)*ST(3,1)-GT(1,1)*ST(1,2)*ST(3,2)+GT(2,1)*ST(1,1)*ST(3,2)-GT(2,2)*ST(1,1)*ST(3,1))*EQQ(6,6)...
    + (GT(1,3)*ST(1,2)*ST(2,1)-GT(1,1)*ST(1,2)*ST(2,3)+GT(2,1)*ST(1,1)*ST(2,3)-GT(2,3)*ST(1,1)*ST(2,1))*EQQ(6,8);
EQ3d(3,2) = (GT(2,3)*ST(2,3)*ST(3,2)-GT(2,2)*ST(2,3)*ST(3,3)+GT(3,2)*ST(2,2)*ST(3,3)-GT(3,3)*ST(2,2)*ST(3,2))*EQQ(1,1)...
    + (GT(1,3)*ST(1,3)*ST(3,2)-GT(1,2)*ST(1,3)*ST(3,3)+GT(3,2)*ST(1,1)*ST(3,3)-GT(3,3)*ST(1,1)*ST(3,2))*EQQ(1,5)...
    + (GT(2,1)*ST(1,2)*ST(2,3)-GT(2,2)*ST(1,1)*ST(2,3)-GT(3,1)*ST(1,2)*ST(2,2)+GT(3,2)*ST(1,1)*ST(2,2))*EQQ(1,9)...
    + (GT(3,2)*ST(1,1)^2+GT(1,1)*ST(1,2)*ST(1,3)-GT(1,2)*ST(1,1)*ST(1,3)-GT(3,1)*ST(1,1)*ST(1,2))*EQQ(5,9)...
    + (GT(1,3)*ST(2,3)*ST(3,1)-GT(1,1)*ST(2,3)*ST(3,3)+GT(3,1)*ST(2,1)*ST(3,3)-GT(3,3)*ST(2,1)*ST(3,1))*EQQ(2,2)...
    + (GT(2,3)*ST(1,3)*ST(3,1)-GT(2,1)*ST(1,3)*ST(3,3)+GT(3,1)*ST(1,2)*ST(3,3)-GT(3,3)*ST(1,2)*ST(3,1))*EQQ(2,4)...
    + (GT(1,2)*ST(2,2)*ST(3,1)-GT(1,1)*ST(2,2)*ST(3,2)+GT(2,1)*ST(2,1)*ST(3,2)-GT(2,2)*ST(2,1)*ST(3,1))*EQQ(3,3)...
    + (GT(1,2)*ST(1,3)*ST(2,2)-GT(1,3)*ST(1,2)*ST(2,2)-GT(2,2)*ST(1,3)*ST(2,1)+GT(2,3)*ST(1,2)*ST(2,1))*EQQ(3,7)...
    + (GT(2,3)*ST(1,1)^2+GT(1,1)*ST(1,2)*ST(1,3)-GT(1,3)*ST(1,1)*ST(1,2)-GT(2,1)*ST(1,1)*ST(1,3))*EQQ(6,8);
EQ3d(3,3) = (GT(2,2)*ST(2,3)^2+GT(3,3)*ST(2,2)^2-GT(2,3)*ST(2,2)*ST(2,3)-GT(3,2)*ST(2,2)*ST(2,3))*EQQ(1,1)...
    + (GT(1,2)*ST(1,3)*ST(2,3)-GT(1,3)*ST(1,3)*ST(2,2)+GT(2,1)*ST(1,3)*ST(2,3)-GT(2,3)*ST(1,1)*ST(2,3)-GT(3,1)*ST(1,3)*ST(2,2)-GT(3,2)*ST(1,1)*ST(2,3)+2*GT(3,3)*ST(1,1)*ST(2,2))*EQQ(1,5)...
    + (GT(1,1)*ST(1,3)^2+GT(3,3)*ST(1,1)^2-GT(1,3)*ST(1,1)*ST(1,3)-GT(3,1)*ST(1,1)*ST(1,3))*EQQ(5,5)...
    + (GT(1,1)*ST(2,3)^2+GT(2,2)*ST(1,3)^2+GT(3,3)*ST(1,2)^2+GT(3,3)*ST(2,1)^2-GT(2,3)*ST(1,2)*ST(1,3)-GT(1,3)*ST(2,1)*ST(2,3)-GT(3,2)*ST(1,2)*ST(1,3)-GT(3,1)*ST(2,1)*ST(2,3))*EQQ(2,2)...
    + (GT(1,2)*ST(1,3)*ST(2,3)-GT(1,3)*ST(1,2)*ST(2,3)+GT(2,1)*ST(1,3)*ST(2,3)-GT(2,3)*ST(1,3)*ST(2,1)-GT(3,1)*ST(1,2)*ST(2,3)-GT(3,2)*ST(1,3)*ST(2,1)+2*GT(3,3)*ST(1,2)*ST(2,1))*EQQ(2,4)...
    + (GT(1,1)*ST(2,2)^2+GT(2,2)*ST(2,1)^2-GT(1,2)*ST(2,1)*ST(2,2)-GT(2,1)*ST(2,1)*ST(2,2))*EQQ(3,3)...
    + (GT(1,1)*ST(1,2)^2+GT(2,2)*ST(1,1)^2-GT(1,2)*ST(1,1)*ST(1,2)-GT(2,1)*ST(1,1)*ST(1,2))*EQQ(6,6);

EvRhatHWwpvRhatHWwpt = dt*UT*EQ3d*UT';

% final result
EvRpvRptdt = EvRwpvRwpt + dt*(EvRwpvRhatxwpt+EvRwpvRhatxwpt')...
    + 0.5*(EvRwpvRhatHWwpt+EvRwpvRhatHWwpt') + EvRhatHWwpvRhatHWwpt;

%% E[x(t+dt)x(t+dt)]
EvRvRt(1,1) = (s(2)^2+s(3)^2)*EQQ(6,6)-2*s(2)*s(3)*EQQ(6,8);
EvRvRt(2,2) = (s(1)^2+s(3)^2)*EQQ(3,3)-2*s(1)*s(3)*EQQ(3,7);
EvRvRt(3,3) = (s(1)^2+s(2)^2)*EQQ(2,2)-2*s(1)*s(2)*EQQ(2,4);
Exxt = Sigmac+Miu*Miu'+P*EvRvRt*P';

Ebgbgtdt = Exxt(1:3,1:3) + dt*Ggv;
Ebgptdt = Exxt(1:3,4:6) + dt*Exxt(1:3,7:9);
Ebgbatdt = Exxt(1:3,10:12);
Epptdt = Exxt(4:6,4:6) + dt*(Exxt(4:6,7:9)+Exxt(7:9,4:6)) + dt^2*Exxt(7:9,7:9);
Epbatdt = Exxt(4:6,10:12) + dt*Exxt(7:9,10:12);
Ebabatdt = Exxt(10:12,10:12) + dt*Gav;

ERavRt = [0, Va(3)*EQ(3,3), -V(2)*EQ(2,2);
    -Va(3)*EQ(3,3), 0, Va(1)*EQ(1,1);
    Va(2)*EQ(2,2), -Va(1)*EQ(1,1), 0];
ERavRt = U*ERavRt;

ERPbavRt(1) = -VPba(2,3)*EQ(2,2) + VPba(3,2)*EQ(3,3);
ERPbavRt(2) = VPba(1,3)*EQ(1,1) - VPba(3,1)*EQ(3,3);
ERPbavRt(3) = -VPba(1,2)*EQ(1,1) + VPba(2,1)*EQ(2,2);
ERPbavRt = U*ERPbavRt;

ERPbavRvRt(1,1) = (VPba(1,1)*s(2)^2+VPba(1,1)*s(3)^2)*EQQQ(1,6,6) +(-2*VPba(1,1)*s(2)*s(3))*EQQQ(1,6,8) +(VPba(2,2)*s(1)*s(3)+VPba(3,3)*s(1)*s(2))*EQQQ(2,6,7) +(-VPba(2,2)*s(1)*s(2)-VPba(3,3)*s(1)*s(3))*EQQQ(4,3,6) +(VPba(3,3)*s(2)*s(3)-VPba(2,2)*s(3)^2)*EQQQ(2,6,3) +(VPba(2,2)*s(2)*s(3)-VPba(3,3)*s(2)^2)*EQQQ(3,8,2);
ERPbavRvRt(1,2) = (VPba(1,2)*s(1)^2+VPba(1,2)*s(3)^2)*EQQQ(1,3,3) +(-2*VPba(1,2)*s(1)*s(3))*EQQQ(1,3,7) +(VPba(2,1)*s(1)*s(3))*EQQQ(2,6,7) +(-VPba(2,1)*s(1)*s(2))*EQQQ(4,3,6) +(-VPba(2,1)*s(3)^2)*EQQQ(2,6,3) +(VPba(2,1)*s(2)*s(3))*EQQQ(3,8,2);
ERPbavRvRt(1,3) = (VPba(1,3)*s(1)^2+VPba(1,3)*s(2)^2)*EQQQ(1,2,2) +(-2*VPba(1,3)*s(1)*s(2))*EQQQ(1,2,4) +(VPba(3,1)*s(1)*s(2))*EQQQ(2,6,7) +(-VPba(3,1)*s(1)*s(3))*EQQQ(4,3,6) +(VPba(3,1)*s(2)*s(3))*EQQQ(2,6,3) +(-VPba(3,1)*s(2)^2)*EQQQ(3,8,2);
ERPbavRvRt(2,1) = (VPba(2,1)*s(2)^2+VPba(2,1)*s(3)^2)*EQQQ(5,6,6) +(-2*VPba(2,1)*s(2)*s(3))*EQQQ(5,6,8) +(VPba(1,2)*s(2)*s(3))*EQQQ(2,6,7) +(-VPba(1,2)*s(3)^2)*EQQQ(4,3,6) +(-VPba(1,2)*s(1)*s(2))*EQQQ(2,6,3) +(VPba(1,2)*s(1)*s(3))*EQQQ(3,8,2);
ERPbavRvRt(2,2) = (VPba(2,2)*s(1)^2+VPba(2,2)*s(3)^2)*EQQQ(5,3,3) +(-2*VPba(2,2)*s(1)*s(3))*EQQQ(5,3,7) +(VPba(1,1)*s(2)*s(3)+VPba(3,3)*s(1)*s(2))*EQQQ(2,6,7) +(VPba(3,3)*s(1)*s(3)-VPba(1,1)*s(3)^2)*EQQQ(4,3,6) +(-VPba(1,1)*s(1)*s(2)-VPba(3,3)*s(2)*s(3))*EQQQ(2,6,3) +(VPba(1,1)*s(1)*s(3)-VPba(3,3)*s(1)^2)*EQQQ(3,8,2);
ERPbavRvRt(2,3) = (VPba(2,3)*s(1)^2+VPba(2,3)*s(2)^2)*EQQQ(5,2,2) +(-2*VPba(2,3)*s(1)*s(2))*EQQQ(5,2,4) +(VPba(3,2)*s(1)*s(2))*EQQQ(2,6,7) +(VPba(3,2)*s(1)*s(3))*EQQQ(4,3,6) +(-VPba(3,2)*s(2)*s(3))*EQQQ(2,6,3) +(-VPba(3,2)*s(1)^2)*EQQQ(3,8,2);
ERPbavRvRt(3,1) = (VPba(3,1)*s(2)^2+VPba(3,1)*s(3)^2)*EQQQ(9,6,6) +(-2*VPba(3,1)*s(2)*s(3))*EQQQ(9,6,8) +(VPba(1,3)*s(2)*s(3))*EQQQ(2,6,7) +(-VPba(1,3)*s(2)^2)*EQQQ(4,3,6) +(VPba(1,3)*s(1)*s(2))*EQQQ(2,6,3) +(-VPba(1,3)*s(1)*s(3))*EQQQ(3,8,2);
ERPbavRvRt(3,2) = (VPba(3,2)*s(1)^2+VPba(3,2)*s(3)^2)*EQQQ(9,3,3) +(-2*VPba(3,2)*s(1)*s(3))*EQQQ(9,3,7) +(VPba(2,3)*s(1)*s(3))*EQQQ(2,6,7) +(VPba(2,3)*s(1)*s(2))*EQQQ(4,3,6) +(-VPba(2,3)*s(1)^2)*EQQQ(2,6,3) +(-VPba(2,3)*s(2)*s(3))*EQQQ(3,8,2);
ERPbavRvRt(3,3) = (VPba(3,3)*s(1)^2+VPba(3,3)*s(2)^2)*EQQQ(9,2,2) +(-2*VPba(3,3)*s(1)*s(2))*EQQQ(9,2,4) +(VPba(1,1)*s(2)*s(3)+VPba(2,2)*s(1)*s(3))*EQQQ(2,6,7) +(VPba(2,2)*s(1)*s(2)-VPba(1,1)*s(2)^2)*EQQQ(4,3,6) +(VPba(1,1)*s(1)*s(2)-VPba(2,2)*s(1)^2)*EQQQ(2,6,3) +(-VPba(1,1)*s(1)*s(3)-VPba(2,2)*s(2)*s(3))*EQQQ(3,8,2);
ERPbavRvRt = U*ERPbavRvRt;

Evbgtdt = Exxt(7:9,1:3) + dt*ERt*((a+Miuba)*Miubg' + Sigmac(10:12,1:3))...
    + dt*ERavRt*Pbg' + dt*ERPbavRt*Miubg' + dt*ERPbavRvRt*Pbg';

Evptdt = Exxt(7:9,4:6) + dt*Exxt(7:9,7:9)...
    + dt*ERt*((a+Miuba)*Miup' + Sigmac(10:12,4:6))...
    + dt*ERavRt*Pp' + dt*ERPbavRt*Miup' + dt*ERPbavRvRt*Pp'...
    + dt^2*ERt*((a+Miuba)*Miuv' + Sigmac(10:12,7:9))...
    + dt^2*ERavRt*Pv' + dt^2*ERPbavRt*Miuv' + dt^2*ERPbavRvRt*Pv';

Evbatdt = Exxt(7:9,10:12) + dt*ERt*((a+Miuba)*Miuba' + Sigmac(10:12,10:12))...
    + dt*ERavRt*Pba' + dt*ERPbavRt*Miuba' + dt*ERPbavRvRt*Pba';

ERRt(1,1) = (V(1,1)^2+V(2,1)^2+V(3,1)^2)*EQQ(1,1) +(V(1,2)^2+V(2,2)^2+V(3,2)^2)*EQQ(2,2) +(V(1,3)^2+V(2,3)^2+V(3,3)^2)*EQQ(3,3);
ERRt(1,2) = (V(1,1)*V(1,2)+V(2,1)*V(2,2)+V(3,1)*V(3,2))*EQQ(1,5) +(V(1,1)*V(1,2)+V(2,1)*V(2,2)+V(3,1)*V(3,2))*EQQ(2,4);
ERRt(1,3) = (V(1,1)*V(1,3)+V(2,1)*V(2,3)+V(3,1)*V(3,3))*EQQ(1,9) +(V(1,1)*V(1,3)+V(2,1)*V(2,3)+V(3,1)*V(3,3))*EQQ(3,7);
ERRt(2,1) = (V(1,1)*V(1,2)+V(2,1)*V(2,2)+V(3,1)*V(3,2))*EQQ(1,5) +(V(1,1)*V(1,2)+V(2,1)*V(2,2)+V(3,1)*V(3,2))*EQQ(2,4);
ERRt(2,2) = (V(1,2)^2+V(2,2)^2+V(3,2)^2)*EQQ(5,5) +(V(1,1)^2+V(2,1)^2+V(3,1)^2)*EQQ(2,2) +(V(1,3)^2+V(2,3)^2+V(3,3)^2)*EQQ(6,6);
ERRt(2,3) = (V(1,2)*V(1,3)+V(2,2)*V(2,3)+V(3,2)*V(3,3))*EQQ(5,9) +(V(1,2)*V(1,3)+V(2,2)*V(2,3)+V(3,2)*V(3,3))*EQQ(6,8);
ERRt(3,1) = (V(1,1)*V(1,3)+V(2,1)*V(2,3)+V(3,1)*V(3,3))*EQQ(1,9) +(V(1,1)*V(1,3)+V(2,1)*V(2,3)+V(3,1)*V(3,3))*EQQ(3,7);
ERRt(3,2) = (V(1,2)*V(1,3)+V(2,2)*V(2,3)+V(3,2)*V(3,3))*EQQ(5,9) +(V(1,2)*V(1,3)+V(2,2)*V(2,3)+V(3,2)*V(3,3))*EQQ(6,8);
ERRt(3,3) = (V(1,3)^2+V(2,3)^2+V(3,3)^2)*EQQ(9,9) +(V(1,1)^2+V(2,1)^2+V(3,1)^2)*EQQ(3,3) +(V(1,2)^2+V(2,2)^2+V(3,2)^2)*EQQ(6,6);
ERRt = U*ERRt*U';

Evvtdt = Exxt(7:9,7:9) + dt*ERt*((a+Miuba)*Miuv' + Sigmac(10:12,7:9))...
    + dt*ERavRt*Pv' + dt*ERPbavRt*Miuv' + dt*ERPbavRvRt*Pv'...
    + (dt*ERt*((a+Miuba)*Miuv' + Sigmac(10:12,7:9))...
    + dt*ERavRt*Pv' + dt*ERPbavRt*Miuv' + dt*ERPbavRvRt*Pv')'...
    + dt*Gau*ERRt;

% final result
Exxtdt = [Ebgbgtdt, Ebgptdt, Evbgtdt', Ebgbatdt;
    Ebgptdt', Epptdt, Evptdt', Epbatdt;
    Evbgtdt, Evptdt, Evvtdt, Evbatdt;
    Ebgbatdt', Epbatdt', Evbatdt', Ebabatdt];

%% MLE
covxxtdt = Exxtdt-Extdt*Extdt';
covxvRptdt = ExvRptdt;
covvRpvRptdt = EvRpvRptdt;

Ptdt = covxvRptdt*covvRpvRptdt^-1;
Miutdt = Extdt;
Sigmatdt = covxxtdt - Ptdt*covxvRptdt' + Ptdt*(trace(Stdt)*eye(3)-Stdt)*Ptdt';

MFGtdt.P = Ptdt;
MFGtdt.Miu = Miutdt;
MFGtdt.Sigma = Sigmatdt;

end

