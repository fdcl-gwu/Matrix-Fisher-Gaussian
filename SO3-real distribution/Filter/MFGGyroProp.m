function [ ERtdt ] = MFGGyroProp( Miu, Sigma, P, U, S, V, dt )

EQ = diag(pdf_MF_moment(diag(S)));
EQQ = pdf_MF_moment2(diag(S));

% E[R(t+dt)]
ERt = U*EQ*V';

ERHatPvRt(1,1) = (V(2,3)*P(2,3)-V(2,2)*P(3,3))*(S(2,2)*EQQ(2,2)-S(1,1)*EQQ(2,4))+...
    (V(3,2)*P(3,2)-V(3,3)*P(2,2))*(S(3,3)*EQQ(3,3)-S(1,1)*EQQ(3,7));
ERHatPvRt(1,2) = (V(2,1)*P(3,3)-V(2,3)*P(1,3))*(S(2,2)*EQQ(2,2)-S(1,1)*EQQ(2,4))+...
    (V(3,3)*P(1,2)-V(3,1)*P(3,2))*(S(3,3)*EQQ(3,3)-S(1,1)*EQQ(3,7));
ERHatPvRt(1,3) = (V(2,2)*P(1,3)-V(2,1)*P(2,3))*(S(2,2)*EQQ(2,2)-S(1,1)*EQQ(2,4))+...
    (V(3,1)*P(2,2)-V(3,2)*P(1,2))*(S(3,3)*EQQ(3,3)-S(1,1)*EQQ(3,7));
ERHatPvRt(2,1) = (V(1,2)*P(3,3)-V(1,3)*P(2,3))*(S(1,1)*EQQ(4,4)-S(2,2)*EQQ(4,2))+...
    (V(3,3)*P(2,1)-V(3,2)*P(3,1))*(S(3,3)*EQQ(6,6)-S(2,2)*EQQ(6,8));
ERHatPvRt(2,2) = (V(1,3)*P(1,3)-V(1,1)*P(3,3))*(S(1,1)*EQQ(4,4)-S(2,2)*EQQ(4,2))+...
    (V(3,1)*P(3,1)-V(3,3)*P(1,1))*(S(3,3)*EQQ(6,6)-S(2,2)*EQQ(6,8));
ERHatPvRt(2,3) = (V(1,1)*P(2,3)-V(1,2)*P(1,3))*(S(1,1)*EQQ(4,4)-S(2,2)*EQQ(4,2))+...
    (V(3,2)*P(1,1)-V(3,1)*P(2,1))*(S(3,3)*EQQ(6,6)-S(2,2)*EQQ(6,8));
ERHatPvRt(3,1) = (V(1,3)*P(2,2)-V(1,2)*P(3,2))*(S(1,1)*EQQ(7,7)-S(3,3)*EQQ(7,3))+...
    (V(2,2)*P(3,1)-V(2,3)*P(2,1))*(S(2,2)*EQQ(8,8)-S(3,3)*EQQ(8,6));
ERHatPvRt(3,2) = (V(1,1)*P(3,2)-V(1,3)*P(1,2))*(S(1,1)*EQQ(7,7)-S(3,3)*EQQ(7,3))+...
    (V(2,3)*P(1,1)-V(2,1)*P(3,1))*(S(2,2)*EQQ(8,8)-S(3,3)*EQQ(8,6));
ERHatPvRt(3,3) = (V(1,2)*P(1,2)-V(1,1)*P(2,2))*(S(1,1)*EQQ(7,7)-S(3,3)*EQQ(7,3))+...
    (V(2,1)*P(2,1)-V(2,2)*P(1,1))*(S(2,2)*EQQ(8,8)-S(3,3)*EQQ(8,6));
ERHatPvRt = U*ERHatPvRt;
ERHatxt = ERt*hat(Miu)+ERHatPvRt;

ERtdt = ERt+ERHatxt*dt;

end

