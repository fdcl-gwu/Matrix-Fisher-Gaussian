function [ Miutdt, Sigmatdt, Ptdt, Utdt, Stdt, Vtdt ] = MFGGyroProp( omega, Miu, Sigma, P, U, S, V, H, SigmaWx, dt )

s = diag(S);
[EQ,EQQ,EQQQ] = pdf_MF_moment123(s);

%% E[R(t+dt)]
ERt = U*EQ*V';

EQ1a(1,1) = (V(3,2)*P(2,3)-V(2,2)*P(3,3))*EQ(2,2)+(V(2,3)*P(3,2)-V(3,3)*P(2,2))*EQ(3,3);
EQ1a(1,2) = (V(1,2)*P(3,3)-V(3,2)*P(1,3))*EQ(2,2)+(V(3,3)*P(1,2)-V(1,3)*P(3,2))*EQ(3,3);
EQ1a(1,3) = (V(2,2)*P(1,3)-V(1,2)*P(2,3))*EQ(2,2)+(V(1,3)*P(2,2)-V(2,3)*P(1,2))*EQ(3,3);
EQ1a(2,1) = (V(2,1)*P(3,3)-V(3,1)*P(2,3))*EQ(1,1)+(V(3,3)*P(2,1)-V(2,3)*P(3,1))*EQ(3,3);
EQ1a(2,2) = (V(3,1)*P(1,3)-V(1,1)*P(3,3))*EQ(1,1)+(V(1,3)*P(3,1)-V(3,3)*P(1,1))*EQ(3,3);
EQ1a(2,3) = (V(1,1)*P(2,3)-V(2,1)*P(1,3))*EQ(1,1)+(V(2,3)*P(1,1)-V(1,3)*P(2,1))*EQ(3,3);
EQ1a(3,1) = (V(3,1)*P(2,2)-V(2,1)*P(3,2))*EQ(1,1)+(V(2,2)*P(3,1)-V(3,2)*P(2,1))*EQ(2,2);
EQ1a(3,2) = (V(1,1)*P(3,2)-V(3,1)*P(1,2))*EQ(1,1)+(V(3,2)*P(1,1)-V(1,2)*P(3,1))*EQ(2,2);
EQ1a(3,3) = (V(2,1)*P(1,2)-V(1,1)*P(2,2))*EQ(1,1)+(V(1,2)*P(2,1)-V(2,2)*P(1,1))*EQ(2,2);
ERHatPvRt = U*EQ1a;

G = H*H';
EHW2 = (G-trace(G)*eye(3))*dt;

ERtdt = (ERt*(eye(3)+EHW2/2) + dt*ERHatPvRt)*expRot((omega+Miu)*dt);

[Utdt,D,Vtdt] = psvd(ERtdt);
Stdt = diag(pdf_MF_M2S(diag(D)));

%% E[x(t+dt)v'R(t+dt)]
% ExvRpt
UT = Utdt'*U;
VT = Vtdt'*expRot((omega+Miu)*dt)'*V;
ST = UT'*Stdt*VT;

EvRwpt = UT*vee(EQ*ST'-ST*EQ');

EQ2a = [ST(2,2)*EQ(2,2)+ST(3,3)*EQ(3,3), -ST(1,2)*EQ(2,2), -ST(1,3)*EQ(3,3)
    -ST(2,1)*EQ(1,1), ST(1,1)*EQ(1,1)+ST(3,3)*EQ(3,3), -ST(2,3)*EQ(3,3)
    -ST(3,1)*EQ(1,1), -ST(3,2)*EQ(2,2), ST(1,1)*EQ(1,1)+ST(2,2)*EQ(2,2)];
EvRvRwpt = EQ2a*UT';

ExvRwpt = Miu*EvRwpt'+P*EvRvRwpt;

% ExvRhatxwpt
EQ2b = [ST(2,2)*EQ(3,3)+ST(3,3)*EQ(2,2), -ST(1,2)*EQ(3,3), -ST(1,3)*EQ(2,2);
      -ST(2,1)*EQ(3,3), ST(1,1)*EQ(3,3)+ST(3,3)*EQ(1,1), -ST(2,3)*EQ(1,1);
      -ST(3,1)*EQ(2,2), -ST(3,2)*EQ(1,1), ST(1,1)*EQ(2,2)+ST(2,2)*EQ(1,1)];
EQ2b = V*EQ2b;

PV = P'*V;
EQ2c(1) = (PV(3,3)*ST(3,2)+PV(2,3)*ST(2,2)-PV(3,2)*ST(3,3)-PV(2,2)*ST(2,3))*EQ(1,1)...
    +(PV(1,3)*ST(2,1)-PV(1,1)*ST(2,3))*EQ(2,2)+(PV(1,1)*ST(3,2)-PV(1,2)*ST(3,1))*EQ(3,3);
EQ2c(2) = (PV(1,1)*ST(1,3)+PV(3,1)*ST(3,3)-PV(1,3)*ST(1,1)-PV(3,3)*ST(3,1))*EQ(2,2)...
    +(PV(2,1)*ST(3,2)-PV(2,2)*ST(3,1))*EQ(3,3)+(PV(2,2)*ST(1,3)-PV(2,3)*ST(1,2))*EQ(1,1);
EQ2c(3) = (PV(2,2)*ST(2,1)+PV(1,2)*ST(1,1)-PV(2,1)*ST(2,2)-PV(1,1)*ST(1,2))*EQ(3,3)...
    +(PV(3,2)*ST(1,3)-PV(3,3)*ST(1,2))*EQ(1,1)+(PV(3,3)*ST(2,1)-PV(3,1)*ST(2,3))*EQ(2,2);

EQ2e(1,1) = (PV(1,1)*ST(3,3)*s(2)^2-PV(1,3)*ST(3,1)*s(2)^2+PV(1,1)*ST(3,3)*s(3)^2-PV(1,3)*ST(3,1)*s(3)^2)*EQQQ(5,6,6)...
    +(2*PV(1,3)*ST(3,1)*s(2)*s(3)-2*PV(1,1)*ST(3,3)*s(2)*s(3))*EQQQ(5,6,8)...
    +(PV(1,1)*ST(2,2)*s(2)^2-PV(1,2)*ST(2,1)*s(2)^2+PV(1,1)*ST(2,2)*s(3)^2-PV(1,2)*ST(2,1)*s(3)^2)*EQQQ(9,6,6)...
    +(2*PV(1,2)*ST(2,1)*s(2)*s(3)-2*PV(1,1)*ST(2,2)*s(2)*s(3))*EQQQ(9,6,8)...
    +(PV(2,3)*ST(3,2)*s(2)*s(3)-PV(2,2)*ST(3,3)*s(2)*s(3)+PV(3,2)*ST(2,3)*s(2)*s(3)-PV(3,3)*ST(2,2)*s(2)*s(3))*EQQQ(2,6,7)...
    +(PV(3,3)*ST(2,2)*s(2)^2-PV(3,2)*ST(2,3)*s(2)^2+PV(2,2)*ST(3,3)*s(3)^2-PV(2,3)*ST(3,2)*s(3)^2)*EQQQ(4,3,6)...
    +(PV(2,2)*ST(3,3)*s(1)*s(2)-PV(2,3)*ST(3,2)*s(1)*s(2)+PV(3,2)*ST(2,3)*s(1)*s(2)-PV(3,3)*ST(2,2)*s(1)*s(2))*EQQQ(2,6,3)...
    +(PV(2,3)*ST(3,2)*s(1)*s(3)-PV(2,2)*ST(3,3)*s(1)*s(3)-PV(3,2)*ST(2,3)*s(1)*s(3)+PV(3,3)*ST(2,2)*s(1)*s(3))*EQQQ(3,8,2);
EQ2e(1,2) = (PV(1,2)*ST(3,3)*s(2)^2-PV(1,3)*ST(3,2)*s(2)^2+PV(1,2)*ST(3,3)*s(3)^2-PV(1,3)*ST(3,2)*s(3)^2)*EQQQ(1,6,6)...
    +(2*PV(1,3)*ST(3,2)*s(2)*s(3)-2*PV(1,2)*ST(3,3)*s(2)*s(3))*EQQQ(1,6,8)...
    +(PV(1,2)*ST(1,1)*s(2)^2-PV(1,1)*ST(1,2)*s(2)^2-PV(1,1)*ST(1,2)*s(3)^2+PV(1,2)*ST(1,1)*s(3)^2)*EQQQ(9,6,6)...
    +(2*PV(1,1)*ST(1,2)*s(2)*s(3)-2*PV(1,2)*ST(1,1)*s(2)*s(3))*EQQQ(9,6,8)...
    +(PV(3,3)*ST(1,2)*s(2)*s(3)-PV(3,2)*ST(1,3)*s(2)*s(3)-PV(2,1)*ST(3,3)*s(1)*s(3)+PV(2,3)*ST(3,1)*s(1)*s(3)+PV(3,1)*ST(3,2)*s(1)*s(2)-PV(3,2)*ST(3,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(3,2)*ST(1,3)*s(2)^2-PV(3,3)*ST(1,2)*s(2)^2+PV(2,1)*ST(3,3)*s(1)*s(2)-PV(2,3)*ST(3,1)*s(1)*s(2)-PV(3,1)*ST(3,2)*s(1)*s(3)+PV(3,2)*ST(3,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(2,1)*ST(3,3)*s(3)^2-PV(2,3)*ST(3,1)*s(3)^2-PV(3,2)*ST(1,3)*s(1)*s(2)+PV(3,3)*ST(1,2)*s(1)*s(2)+PV(3,1)*ST(3,2)*s(2)*s(3)-PV(3,2)*ST(3,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(3,2)*ST(3,1)*s(2)^2-PV(3,1)*ST(3,2)*s(2)^2+PV(3,2)*ST(1,3)*s(1)*s(3)-PV(3,3)*ST(1,2)*s(1)*s(3)-PV(2,1)*ST(3,3)*s(2)*s(3)+PV(2,3)*ST(3,1)*s(2)*s(3))*EQQQ(3,8,2);
EQ2e(1,3) = (PV(1,3)*ST(2,2)*s(2)^2-PV(1,2)*ST(2,3)*s(2)^2-PV(1,2)*ST(2,3)*s(3)^2+PV(1,3)*ST(2,2)*s(3)^2)*EQQQ(1,6,6)...
    +(2*PV(1,2)*ST(2,3)*s(2)*s(3)-2*PV(1,3)*ST(2,2)*s(2)*s(3))*EQQQ(1,6,8)...
    +(PV(1,3)*ST(1,1)*s(2)^2-PV(1,1)*ST(1,3)*s(2)^2-PV(1,1)*ST(1,3)*s(3)^2+PV(1,3)*ST(1,1)*s(3)^2)*EQQQ(5,6,6)...
    +(2*PV(1,1)*ST(1,3)*s(2)*s(3)-2*PV(1,3)*ST(1,1)*s(2)*s(3))*EQQQ(5,6,8)...
    +(PV(2,2)*ST(1,3)*s(2)*s(3)-PV(2,3)*ST(1,2)*s(2)*s(3)+PV(2,1)*ST(2,3)*s(1)*s(3)-PV(2,3)*ST(2,1)*s(1)*s(3)-PV(3,1)*ST(2,2)*s(1)*s(2)+PV(3,2)*ST(2,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(2,3)*ST(1,2)*s(3)^2-PV(2,2)*ST(1,3)*s(3)^2-PV(2,1)*ST(2,3)*s(1)*s(2)+PV(2,3)*ST(2,1)*s(1)*s(2)+PV(3,1)*ST(2,2)*s(1)*s(3)-PV(3,2)*ST(2,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(2,3)*ST(2,1)*s(3)^2-PV(2,1)*ST(2,3)*s(3)^2-PV(2,2)*ST(1,3)*s(1)*s(2)+PV(2,3)*ST(1,2)*s(1)*s(2)-PV(3,1)*ST(2,2)*s(2)*s(3)+PV(3,2)*ST(2,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(3,1)*ST(2,2)*s(2)^2-PV(3,2)*ST(2,1)*s(2)^2+PV(2,2)*ST(1,3)*s(1)*s(3)-PV(2,3)*ST(1,2)*s(1)*s(3)+PV(2,1)*ST(2,3)*s(2)*s(3)-PV(2,3)*ST(2,1)*s(2)*s(3))*EQQQ(3,8,2);
EQ2e(2,1) = (PV(2,1)*ST(3,3)*s(1)^2-PV(2,3)*ST(3,1)*s(1)^2+PV(2,1)*ST(3,3)*s(3)^2-PV(2,3)*ST(3,1)*s(3)^2)*EQQQ(5,3,3)...
    +(2*PV(2,3)*ST(3,1)*s(1)*s(3)-2*PV(2,1)*ST(3,3)*s(1)*s(3))*EQQQ(5,3,7)...
    +(PV(2,1)*ST(2,2)*s(1)^2-PV(2,2)*ST(2,1)*s(1)^2+PV(2,1)*ST(2,2)*s(3)^2-PV(2,2)*ST(2,1)*s(3)^2)*EQQQ(9,3,3)...
    +(2*PV(2,2)*ST(2,1)*s(1)*s(3)-2*PV(2,1)*ST(2,2)*s(1)*s(3))*EQQQ(9,3,7)...
    +(PV(1,3)*ST(3,2)*s(2)*s(3)-PV(1,2)*ST(3,3)*s(2)*s(3)-PV(3,1)*ST(2,3)*s(1)*s(3)+PV(3,3)*ST(2,1)*s(1)*s(3)-PV(3,1)*ST(3,2)*s(1)*s(2)+PV(3,2)*ST(3,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(1,2)*ST(3,3)*s(3)^2-PV(1,3)*ST(3,2)*s(3)^2-PV(3,1)*ST(2,3)*s(1)*s(2)+PV(3,3)*ST(2,1)*s(1)*s(2)-PV(3,1)*ST(3,2)*s(1)*s(3)+PV(3,2)*ST(3,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(3,1)*ST(2,3)*s(1)^2-PV(3,3)*ST(2,1)*s(1)^2+PV(1,2)*ST(3,3)*s(1)*s(2)-PV(1,3)*ST(3,2)*s(1)*s(2)+PV(3,1)*ST(3,2)*s(2)*s(3)-PV(3,2)*ST(3,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(3,1)*ST(3,2)*s(1)^2-PV(3,2)*ST(3,1)*s(1)^2-PV(1,2)*ST(3,3)*s(1)*s(3)+PV(1,3)*ST(3,2)*s(1)*s(3)+PV(3,1)*ST(2,3)*s(2)*s(3)-PV(3,3)*ST(2,1)*s(2)*s(3))*EQQQ(3,8,2);
EQ2e(2,2) = (PV(2,2)*ST(3,3)*s(1)^2-PV(2,3)*ST(3,2)*s(1)^2+PV(2,2)*ST(3,3)*s(3)^2-PV(2,3)*ST(3,2)*s(3)^2)*EQQQ(1,3,3)...
    +(2*PV(2,3)*ST(3,2)*s(1)*s(3)-2*PV(2,2)*ST(3,3)*s(1)*s(3))*EQQQ(1,3,7)...
    +(PV(2,2)*ST(1,1)*s(1)^2-PV(2,1)*ST(1,2)*s(1)^2-PV(2,1)*ST(1,2)*s(3)^2+PV(2,2)*ST(1,1)*s(3)^2)*EQQQ(9,3,3)...
    +(2*PV(2,1)*ST(1,2)*s(1)*s(3)-2*PV(2,2)*ST(1,1)*s(1)*s(3))*EQQQ(9,3,7)...
    +(PV(1,3)*ST(3,1)*s(1)*s(3)-PV(1,1)*ST(3,3)*s(1)*s(3)+PV(3,1)*ST(1,3)*s(1)*s(3)-PV(3,3)*ST(1,1)*s(1)*s(3))*EQQQ(2,6,7)...
    +(PV(1,1)*ST(3,3)*s(1)*s(2)-PV(1,3)*ST(3,1)*s(1)*s(2)+PV(3,1)*ST(1,3)*s(1)*s(2)-PV(3,3)*ST(1,1)*s(1)*s(2))*EQQQ(4,3,6)...
    +(PV(3,3)*ST(1,1)*s(1)^2-PV(3,1)*ST(1,3)*s(1)^2+PV(1,1)*ST(3,3)*s(3)^2-PV(1,3)*ST(3,1)*s(3)^2)*EQQQ(2,6,3)...
    +(PV(1,3)*ST(3,1)*s(2)*s(3)-PV(1,1)*ST(3,3)*s(2)*s(3)-PV(3,1)*ST(1,3)*s(2)*s(3)+PV(3,3)*ST(1,1)*s(2)*s(3))*EQQQ(3,8,2);
EQ2e(2,3) = (PV(2,3)*ST(2,2)*s(1)^2-PV(2,2)*ST(2,3)*s(1)^2-PV(2,2)*ST(2,3)*s(3)^2+PV(2,3)*ST(2,2)*s(3)^2)*EQQQ(1,3,3)...
    +(2*PV(2,2)*ST(2,3)*s(1)*s(3)-2*PV(2,3)*ST(2,2)*s(1)*s(3))*EQQQ(1,3,7)...
    +(PV(2,3)*ST(1,1)*s(1)^2-PV(2,1)*ST(1,3)*s(1)^2-PV(2,1)*ST(1,3)*s(3)^2+PV(2,3)*ST(1,1)*s(3)^2)*EQQQ(5,3,3)...
    +(2*PV(2,1)*ST(1,3)*s(1)*s(3)-2*PV(2,3)*ST(1,1)*s(1)*s(3))*EQQQ(5,3,7)...
    +(PV(1,2)*ST(1,3)*s(2)*s(3)-PV(1,3)*ST(1,2)*s(2)*s(3)+PV(1,1)*ST(2,3)*s(1)*s(3)-PV(1,3)*ST(2,1)*s(1)*s(3)+PV(3,1)*ST(1,2)*s(1)*s(2)-PV(3,2)*ST(1,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(1,3)*ST(1,2)*s(3)^2-PV(1,2)*ST(1,3)*s(3)^2-PV(1,1)*ST(2,3)*s(1)*s(2)+PV(1,3)*ST(2,1)*s(1)*s(2)+PV(3,1)*ST(1,2)*s(1)*s(3)-PV(3,2)*ST(1,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(1,3)*ST(2,1)*s(3)^2-PV(1,1)*ST(2,3)*s(3)^2-PV(1,2)*ST(1,3)*s(1)*s(2)+PV(1,3)*ST(1,2)*s(1)*s(2)-PV(3,1)*ST(1,2)*s(2)*s(3)+PV(3,2)*ST(1,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(3,2)*ST(1,1)*s(1)^2-PV(3,1)*ST(1,2)*s(1)^2+PV(1,2)*ST(1,3)*s(1)*s(3)-PV(1,3)*ST(1,2)*s(1)*s(3)+PV(1,1)*ST(2,3)*s(2)*s(3)-PV(1,3)*ST(2,1)*s(2)*s(3))*EQQQ(3,8,2);
EQ2e(3,1) = (PV(3,1)*ST(3,3)*s(1)^2-PV(3,3)*ST(3,1)*s(1)^2+PV(3,1)*ST(3,3)*s(2)^2-PV(3,3)*ST(3,1)*s(2)^2)*EQQQ(5,2,2)...
    +(2*PV(3,3)*ST(3,1)*s(1)*s(2)-2*PV(3,1)*ST(3,3)*s(1)*s(2))*EQQQ(5,2,4)...
    +(PV(3,1)*ST(2,2)*s(1)^2-PV(3,2)*ST(2,1)*s(1)^2+PV(3,1)*ST(2,2)*s(2)^2-PV(3,2)*ST(2,1)*s(2)^2)*EQQQ(9,2,2)...
    +(2*PV(3,2)*ST(2,1)*s(1)*s(2)-2*PV(3,1)*ST(2,2)*s(1)*s(2))*EQQQ(9,2,4)...
    +(PV(1,2)*ST(2,3)*s(2)*s(3)-PV(1,3)*ST(2,2)*s(2)*s(3)-PV(2,1)*ST(2,3)*s(1)*s(3)+PV(2,3)*ST(2,1)*s(1)*s(3)-PV(2,1)*ST(3,2)*s(1)*s(2)+PV(2,2)*ST(3,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(1,3)*ST(2,2)*s(2)^2-PV(1,2)*ST(2,3)*s(2)^2-PV(2,1)*ST(2,3)*s(1)*s(2)+PV(2,3)*ST(2,1)*s(1)*s(2)-PV(2,1)*ST(3,2)*s(1)*s(3)+PV(2,2)*ST(3,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(2,1)*ST(2,3)*s(1)^2-PV(2,3)*ST(2,1)*s(1)^2+PV(1,2)*ST(2,3)*s(1)*s(2)-PV(1,3)*ST(2,2)*s(1)*s(2)+PV(2,1)*ST(3,2)*s(2)*s(3)-PV(2,2)*ST(3,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(2,1)*ST(3,2)*s(1)^2-PV(2,2)*ST(3,1)*s(1)^2-PV(1,2)*ST(2,3)*s(1)*s(3)+PV(1,3)*ST(2,2)*s(1)*s(3)+PV(2,1)*ST(2,3)*s(2)*s(3)-PV(2,3)*ST(2,1)*s(2)*s(3))*EQQQ(3,8,2);
EQ2e(3,2) = (PV(3,2)*ST(3,3)*s(1)^2-PV(3,3)*ST(3,2)*s(1)^2+PV(3,2)*ST(3,3)*s(2)^2-PV(3,3)*ST(3,2)*s(2)^2)*EQQQ(1,2,2)...
    +(2*PV(3,3)*ST(3,2)*s(1)*s(2)-2*PV(3,2)*ST(3,3)*s(1)*s(2))*EQQQ(1,2,4)...
    +(PV(3,2)*ST(1,1)*s(1)^2-PV(3,1)*ST(1,2)*s(1)^2-PV(3,1)*ST(1,2)*s(2)^2+PV(3,2)*ST(1,1)*s(2)^2)*EQQQ(9,2,2)...
    +(2*PV(3,1)*ST(1,2)*s(1)*s(2)-2*PV(3,2)*ST(1,1)*s(1)*s(2))*EQQQ(9,2,4)...
    +(PV(1,3)*ST(1,2)*s(2)*s(3)-PV(1,2)*ST(1,3)*s(2)*s(3)+PV(2,1)*ST(1,3)*s(1)*s(3)-PV(2,3)*ST(1,1)*s(1)*s(3)+PV(1,1)*ST(3,2)*s(1)*s(2)-PV(1,2)*ST(3,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(1,2)*ST(1,3)*s(2)^2-PV(1,3)*ST(1,2)*s(2)^2+PV(2,1)*ST(1,3)*s(1)*s(2)-PV(2,3)*ST(1,1)*s(1)*s(2)-PV(1,1)*ST(3,2)*s(1)*s(3)+PV(1,2)*ST(3,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(2,3)*ST(1,1)*s(1)^2-PV(2,1)*ST(1,3)*s(1)^2-PV(1,2)*ST(1,3)*s(1)*s(2)+PV(1,3)*ST(1,2)*s(1)*s(2)+PV(1,1)*ST(3,2)*s(2)*s(3)-PV(1,2)*ST(3,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(1,2)*ST(3,1)*s(2)^2-PV(1,1)*ST(3,2)*s(2)^2+PV(1,2)*ST(1,3)*s(1)*s(3)-PV(1,3)*ST(1,2)*s(1)*s(3)-PV(2,1)*ST(1,3)*s(2)*s(3)+PV(2,3)*ST(1,1)*s(2)*s(3))*EQQQ(3,8,2);
EQ2e(3,3) = (PV(3,3)*ST(2,2)*s(1)^2-PV(3,2)*ST(2,3)*s(1)^2-PV(3,2)*ST(2,3)*s(2)^2+PV(3,3)*ST(2,2)*s(2)^2)*EQQQ(1,2,2)...
    +(2*PV(3,2)*ST(2,3)*s(1)*s(2)-2*PV(3,3)*ST(2,2)*s(1)*s(2))*EQQQ(1,2,4)...
    +(PV(3,3)*ST(1,1)*s(1)^2-PV(3,1)*ST(1,3)*s(1)^2-PV(3,1)*ST(1,3)*s(2)^2+PV(3,3)*ST(1,1)*s(2)^2)*EQQQ(5,2,2)...
    +(2*PV(3,1)*ST(1,3)*s(1)*s(2)-2*PV(3,3)*ST(1,1)*s(1)*s(2))*EQQQ(5,2,4)...
    +(PV(1,2)*ST(2,1)*s(1)*s(2)-PV(1,1)*ST(2,2)*s(1)*s(2)+PV(2,1)*ST(1,2)*s(1)*s(2)-PV(2,2)*ST(1,1)*s(1)*s(2))*EQQQ(2,6,7)...
    +(PV(1,1)*ST(2,2)*s(1)*s(3)-PV(1,2)*ST(2,1)*s(1)*s(3)+PV(2,1)*ST(1,2)*s(1)*s(3)-PV(2,2)*ST(1,1)*s(1)*s(3))*EQQQ(4,3,6)...
    +(PV(1,2)*ST(2,1)*s(2)*s(3)-PV(1,1)*ST(2,2)*s(2)*s(3)-PV(2,1)*ST(1,2)*s(2)*s(3)+PV(2,2)*ST(1,1)*s(2)*s(3))*EQQQ(2,6,3)...
    +(PV(2,2)*ST(1,1)*s(1)^2-PV(2,1)*ST(1,2)*s(1)^2+PV(1,1)*ST(2,2)*s(2)^2-PV(1,2)*ST(2,1)*s(2)^2)*EQQQ(3,8,2);

SigmaMInv = diag([S(2,2)+S(3,3),S(1,1)+S(3,3),S(1,1)+S(2,2)]);
Sigmac = Sigma-P*SigmaMInv*P';
ExvRhatxwpt = dt*(Sigmac*EQ2b+Miu*EQ2c+P*EQ2e)*UT';

% ExvRhatHWpt
VTT = Vtdt'*expRot((omega+Miu)*dt)'*G'*V;
STT = UT'*Stdt*VTT;

EvRGwpt = UT*vee(EQ*STT'-STT*EQ');

EvRvRGwpt = [STT(2,2)*EQ(2,2)+STT(3,3)*EQ(3,3), -STT(1,2)*EQ(2,2), -STT(1,3)*EQ(3,3)
    -STT(2,1)*EQ(1,1), STT(1,1)*EQ(1,1)+STT(3,3)*EQ(3,3), -STT(2,3)*EQ(3,3)
    -STT(3,1)*EQ(1,1), -STT(3,2)*EQ(2,2), STT(1,1)*EQ(1,1)+STT(2,2)*EQ(2,2)];

EvRvRGwpt = EvRvRGwpt*UT';
ExvRGwpt = Miu*EvRGwpt'+P*EvRvRGwpt;

ExvRhatHWwpt = dt*ExvRGwpt - dt*trace(G)*ExvRwpt;

% final result
ExvRptdt = ExvRwpt + ExvRhatxwpt + 0.5*ExvRhatHWwpt;

%% E[v'R(t+dt)v'R(t+dt)]
% EvRwpvRwpt
EvRwpvRwpt(1,1) = (ST(3,2)^2)*EQQ(5,5)+(-2*ST(2,3)*ST(3,2))*EQQ(5,9)+(ST(2,3)^2)*EQQ(9,9)...
    +(ST(3,1)^2)*EQQ(2,2)+(ST(2,1)^2)*EQQ(3,3)+(ST(2,2)^2+ST(3,3)^2)*EQQ(6,6)+(-2*ST(2,2)*ST(3,3))*EQQ(6,8);
EvRwpvRwpt(1,2) = (-ST(3,1)*ST(3,2))*EQQ(1,5)+(ST(2,3)*ST(3,1))*EQQ(1,9)+(ST(1,3)*ST(3,2))*EQQ(5,9)+(-ST(1,3)*ST(2,3))*EQQ(9,9)...
    +(-ST(3,1)*ST(3,2))*EQQ(2,4)+(-ST(1,1)*ST(2,1))*EQQ(3,3)+(ST(2,1)*ST(3,3))*EQQ(3,7)+(-ST(1,2)*ST(2,2))*EQQ(6,6)+(ST(1,2)*ST(3,3))*EQQ(6,8);
EvRwpvRwpt(1,3) = (ST(2,1)*ST(3,2))*EQQ(1,5)+(-ST(2,1)*ST(2,3))*EQQ(1,9)+(-ST(1,2)*ST(3,2))*EQQ(5,5)+(ST(1,2)*ST(2,3))*EQQ(5,9)...
    +(-ST(1,1)*ST(3,1))*EQQ(2,2)+(ST(2,2)*ST(3,1))*EQQ(2,4)+(-ST(2,1)*ST(2,3))*EQQ(3,7)+(-ST(1,3)*ST(3,3))*EQQ(6,6)+(ST(1,3)*ST(2,2))*EQQ(6,8);
EvRwpvRwpt(2,1) = (-ST(3,1)*ST(3,2))*EQQ(1,5)+(ST(2,3)*ST(3,1))*EQQ(1,9)+(ST(1,3)*ST(3,2))*EQQ(5,9)+(-ST(1,3)*ST(2,3))*EQQ(9,9)...
    +(-ST(3,1)*ST(3,2))*EQQ(2,4)+(-ST(1,1)*ST(2,1))*EQQ(3,3)+(ST(2,1)*ST(3,3))*EQQ(3,7) +(-ST(1,2)*ST(2,2))*EQQ(6,6)+(ST(1,2)*ST(3,3))*EQQ(6,8);
EvRwpvRwpt(2,2) = (ST(3,1)^2)*EQQ(1,1)+(-2*ST(1,3)*ST(3,1))*EQQ(1,9)+(ST(1,3)^2)*EQQ(9,9)...
    +(ST(3,2)^2)*EQQ(2,2)+(ST(1,1)^2+ST(3,3)^2)*EQQ(3,3)+(-2*ST(1,1)*ST(3,3))*EQQ(3,7)+(ST(1,2)^2)*EQQ(6,6);
EvRwpvRwpt(2,3) = (-ST(2,1)*ST(3,1))*EQQ(1,1)+(ST(1,2)*ST(3,1))*EQQ(1,5)+(ST(1,3)*ST(2,1))*EQQ(1,9)+(-ST(1,2)*ST(1,3))*EQQ(5,9)...
    +(-ST(2,2)*ST(3,2))*EQQ(2,2)+(ST(1,1)*ST(3,2))*EQQ(2,4)+(-ST(2,3)*ST(3,3))*EQQ(3,3)+(ST(1,1)*ST(2,3))*EQQ(3,7)+(-ST(1,2)*ST(1,3))*EQQ(6,8);
EvRwpvRwpt(3,1) = (ST(2,1)*ST(3,2))*EQQ(1,5)+(-ST(2,1)*ST(2,3))*EQQ(1,9)+(-ST(1,2)*ST(3,2))*EQQ(5,5)+(ST(1,2)*ST(2,3))*EQQ(5,9)...
    +(-ST(1,1)*ST(3,1))*EQQ(2,2)+(ST(2,2)*ST(3,1))*EQQ(2,4)+(-ST(2,1)*ST(2,3))*EQQ(3,7)+(-ST(1,3)*ST(3,3))*EQQ(6,6)+(ST(1,3)*ST(2,2))*EQQ(6,8);
EvRwpvRwpt(3,2) = (-ST(2,1)*ST(3,1))*EQQ(1,1)+(ST(1,2)*ST(3,1))*EQQ(1,5)+(ST(1,3)*ST(2,1))*EQQ(1,9)+(-ST(1,2)*ST(1,3))*EQQ(5,9)...
    +(-ST(2,2)*ST(3,2))*EQQ(2,2)+(ST(1,1)*ST(3,2))*EQQ(2,4)+(-ST(2,3)*ST(3,3))*EQQ(3,3)+(ST(1,1)*ST(2,3))*EQQ(3,7)+(-ST(1,2)*ST(1,3))*EQQ(6,8);
EvRwpvRwpt(3,3) = (ST(2,1)^2)*EQQ(1,1)+(-2*ST(1,2)*ST(2,1))*EQQ(1,5)+(ST(1,2)^2)*EQQ(5,5)...
    +(ST(1,1)^2+ST(2,2)^2)*EQQ(2,2)+(-2*ST(1,1)*ST(2,2))*EQQ(2,4)+(ST(2,3)^2)*EQQ(3,3)+(ST(1,3)^2)*EQQ(6,6);

EvRwpvRwpt = UT*EvRwpvRwpt*UT';

% EvRwpvRhatxwpt
EQ3b(1,1) = (PV(3,3)*ST(3,1)^2*s(1)-PV(3,3)*ST(3,2)^2*s(1)-PV(3,1)*ST(3,1)*ST(3,3)*s(1)+PV(3,2)*ST(3,2)*ST(3,3)*s(1))*EQQQ(5,2,2)...
    + (PV(3,3)*ST(3,2)^2*s(2)-PV(3,3)*ST(3,1)^2*s(2)+PV(3,1)*ST(3,1)*ST(3,3)*s(2)-PV(3,2)*ST(3,2)*ST(3,3)*s(2))*EQQQ(5,2,4)...
    + (PV(2,3)*ST(2,1)*ST(3,1)*s(1)-PV(2,1)*ST(2,1)*ST(3,3)*s(1)+PV(2,2)*ST(2,3)*ST(3,2)*s(1)-PV(2,3)*ST(2,2)*ST(3,2)*s(1))*EQQQ(5,3,3)...
    + (PV(2,1)*ST(2,1)*ST(3,3)*s(3)-PV(2,3)*ST(2,1)*ST(3,1)*s(3)-PV(2,2)*ST(2,3)*ST(3,2)*s(3)+PV(2,3)*ST(2,2)*ST(3,2)*s(3))*EQQQ(5,3,7)...
    + (PV(1,1)*ST(3,3)^2*s(3)-PV(1,1)*ST(3,2)^2*s(3)+PV(1,1)*ST(2,2)*ST(3,3)*s(2)+PV(1,1)*ST(2,3)*ST(3,2)*s(2)-PV(1,3)*ST(2,1)*ST(3,2)*s(2)-PV(1,3)*ST(2,2)*ST(3,1)*s(2)+PV(1,2)*ST(3,1)*ST(3,2)*s(3)-PV(1,3)*ST(3,1)*ST(3,3)*s(3))*EQQQ(5,6,6)...
    + (PV(1,1)*ST(3,2)^2*s(2)-PV(1,1)*ST(3,3)^2*s(2)-PV(1,1)*ST(2,2)*ST(3,3)*s(3)-PV(1,1)*ST(2,3)*ST(3,2)*s(3)+PV(1,3)*ST(2,1)*ST(3,2)*s(3)+PV(1,3)*ST(2,2)*ST(3,1)*s(3)-PV(1,2)*ST(3,1)*ST(3,2)*s(2)+PV(1,3)*ST(3,1)*ST(3,3)*s(2))*EQQQ(5,6,8)...
    + (PV(3,2)*ST(2,1)*ST(3,1)*s(1)-PV(3,1)*ST(2,2)*ST(3,1)*s(1)-PV(3,2)*ST(2,3)*ST(3,3)*s(1)+PV(3,3)*ST(2,3)*ST(3,2)*s(1))*EQQQ(9,2,2)...
    + (PV(3,1)*ST(2,2)*ST(3,1)*s(2)-PV(3,2)*ST(2,1)*ST(3,1)*s(2)+PV(3,2)*ST(2,3)*ST(3,3)*s(2)-PV(3,3)*ST(2,3)*ST(3,2)*s(2))*EQQQ(9,2,4)...
    + (PV(2,2)*ST(2,1)^2*s(1)-PV(2,2)*ST(2,3)^2*s(1)-PV(2,1)*ST(2,1)*ST(2,2)*s(1)+PV(2,3)*ST(2,2)*ST(2,3)*s(1))*EQQQ(9,3,3)...
    + (PV(2,2)*ST(2,3)^2*s(3)-PV(2,2)*ST(2,1)^2*s(3)+PV(2,1)*ST(2,1)*ST(2,2)*s(3)-PV(2,3)*ST(2,2)*ST(2,3)*s(3))*EQQQ(9,3,7)...
    + (PV(1,1)*ST(2,2)^2*s(2)-PV(1,1)*ST(2,3)^2*s(2)-PV(1,2)*ST(2,1)*ST(2,2)*s(2)+PV(1,3)*ST(2,1)*ST(2,3)*s(2)+PV(1,1)*ST(2,2)*ST(3,3)*s(3)+PV(1,1)*ST(2,3)*ST(3,2)*s(3)-PV(1,2)*ST(2,1)*ST(3,3)*s(3)-PV(1,2)*ST(2,3)*ST(3,1)*s(3))*EQQQ(9,6,6)...
    + (PV(1,1)*ST(2,3)^2*s(3)-PV(1,1)*ST(2,2)^2*s(3)+PV(1,2)*ST(2,1)*ST(2,2)*s(3)-PV(1,3)*ST(2,1)*ST(2,3)*s(3)-PV(1,1)*ST(2,2)*ST(3,3)*s(2)-PV(1,1)*ST(2,3)*ST(3,2)*s(2)+PV(1,2)*ST(2,1)*ST(3,3)*s(2)+PV(1,2)*ST(2,3)*ST(3,1)*s(2))*EQQQ(9,6,8)...
    + (PV(2,1)*ST(2,3)*ST(3,1)*s(3)-PV(2,3)*ST(2,1)*ST(3,1)*s(3)-PV(2,2)*ST(2,2)*ST(3,3)*s(3)+PV(2,3)*ST(2,2)*ST(3,2)*s(3)+PV(3,1)*ST(2,1)*ST(3,2)*s(2)-PV(3,2)*ST(2,1)*ST(3,1)*s(2)+PV(3,2)*ST(2,3)*ST(3,3)*s(2)-PV(3,3)*ST(2,2)*ST(3,3)*s(2))*EQQQ(2,6,7)...
    + (PV(3,3)*ST(2,2)^2*s(2)-PV(3,3)*ST(2,1)^2*s(2)-PV(2,2)*ST(3,1)^2*s(3)+PV(2,2)*ST(3,3)^2*s(3)+PV(3,1)*ST(2,1)*ST(2,3)*s(2)-PV(3,2)*ST(2,2)*ST(2,3)*s(2)+PV(2,1)*ST(3,1)*ST(3,2)*s(3)-PV(2,3)*ST(3,2)*ST(3,3)*s(3))*EQQQ(4,3,6)...
    + (PV(3,3)*ST(2,1)^2*s(1)-PV(3,3)*ST(2,2)^2*s(1)-PV(1,2)*ST(2,1)*ST(3,3)*s(2)-PV(1,2)*ST(2,3)*ST(3,1)*s(2)+PV(1,3)*ST(2,1)*ST(3,2)*s(2)+PV(1,3)*ST(2,2)*ST(3,1)*s(2)-PV(2,1)*ST(2,3)*ST(3,1)*s(1)+PV(2,3)*ST(2,1)*ST(3,1)*s(1)-PV(3,1)*ST(2,1)*ST(2,3)*s(1)+PV(2,2)*ST(2,2)*ST(3,3)*s(1)-PV(2,3)*ST(2,2)*ST(3,2)*s(1)+PV(3,2)*ST(2,2)*ST(2,3)*s(1))*EQQQ(2,6,3)...
    + (PV(2,2)*ST(3,1)^2*s(1)-PV(2,2)*ST(3,3)^2*s(1)+PV(1,2)*ST(2,1)*ST(3,3)*s(3)+PV(1,2)*ST(2,3)*ST(3,1)*s(3)-PV(1,3)*ST(2,1)*ST(3,2)*s(3)-PV(1,3)*ST(2,2)*ST(3,1)*s(3)-PV(2,1)*ST(3,1)*ST(3,2)*s(1)-PV(3,1)*ST(2,1)*ST(3,2)*s(1)+PV(3,2)*ST(2,1)*ST(3,1)*s(1)+PV(2,3)*ST(3,2)*ST(3,3)*s(1)-PV(3,2)*ST(2,3)*ST(3,3)*s(1)+PV(3,3)*ST(2,2)*ST(3,3)*s(1))*EQQQ(3,8,2);
EQ3b(1,2) = (PV(3,3)*ST(3,1)*ST(3,2)*s(1)-PV(3,2)*ST(3,1)*ST(3,3)*s(1))*EQQQ(1,2,2)...
    + (PV(3,2)*ST(3,1)*ST(3,3)*s(2)-PV(3,3)*ST(3,1)*ST(3,2)*s(2))*EQQQ(1,2,4)...
    + (PV(2,3)*ST(2,1)*ST(3,2)*s(1)-PV(2,2)*ST(2,1)*ST(3,3)*s(1))*EQQQ(1,3,3)...
    + (PV(2,2)*ST(2,1)*ST(3,3)*s(3)-PV(2,3)*ST(2,1)*ST(3,2)*s(3))*EQQQ(1,3,7)...
    + (PV(1,2)*ST(3,3)^2*s(3)+PV(1,2)*ST(2,2)*ST(3,3)*s(2)-PV(1,3)*ST(2,2)*ST(3,2)*s(2)-PV(1,3)*ST(3,2)*ST(3,3)*s(3))*EQQQ(1,6,6)...
    + (PV(1,3)*ST(2,2)*ST(3,2)*s(3)-PV(1,2)*ST(2,2)*ST(3,3)*s(3)-PV(1,2)*ST(3,3)^2*s(2)+PV(1,3)*ST(3,2)*ST(3,3)*s(2))*EQQQ(1,6,8)...
    + (PV(3,3)*ST(3,1)*ST(3,2)*s(2)-PV(3,1)*ST(3,2)*ST(3,3)*s(2))*EQQQ(5,2,2)...
    + (PV(3,1)*ST(3,2)*ST(3,3)*s(1)-PV(3,3)*ST(3,1)*ST(3,2)*s(1))*EQQQ(5,2,4)...
    + (PV(2,3)*ST(1,2)*ST(3,2)*s(1)-PV(2,2)*ST(1,3)*ST(3,2)*s(1)-PV(2,1)*ST(3,2)^2*s(3)+PV(2,2)*ST(3,1)*ST(3,2)*s(3))*EQQQ(5,3,3)...
    + (PV(2,1)*ST(3,2)^2*s(1)+PV(2,2)*ST(1,3)*ST(3,2)*s(3)-PV(2,3)*ST(1,2)*ST(3,2)*s(3)-PV(2,2)*ST(3,1)*ST(3,2)*s(1))*EQQQ(5,3,7)...
    + (PV(1,3)*ST(1,1)*ST(3,2)*s(2)-PV(1,1)*ST(1,3)*ST(3,2)*s(2))*EQQQ(5,6,6)...
    + (PV(1,1)*ST(1,3)*ST(3,2)*s(3)-PV(1,3)*ST(1,1)*ST(3,2)*s(3))*EQQQ(5,6,8)...
    + (PV(3,1)*ST(1,2)*ST(3,1)*s(1)-PV(3,2)*ST(1,1)*ST(3,1)*s(1)+PV(3,1)*ST(2,3)*ST(3,3)*s(2)-PV(3,3)*ST(2,3)*ST(3,1)*s(2))*EQQQ(9,2,2)...
    + (PV(3,2)*ST(1,1)*ST(3,1)*s(2)-PV(3,1)*ST(1,2)*ST(3,1)*s(2)-PV(3,1)*ST(2,3)*ST(3,3)*s(1)+PV(3,3)*ST(2,3)*ST(3,1)*s(1))*EQQQ(9,2,4)...
    + (PV(2,1)*ST(1,2)*ST(2,1)*s(1)-PV(2,2)*ST(1,1)*ST(2,1)*s(1)+PV(2,2)*ST(1,3)*ST(2,3)*s(1)-PV(2,3)*ST(1,2)*ST(2,3)*s(1)+PV(2,1)*ST(2,3)*ST(3,2)*s(3)-PV(2,2)*ST(2,3)*ST(3,1)*s(3))*EQQQ(9,3,3)...
    + (PV(2,2)*ST(1,1)*ST(2,1)*s(3)-PV(2,1)*ST(1,2)*ST(2,1)*s(3)-PV(2,2)*ST(1,3)*ST(2,3)*s(3)+PV(2,3)*ST(1,2)*ST(2,3)*s(3)-PV(2,1)*ST(2,3)*ST(3,2)*s(1)+PV(2,2)*ST(2,3)*ST(3,1)*s(1))*EQQQ(9,3,7)...
    + (PV(1,2)*ST(1,1)*ST(2,2)*s(2)-PV(1,1)*ST(1,2)*ST(2,2)*s(2)+PV(1,1)*ST(1,3)*ST(2,3)*s(2)-PV(1,3)*ST(1,1)*ST(2,3)*s(2)-PV(1,1)*ST(1,2)*ST(3,3)*s(3)+PV(1,2)*ST(1,1)*ST(3,3)*s(3))*EQQQ(9,6,6)...
    + (PV(1,1)*ST(1,2)*ST(2,2)*s(3)-PV(1,2)*ST(1,1)*ST(2,2)*s(3)-PV(1,1)*ST(1,3)*ST(2,3)*s(3)+PV(1,3)*ST(1,1)*ST(2,3)*s(3)+PV(1,1)*ST(1,2)*ST(3,3)*s(2)-PV(1,2)*ST(1,1)*ST(3,3)*s(2))*EQQQ(9,6,8)...
    + (PV(1,2)*ST(3,1)^2*s(2)-PV(2,1)*ST(3,3)^2*s(1)+PV(1,1)*ST(2,1)*ST(3,3)*s(3)-PV(1,3)*ST(2,1)*ST(3,1)*s(3)-PV(2,1)*ST(1,3)*ST(3,1)*s(3)+PV(2,3)*ST(1,1)*ST(3,1)*s(3)-PV(1,1)*ST(3,1)*ST(3,2)*s(2)-PV(3,2)*ST(1,3)*ST(3,3)*s(2)+PV(3,3)*ST(1,2)*ST(3,3)*s(2)+PV(3,1)*ST(2,2)*ST(3,2)*s(1)-PV(3,2)*ST(2,2)*ST(3,1)*s(1)+PV(2,3)*ST(3,1)*ST(3,3)*s(1))*EQQQ(2,6,7)...
    + (PV(1,3)*ST(2,1)*ST(3,1)*s(2)-PV(1,1)*ST(2,1)*ST(3,3)*s(2)-PV(1,2)*ST(3,1)^2*s(3)-PV(3,1)*ST(1,3)*ST(2,1)*s(2)+PV(3,3)*ST(1,1)*ST(2,1)*s(2)+PV(3,2)*ST(1,3)*ST(2,2)*s(2)-PV(3,3)*ST(1,2)*ST(2,2)*s(2)+PV(1,1)*ST(3,1)*ST(3,2)*s(3)+PV(2,1)*ST(2,2)*ST(3,3)*s(1)-PV(2,3)*ST(2,2)*ST(3,1)*s(1)-PV(3,1)*ST(3,2)*ST(3,3)*s(1)+PV(3,2)*ST(3,1)*ST(3,3)*s(1))*EQQQ(4,3,6)...
    + (PV(2,1)*ST(3,3)^2*s(3)+PV(1,2)*ST(1,3)*ST(3,1)*s(2)-PV(1,3)*ST(1,2)*ST(3,1)*s(2)+PV(2,1)*ST(1,3)*ST(3,1)*s(1)-PV(2,3)*ST(1,1)*ST(3,1)*s(1)+PV(3,1)*ST(1,3)*ST(2,1)*s(1)-PV(3,3)*ST(1,1)*ST(2,1)*s(1)-PV(3,2)*ST(1,3)*ST(2,2)*s(1)+PV(3,3)*ST(1,2)*ST(2,2)*s(1)-PV(2,3)*ST(3,1)*ST(3,3)*s(3)+PV(3,1)*ST(3,2)*ST(3,3)*s(2)-PV(3,2)*ST(3,1)*ST(3,3)*s(2))*EQQQ(2,6,3)...
    + (PV(1,3)*ST(1,2)*ST(3,1)*s(3)-PV(1,2)*ST(1,3)*ST(3,1)*s(3)-PV(2,1)*ST(2,2)*ST(3,3)*s(3)+PV(2,3)*ST(2,2)*ST(3,1)*s(3)+PV(3,2)*ST(1,3)*ST(3,3)*s(1)-PV(3,3)*ST(1,2)*ST(3,3)*s(1)-PV(3,1)*ST(2,2)*ST(3,2)*s(2)+PV(3,2)*ST(2,2)*ST(3,1)*s(2))*EQQQ(3,8,2);
EQ3b(1,3) = (PV(3,2)*ST(2,3)*ST(3,1)*s(1)-PV(3,3)*ST(2,2)*ST(3,1)*s(1))*EQQQ(1,2,2)...
    + (PV(3,3)*ST(2,2)*ST(3,1)*s(2)-PV(3,2)*ST(2,3)*ST(3,1)*s(2))*EQQQ(1,2,4)...
    + (PV(2,2)*ST(2,1)*ST(2,3)*s(1)-PV(2,3)*ST(2,1)*ST(2,2)*s(1))*EQQQ(1,3,3)...
    + (PV(2,3)*ST(2,1)*ST(2,2)*s(3)-PV(2,2)*ST(2,1)*ST(2,3)*s(3))*EQQQ(1,3,7)...
    + (PV(1,3)*ST(2,2)^2*s(2)-PV(1,2)*ST(2,2)*ST(2,3)*s(2)-PV(1,2)*ST(2,3)*ST(3,3)*s(3)+PV(1,3)*ST(2,2)*ST(3,3)*s(3))*EQQQ(1,6,6)...
    + (PV(1,2)*ST(2,2)*ST(2,3)*s(3)-PV(1,3)*ST(2,2)^2*s(3)+PV(1,2)*ST(2,3)*ST(3,3)*s(2)-PV(1,3)*ST(2,2)*ST(3,3)*s(2))*EQQQ(1,6,8)...
    + (PV(3,1)*ST(1,3)*ST(3,1)*s(1)-PV(3,3)*ST(1,1)*ST(3,1)*s(1)-PV(3,2)*ST(1,3)*ST(3,2)*s(1)+PV(3,3)*ST(1,2)*ST(3,2)*s(1)+PV(3,1)*ST(2,3)*ST(3,2)*s(2)-PV(3,3)*ST(2,1)*ST(3,2)*s(2))*EQQQ(5,2,2)...
    + (PV(3,3)*ST(1,1)*ST(3,1)*s(2)-PV(3,1)*ST(1,3)*ST(3,1)*s(2)+PV(3,2)*ST(1,3)*ST(3,2)*s(2)-PV(3,3)*ST(1,2)*ST(3,2)*s(2)-PV(3,1)*ST(2,3)*ST(3,2)*s(1)+PV(3,3)*ST(2,1)*ST(3,2)*s(1))*EQQQ(5,2,4)...
    + (PV(2,1)*ST(1,3)*ST(2,1)*s(1)-PV(2,3)*ST(1,1)*ST(2,1)*s(1)+PV(2,1)*ST(2,2)*ST(3,2)*s(3)-PV(2,2)*ST(2,1)*ST(3,2)*s(3))*EQQQ(5,3,3)...
    + (PV(2,3)*ST(1,1)*ST(2,1)*s(3)-PV(2,1)*ST(1,3)*ST(2,1)*s(3)-PV(2,1)*ST(2,2)*ST(3,2)*s(1)+PV(2,2)*ST(2,1)*ST(3,2)*s(1))*EQQQ(5,3,7)...
    + (PV(1,3)*ST(1,1)*ST(2,2)*s(2)-PV(1,1)*ST(1,3)*ST(2,2)*s(2)+PV(1,1)*ST(1,2)*ST(3,2)*s(3)-PV(1,2)*ST(1,1)*ST(3,2)*s(3)-PV(1,1)*ST(1,3)*ST(3,3)*s(3)+PV(1,3)*ST(1,1)*ST(3,3)*s(3))*EQQQ(5,6,6)...
    + (PV(1,1)*ST(1,3)*ST(2,2)*s(3)-PV(1,3)*ST(1,1)*ST(2,2)*s(3)-PV(1,1)*ST(1,2)*ST(3,2)*s(2)+PV(1,2)*ST(1,1)*ST(3,2)*s(2)+PV(1,1)*ST(1,3)*ST(3,3)*s(2)-PV(1,3)*ST(1,1)*ST(3,3)*s(2))*EQQQ(5,6,8)...
    + (PV(3,2)*ST(1,3)*ST(2,3)*s(1)-PV(3,1)*ST(2,3)^2*s(2)-PV(3,3)*ST(1,2)*ST(2,3)*s(1)+PV(3,3)*ST(2,1)*ST(2,3)*s(2))*EQQQ(9,2,2)...
    + (PV(3,1)*ST(2,3)^2*s(1)-PV(3,2)*ST(1,3)*ST(2,3)*s(2)+PV(3,3)*ST(1,2)*ST(2,3)*s(2)-PV(3,3)*ST(2,1)*ST(2,3)*s(1))*EQQQ(9,2,4)...
    + (PV(2,2)*ST(2,1)*ST(2,3)*s(3)-PV(2,1)*ST(2,2)*ST(2,3)*s(3))*EQQQ(9,3,3) +(PV(2,1)*ST(2,2)*ST(2,3)*s(1)-PV(2,2)*ST(2,1)*ST(2,3)*s(1))*EQQQ(9,3,7)...
    + (PV(1,2)*ST(1,1)*ST(2,3)*s(3)-PV(1,1)*ST(1,2)*ST(2,3)*s(3))*EQQQ(9,6,6) +(PV(1,1)*ST(1,2)*ST(2,3)*s(2)-PV(1,2)*ST(1,1)*ST(2,3)*s(2))*EQQQ(9,6,8)...
    + (PV(1,3)*ST(2,1)^2*s(3)-PV(3,1)*ST(2,2)^2*s(1)-PV(1,1)*ST(2,1)*ST(2,3)*s(3)+PV(2,2)*ST(1,3)*ST(2,2)*s(3)-PV(2,3)*ST(1,2)*ST(2,2)*s(3)+PV(1,1)*ST(2,2)*ST(3,1)*s(2)-PV(1,2)*ST(2,1)*ST(3,1)*s(2)-PV(3,1)*ST(1,2)*ST(2,1)*s(2)+PV(3,2)*ST(1,1)*ST(2,1)*s(2)+PV(3,2)*ST(2,1)*ST(2,2)*s(1)+PV(2,1)*ST(2,3)*ST(3,3)*s(1)-PV(2,3)*ST(2,1)*ST(3,3)*s(1))*EQQQ(2,6,7)...
    + (PV(1,1)*ST(2,1)*ST(2,3)*s(2)-PV(1,3)*ST(2,1)^2*s(2)-PV(1,1)*ST(2,2)*ST(3,1)*s(3)+PV(1,2)*ST(2,1)*ST(3,1)*s(3)-PV(2,1)*ST(1,2)*ST(3,1)*s(3)-PV(2,1)*ST(2,2)*ST(2,3)*s(1)+PV(2,2)*ST(1,1)*ST(3,1)*s(3)+PV(2,3)*ST(2,1)*ST(2,2)*s(1)-PV(2,2)*ST(1,3)*ST(3,3)*s(3)+PV(2,3)*ST(1,2)*ST(3,3)*s(3)+PV(3,1)*ST(2,2)*ST(3,3)*s(1)-PV(3,2)*ST(2,1)*ST(3,3)*s(1))*EQQQ(4,3,6)...
    + (PV(1,2)*ST(1,3)*ST(2,1)*s(2)-PV(1,3)*ST(1,2)*ST(2,1)*s(2)-PV(2,2)*ST(1,3)*ST(2,2)*s(1)+PV(2,3)*ST(1,2)*ST(2,2)*s(1)-PV(2,1)*ST(2,3)*ST(3,3)*s(3)+PV(2,3)*ST(2,1)*ST(3,3)*s(3)-PV(3,1)*ST(2,2)*ST(3,3)*s(2)+PV(3,2)*ST(2,1)*ST(3,3)*s(2))*EQQQ(2,6,3)...
    + (PV(3,1)*ST(2,2)^2*s(2)-PV(1,2)*ST(1,3)*ST(2,1)*s(3)+PV(1,3)*ST(1,2)*ST(2,1)*s(3)+PV(2,1)*ST(1,2)*ST(3,1)*s(1)-PV(2,2)*ST(1,1)*ST(3,1)*s(1)+PV(3,1)*ST(1,2)*ST(2,1)*s(1)-PV(3,2)*ST(1,1)*ST(2,1)*s(1)+PV(2,1)*ST(2,2)*ST(2,3)*s(3)+PV(2,2)*ST(1,3)*ST(3,3)*s(1)-PV(2,3)*ST(1,2)*ST(3,3)*s(1)-PV(2,3)*ST(2,1)*ST(2,2)*s(3)-PV(3,2)*ST(2,1)*ST(2,2)*s(2))*EQQQ(3,8,2);
EQ3b(2,1) = (PV(3,3)*ST(3,1)*ST(3,2)*s(1)-PV(3,2)*ST(3,1)*ST(3,3)*s(1))*EQQQ(1,2,2)...
    + (PV(3,2)*ST(3,1)*ST(3,3)*s(2)-PV(3,3)*ST(3,1)*ST(3,2)*s(2))*EQQQ(1,2,4)...
    + (PV(2,3)*ST(2,2)*ST(3,1)*s(1)-PV(2,2)*ST(2,3)*ST(3,1)*s(1))*EQQQ(1,3,3)...
    + (PV(2,2)*ST(2,3)*ST(3,1)*s(3)-PV(2,3)*ST(2,2)*ST(3,1)*s(3))*EQQQ(1,3,7)...
    + (PV(1,3)*ST(2,1)*ST(3,1)*s(2)-PV(1,1)*ST(2,3)*ST(3,1)*s(2)-PV(1,2)*ST(3,1)^2*s(3)+PV(1,1)*ST(3,1)*ST(3,2)*s(3))*EQQQ(1,6,6)...
    + (PV(1,2)*ST(3,1)^2*s(2)+PV(1,1)*ST(2,3)*ST(3,1)*s(3)-PV(1,3)*ST(2,1)*ST(3,1)*s(3)-PV(1,1)*ST(3,1)*ST(3,2)*s(2))*EQQQ(1,6,8)...
    + (PV(3,3)*ST(3,1)*ST(3,2)*s(2)-PV(3,1)*ST(3,2)*ST(3,3)*s(2))*EQQQ(5,2,2) +(PV(3,1)*ST(3,2)*ST(3,3)*s(1)-PV(3,3)*ST(3,1)*ST(3,2)*s(1))*EQQQ(5,2,4)...
    + (PV(2,1)*ST(3,3)^2*s(3)+PV(2,1)*ST(1,1)*ST(3,3)*s(1)-PV(2,3)*ST(1,1)*ST(3,1)*s(1)-PV(2,3)*ST(3,1)*ST(3,3)*s(3))*EQQQ(5,3,3)...
    + (PV(2,3)*ST(1,1)*ST(3,1)*s(3)-PV(2,1)*ST(1,1)*ST(3,3)*s(3)-PV(2,1)*ST(3,3)^2*s(1)+PV(2,3)*ST(3,1)*ST(3,3)*s(1))*EQQQ(5,3,7)...
    + (PV(1,3)*ST(1,2)*ST(3,1)*s(2)-PV(1,1)*ST(1,2)*ST(3,3)*s(2))*EQQQ(5,6,6) +(PV(1,1)*ST(1,2)*ST(3,3)*s(3)-PV(1,3)*ST(1,2)*ST(3,1)*s(3))*EQQQ(5,6,8)...
    + (PV(3,2)*ST(1,3)*ST(3,3)*s(1)-PV(3,3)*ST(1,3)*ST(3,2)*s(1)-PV(3,1)*ST(2,2)*ST(3,2)*s(2)+PV(3,2)*ST(2,1)*ST(3,2)*s(2))*EQQQ(9,2,2)...
    + (PV(3,3)*ST(1,3)*ST(3,2)*s(2)-PV(3,2)*ST(1,3)*ST(3,3)*s(2)+PV(3,1)*ST(2,2)*ST(3,2)*s(1)-PV(3,2)*ST(2,1)*ST(3,2)*s(1))*EQQQ(9,2,4)...
    + (PV(2,1)*ST(1,1)*ST(2,2)*s(1)-PV(2,2)*ST(1,1)*ST(2,1)*s(1)+PV(2,2)*ST(1,3)*ST(2,3)*s(1)-PV(2,3)*ST(1,3)*ST(2,2)*s(1)+PV(2,1)*ST(2,2)*ST(3,3)*s(3)-PV(2,2)*ST(2,1)*ST(3,3)*s(3))*EQQQ(9,3,3)...
    + (PV(2,2)*ST(1,1)*ST(2,1)*s(3)-PV(2,1)*ST(1,1)*ST(2,2)*s(3)-PV(2,2)*ST(1,3)*ST(2,3)*s(3)+PV(2,3)*ST(1,3)*ST(2,2)*s(3)-PV(2,1)*ST(2,2)*ST(3,3)*s(1)+PV(2,2)*ST(2,1)*ST(3,3)*s(1))*EQQQ(9,3,7)...
    + (PV(1,2)*ST(1,2)*ST(2,1)*s(2)-PV(1,1)*ST(1,2)*ST(2,2)*s(2)+PV(1,1)*ST(1,3)*ST(2,3)*s(2)-PV(1,3)*ST(1,3)*ST(2,1)*s(2)-PV(1,1)*ST(1,3)*ST(3,2)*s(3)+PV(1,2)*ST(1,3)*ST(3,1)*s(3))*EQQQ(9,6,6)...
    + (PV(1,1)*ST(1,2)*ST(2,2)*s(3)-PV(1,2)*ST(1,2)*ST(2,1)*s(3)-PV(1,1)*ST(1,3)*ST(2,3)*s(3)+PV(1,3)*ST(1,3)*ST(2,1)*s(3)+PV(1,1)*ST(1,3)*ST(3,2)*s(2)-PV(1,2)*ST(1,3)*ST(3,1)*s(2))*EQQQ(9,6,8)...
    + (PV(2,1)*ST(3,2)^2*s(1)-PV(1,2)*ST(3,3)^2*s(2)-PV(1,2)*ST(2,3)*ST(3,2)*s(3)+PV(1,3)*ST(2,2)*ST(3,2)*s(3)+PV(2,2)*ST(1,2)*ST(3,3)*s(3)-PV(2,3)*ST(1,2)*ST(3,2)*s(3)-PV(3,1)*ST(1,1)*ST(3,2)*s(2)+PV(3,2)*ST(1,1)*ST(3,1)*s(2)+PV(1,3)*ST(3,2)*ST(3,3)*s(2)-PV(2,2)*ST(3,1)*ST(3,2)*s(1)-PV(3,1)*ST(2,3)*ST(3,3)*s(1)+PV(3,3)*ST(2,1)*ST(3,3)*s(1))*EQQQ(2,6,7)...
    + (PV(1,2)*ST(3,3)^2*s(3)-PV(3,1)*ST(1,1)*ST(2,3)*s(2)+PV(3,3)*ST(1,1)*ST(2,1)*s(2)+PV(1,2)*ST(2,3)*ST(3,2)*s(2)-PV(1,3)*ST(2,2)*ST(3,2)*s(2)+PV(3,2)*ST(1,2)*ST(2,3)*s(2)-PV(3,3)*ST(1,2)*ST(2,2)*s(2)+PV(2,1)*ST(2,3)*ST(3,2)*s(1)-PV(2,3)*ST(2,1)*ST(3,2)*s(1)-PV(1,3)*ST(3,2)*ST(3,3)*s(3)-PV(3,1)*ST(3,2)*ST(3,3)*s(1)+PV(3,2)*ST(3,1)*ST(3,3)*s(1))*EQQQ(4,3,6)...
    + (PV(1,2)*ST(1,1)*ST(3,3)*s(2)-PV(2,1)*ST(3,2)^2*s(3)-PV(1,3)*ST(1,1)*ST(3,2)*s(2)+PV(3,1)*ST(1,1)*ST(2,3)*s(1)-PV(3,3)*ST(1,1)*ST(2,1)*s(1)-PV(2,2)*ST(1,2)*ST(3,3)*s(1)+PV(2,3)*ST(1,2)*ST(3,2)*s(1)-PV(3,2)*ST(1,2)*ST(2,3)*s(1)+PV(3,3)*ST(1,2)*ST(2,2)*s(1)+PV(2,2)*ST(3,1)*ST(3,2)*s(3)+PV(3,1)*ST(3,2)*ST(3,3)*s(2)-PV(3,2)*ST(3,1)*ST(3,3)*s(2))*EQQQ(2,6,3)...
    + (PV(1,3)*ST(1,1)*ST(3,2)*s(3)-PV(1,2)*ST(1,1)*ST(3,3)*s(3)+PV(3,1)*ST(1,1)*ST(3,2)*s(1)-PV(3,2)*ST(1,1)*ST(3,1)*s(1)-PV(2,1)*ST(2,3)*ST(3,2)*s(3)+PV(2,3)*ST(2,1)*ST(3,2)*s(3)+PV(3,1)*ST(2,3)*ST(3,3)*s(2)-PV(3,3)*ST(2,1)*ST(3,3)*s(2))*EQQQ(3,8,2);
EQ3b(2,2) = (PV(3,3)*ST(3,2)^2*s(2)-PV(3,3)*ST(3,1)^2*s(2)+PV(3,1)*ST(3,1)*ST(3,3)*s(2)-PV(3,2)*ST(3,2)*ST(3,3)*s(2))*EQQQ(1,2,2)...
    + (PV(3,3)*ST(3,1)^2*s(1)-PV(3,3)*ST(3,2)^2*s(1)-PV(3,1)*ST(3,1)*ST(3,3)*s(1)+PV(3,2)*ST(3,2)*ST(3,3)*s(1))*EQQQ(1,2,4)...
    + (PV(2,2)*ST(3,3)^2*s(3)-PV(2,2)*ST(3,1)^2*s(3)+PV(2,2)*ST(1,1)*ST(3,3)*s(1)+PV(2,2)*ST(1,3)*ST(3,1)*s(1)-PV(2,3)*ST(1,1)*ST(3,2)*s(1)-PV(2,3)*ST(1,2)*ST(3,1)*s(1)+PV(2,1)*ST(3,1)*ST(3,2)*s(3)-PV(2,3)*ST(3,2)*ST(3,3)*s(3))*EQQQ(1,3,3)...
    + (PV(2,2)*ST(3,1)^2*s(1)-PV(2,2)*ST(3,3)^2*s(1)-PV(2,2)*ST(1,1)*ST(3,3)*s(3)-PV(2,2)*ST(1,3)*ST(3,1)*s(3)+PV(2,3)*ST(1,1)*ST(3,2)*s(3)+PV(2,3)*ST(1,2)*ST(3,1)*s(3)-PV(2,1)*ST(3,1)*ST(3,2)*s(1)+PV(2,3)*ST(3,2)*ST(3,3)*s(1))*EQQQ(1,3,7)...
    + (PV(1,1)*ST(1,3)*ST(3,1)*s(2)-PV(1,3)*ST(1,1)*ST(3,1)*s(2)-PV(1,2)*ST(1,2)*ST(3,3)*s(2)+PV(1,3)*ST(1,2)*ST(3,2)*s(2))*EQQQ(1,6,6)...
    + (PV(1,3)*ST(1,1)*ST(3,1)*s(3)-PV(1,1)*ST(1,3)*ST(3,1)*s(3)+PV(1,2)*ST(1,2)*ST(3,3)*s(3)-PV(1,3)*ST(1,2)*ST(3,2)*s(3))*EQQQ(1,6,8)...
    + (PV(3,1)*ST(1,2)*ST(3,2)*s(2)-PV(3,2)*ST(1,1)*ST(3,2)*s(2)-PV(3,1)*ST(1,3)*ST(3,3)*s(2)+PV(3,3)*ST(1,3)*ST(3,1)*s(2))*EQQQ(9,2,2)...
    + (PV(3,2)*ST(1,1)*ST(3,2)*s(1)-PV(3,1)*ST(1,2)*ST(3,2)*s(1)+PV(3,1)*ST(1,3)*ST(3,3)*s(1)-PV(3,3)*ST(1,3)*ST(3,1)*s(1))*EQQQ(9,2,4)...
    + (PV(2,2)*ST(1,1)^2*s(1)-PV(2,2)*ST(1,3)^2*s(1)-PV(2,1)*ST(1,1)*ST(1,2)*s(1)+PV(2,3)*ST(1,2)*ST(1,3)*s(1)-PV(2,1)*ST(1,2)*ST(3,3)*s(3)-PV(2,1)*ST(1,3)*ST(3,2)*s(3)+PV(2,2)*ST(1,1)*ST(3,3)*s(3)+PV(2,2)*ST(1,3)*ST(3,1)*s(3))*EQQQ(9,3,3)...
    + (PV(2,2)*ST(1,3)^2*s(3)-PV(2,2)*ST(1,1)^2*s(3)+PV(2,1)*ST(1,1)*ST(1,2)*s(3)-PV(2,3)*ST(1,2)*ST(1,3)*s(3)+PV(2,1)*ST(1,2)*ST(3,3)*s(1)+PV(2,1)*ST(1,3)*ST(3,2)*s(1)-PV(2,2)*ST(1,1)*ST(3,3)*s(1)-PV(2,2)*ST(1,3)*ST(3,1)*s(1))*EQQQ(9,3,7)...
    + (PV(1,1)*ST(1,2)^2*s(2)-PV(1,1)*ST(1,3)^2*s(2)-PV(1,2)*ST(1,1)*ST(1,2)*s(2)+PV(1,3)*ST(1,1)*ST(1,3)*s(2))*EQQQ(9,6,6)...
    + (PV(1,1)*ST(1,3)^2*s(3)-PV(1,1)*ST(1,2)^2*s(3)+PV(1,2)*ST(1,1)*ST(1,2)*s(3)-PV(1,3)*ST(1,1)*ST(1,3)*s(3))*EQQQ(9,6,8)...
    + (PV(1,3)*ST(1,1)*ST(3,1)*s(3)-PV(1,1)*ST(1,1)*ST(3,3)*s(3)+PV(1,2)*ST(1,3)*ST(3,2)*s(3)-PV(1,3)*ST(1,2)*ST(3,2)*s(3)-PV(3,1)*ST(1,2)*ST(3,2)*s(1)+PV(3,2)*ST(1,2)*ST(3,1)*s(1)+PV(3,1)*ST(1,3)*ST(3,3)*s(1)-PV(3,3)*ST(1,1)*ST(3,3)*s(1))*EQQQ(2,6,7)...
    + (PV(3,3)*ST(1,2)^2*s(2)-PV(3,3)*ST(1,1)^2*s(2)+PV(1,1)*ST(1,1)*ST(3,3)*s(2)-PV(1,3)*ST(1,1)*ST(3,1)*s(2)+PV(3,1)*ST(1,1)*ST(1,3)*s(2)-PV(1,2)*ST(1,3)*ST(3,2)*s(2)+PV(1,3)*ST(1,2)*ST(3,2)*s(2)-PV(3,2)*ST(1,2)*ST(1,3)*s(2)-PV(2,1)*ST(1,2)*ST(3,3)*s(1)-PV(2,1)*ST(1,3)*ST(3,2)*s(1)+PV(2,3)*ST(1,1)*ST(3,2)*s(1)+PV(2,3)*ST(1,2)*ST(3,1)*s(1))*EQQQ(4,3,6)...
    + (PV(3,3)*ST(1,1)^2*s(1)-PV(1,1)*ST(3,2)^2*s(3)-PV(3,3)*ST(1,2)^2*s(1)+PV(1,1)*ST(3,3)^2*s(3)-PV(3,1)*ST(1,1)*ST(1,3)*s(1)+PV(3,2)*ST(1,2)*ST(1,3)*s(1)+PV(1,2)*ST(3,1)*ST(3,2)*s(3)-PV(1,3)*ST(3,1)*ST(3,3)*s(3))*EQQQ(2,6,3)...
    + (PV(1,1)*ST(3,2)^2*s(2)-PV(1,1)*ST(3,3)^2*s(2)+PV(2,1)*ST(1,2)*ST(3,3)*s(3)+PV(2,1)*ST(1,3)*ST(3,2)*s(3)-PV(2,3)*ST(1,1)*ST(3,2)*s(3)-PV(2,3)*ST(1,2)*ST(3,1)*s(3)-PV(1,2)*ST(3,1)*ST(3,2)*s(2)+PV(3,1)*ST(1,2)*ST(3,2)*s(2)-PV(3,2)*ST(1,2)*ST(3,1)*s(2)+PV(1,3)*ST(3,1)*ST(3,3)*s(2)-PV(3,1)*ST(1,3)*ST(3,3)*s(2)+PV(3,3)*ST(1,1)*ST(3,3)*s(2))*EQQQ(3,8,2);
EQ3b(2,3) = (PV(3,2)*ST(1,3)*ST(3,1)*s(1)-PV(3,3)*ST(1,2)*ST(3,1)*s(1)-PV(3,1)*ST(2,3)*ST(3,1)*s(2)+PV(3,3)*ST(2,1)*ST(3,1)*s(2)+PV(3,2)*ST(2,3)*ST(3,2)*s(2)-PV(3,3)*ST(2,2)*ST(3,2)*s(2))*EQQQ(1,2,2)...
    + (PV(3,3)*ST(1,2)*ST(3,1)*s(2)-PV(3,2)*ST(1,3)*ST(3,1)*s(2)+PV(3,1)*ST(2,3)*ST(3,1)*s(1)-PV(3,3)*ST(2,1)*ST(3,1)*s(1)-PV(3,2)*ST(2,3)*ST(3,2)*s(1)+PV(3,3)*ST(2,2)*ST(3,2)*s(1))*EQQQ(1,2,4)...
    + (PV(2,3)*ST(1,1)*ST(2,2)*s(1)-PV(2,2)*ST(1,1)*ST(2,3)*s(1)-PV(2,1)*ST(2,2)*ST(3,1)*s(3)+PV(2,2)*ST(2,1)*ST(3,1)*s(3)-PV(2,2)*ST(2,3)*ST(3,3)*s(3)+PV(2,3)*ST(2,2)*ST(3,3)*s(3))*EQQQ(1,3,3)...
    + (PV(2,2)*ST(1,1)*ST(2,3)*s(3)-PV(2,3)*ST(1,1)*ST(2,2)*s(3)+PV(2,1)*ST(2,2)*ST(3,1)*s(1)-PV(2,2)*ST(2,1)*ST(3,1)*s(1)+PV(2,2)*ST(2,3)*ST(3,3)*s(1)-PV(2,3)*ST(2,2)*ST(3,3)*s(1))*EQQQ(1,3,7)...
    + (PV(1,2)*ST(1,2)*ST(2,3)*s(2)-PV(1,3)*ST(1,2)*ST(2,2)*s(2)-PV(1,1)*ST(1,2)*ST(3,1)*s(3)+PV(1,2)*ST(1,1)*ST(3,1)*s(3))*EQQQ(1,6,6)...
    + (PV(1,3)*ST(1,2)*ST(2,2)*s(3)-PV(1,2)*ST(1,2)*ST(2,3)*s(3)+PV(1,1)*ST(1,2)*ST(3,1)*s(2)-PV(1,2)*ST(1,1)*ST(3,1)*s(2))*EQQQ(1,6,8)...
    + (PV(3,1)*ST(1,3)*ST(3,2)*s(2)-PV(3,3)*ST(1,1)*ST(3,2)*s(2))*EQQQ(5,2,2)...
    + (PV(3,3)*ST(1,1)*ST(3,2)*s(1)-PV(3,1)*ST(1,3)*ST(3,2)*s(1))*EQQQ(5,2,4)...
    + (PV(2,3)*ST(1,1)^2*s(1)-PV(2,1)*ST(1,1)*ST(1,3)*s(1)-PV(2,1)*ST(1,3)*ST(3,3)*s(3)+PV(2,3)*ST(1,1)*ST(3,3)*s(3))*EQQQ(5,3,3)...
    + (PV(2,1)*ST(1,1)*ST(1,3)*s(3)-PV(2,3)*ST(1,1)^2*s(3)+PV(2,1)*ST(1,3)*ST(3,3)*s(1)-PV(2,3)*ST(1,1)*ST(3,3)*s(1))*EQQQ(5,3,7)...
    + (PV(1,1)*ST(1,2)*ST(1,3)*s(2)-PV(1,3)*ST(1,1)*ST(1,2)*s(2))*EQQQ(5,6,6)...
    + (PV(1,3)*ST(1,1)*ST(1,2)*s(3)-PV(1,1)*ST(1,2)*ST(1,3)*s(3))*EQQQ(5,6,8)...
    + (PV(3,3)*ST(1,2)*ST(1,3)*s(1)-PV(3,2)*ST(1,3)^2*s(1)+PV(3,1)*ST(1,3)*ST(2,3)*s(2)-PV(3,3)*ST(1,3)*ST(2,1)*s(2))*EQQQ(9,2,2)...
    + (PV(3,2)*ST(1,3)^2*s(2)-PV(3,3)*ST(1,2)*ST(1,3)*s(2)-PV(3,1)*ST(1,3)*ST(2,3)*s(1)+PV(3,3)*ST(1,3)*ST(2,1)*s(1))*EQQQ(9,2,4)...
    + (PV(2,1)*ST(1,3)*ST(2,2)*s(3)-PV(2,2)*ST(1,3)*ST(2,1)*s(3))*EQQQ(9,3,3)...
    + (PV(2,2)*ST(1,3)*ST(2,1)*s(1)-PV(2,1)*ST(1,3)*ST(2,2)*s(1))*EQQQ(9,3,7)...
    + (PV(1,1)*ST(1,2)*ST(1,3)*s(3)-PV(1,2)*ST(1,1)*ST(1,3)*s(3))*EQQQ(9,6,6)...
    + (PV(1,2)*ST(1,1)*ST(1,3)*s(2)-PV(1,1)*ST(1,2)*ST(1,3)*s(2))*EQQQ(9,6,8)...
    + (PV(2,3)*ST(1,2)^2*s(3)-PV(3,2)*ST(1,1)^2*s(2)+PV(1,1)*ST(1,1)*ST(2,3)*s(3)-PV(1,3)*ST(1,1)*ST(2,1)*s(3)-PV(2,2)*ST(1,2)*ST(1,3)*s(3)+PV(3,1)*ST(1,1)*ST(1,2)*s(2)+PV(1,2)*ST(1,3)*ST(3,3)*s(2)-PV(1,3)*ST(1,2)*ST(3,3)*s(2)-PV(2,1)*ST(1,2)*ST(3,2)*s(1)+PV(2,2)*ST(1,1)*ST(3,2)*s(1)+PV(3,1)*ST(1,2)*ST(2,2)*s(1)-PV(3,2)*ST(1,2)*ST(2,1)*s(1))*EQQQ(2,6,7)...
    + (PV(1,3)*ST(1,1)*ST(2,1)*s(2)-PV(1,1)*ST(1,1)*ST(2,3)*s(2)+PV(2,1)*ST(1,2)*ST(2,3)*s(1)-PV(2,3)*ST(1,2)*ST(2,1)*s(1)-PV(1,2)*ST(1,3)*ST(3,3)*s(3)+PV(1,3)*ST(1,2)*ST(3,3)*s(3)+PV(3,1)*ST(1,2)*ST(3,3)*s(1)-PV(3,2)*ST(1,1)*ST(3,3)*s(1))*EQQQ(4,3,6)...
    + (PV(1,3)*ST(1,1)*ST(1,2)*s(2)-PV(1,2)*ST(1,1)*ST(1,3)*s(2)-PV(2,3)*ST(1,2)^2*s(1)+PV(2,2)*ST(1,2)*ST(1,3)*s(1)+PV(1,1)*ST(2,2)*ST(3,2)*s(3)-PV(1,2)*ST(2,1)*ST(3,2)*s(3)+PV(2,1)*ST(1,2)*ST(3,2)*s(3)-PV(2,2)*ST(1,1)*ST(3,2)*s(3)-PV(1,1)*ST(2,3)*ST(3,3)*s(3)+PV(1,3)*ST(2,1)*ST(3,3)*s(3)-PV(3,1)*ST(1,2)*ST(3,3)*s(2)+PV(3,2)*ST(1,1)*ST(3,3)*s(2))*EQQQ(2,6,3)...
    + (PV(3,2)*ST(1,1)^2*s(1)+PV(1,2)*ST(1,1)*ST(1,3)*s(3)-PV(1,3)*ST(1,1)*ST(1,2)*s(3)-PV(3,1)*ST(1,1)*ST(1,2)*s(1)-PV(2,1)*ST(1,2)*ST(2,3)*s(3)+PV(2,3)*ST(1,2)*ST(2,1)*s(3)-PV(1,1)*ST(2,2)*ST(3,2)*s(2)+PV(1,2)*ST(2,1)*ST(3,2)*s(2)-PV(3,1)*ST(1,2)*ST(2,2)*s(2)+PV(3,2)*ST(1,2)*ST(2,1)*s(2)+PV(1,1)*ST(2,3)*ST(3,3)*s(2)-PV(1,3)*ST(2,1)*ST(3,3)*s(2))*EQQQ(3,8,2);
EQ3b(3,1) = (PV(3,2)*ST(2,1)*ST(3,3)*s(1)-PV(3,3)*ST(2,1)*ST(3,2)*s(1))*EQQQ(1,2,2)...
    + (PV(3,3)*ST(2,1)*ST(3,2)*s(2)-PV(3,2)*ST(2,1)*ST(3,3)*s(2))*EQQQ(1,2,4)...
    + (PV(2,2)*ST(2,1)*ST(2,3)*s(1)-PV(2,3)*ST(2,1)*ST(2,2)*s(1))*EQQQ(1,3,3)...
    + (PV(2,3)*ST(2,1)*ST(2,2)*s(3)-PV(2,2)*ST(2,1)*ST(2,3)*s(3))*EQQQ(1,3,7)...
    + (PV(1,1)*ST(2,1)*ST(2,3)*s(2)-PV(1,3)*ST(2,1)^2*s(2)-PV(1,1)*ST(2,1)*ST(3,2)*s(3)+PV(1,2)*ST(2,1)*ST(3,1)*s(3))*EQQQ(1,6,6)...
    + (PV(1,3)*ST(2,1)^2*s(3)-PV(1,1)*ST(2,1)*ST(2,3)*s(3)+PV(1,1)*ST(2,1)*ST(3,2)*s(2)-PV(1,2)*ST(2,1)*ST(3,1)*s(2))*EQQQ(1,6,8)...
    + (PV(3,1)*ST(1,1)*ST(3,3)*s(1)-PV(3,3)*ST(1,1)*ST(3,1)*s(1)-PV(3,2)*ST(1,2)*ST(3,3)*s(1)+PV(3,3)*ST(1,2)*ST(3,2)*s(1)+PV(3,1)*ST(2,2)*ST(3,3)*s(2)-PV(3,3)*ST(2,2)*ST(3,1)*s(2))*EQQQ(5,2,2)...
    + (PV(3,3)*ST(1,1)*ST(3,1)*s(2)-PV(3,1)*ST(1,1)*ST(3,3)*s(2)+PV(3,2)*ST(1,2)*ST(3,3)*s(2)-PV(3,3)*ST(1,2)*ST(3,2)*s(2)-PV(3,1)*ST(2,2)*ST(3,3)*s(1)+PV(3,3)*ST(2,2)*ST(3,1)*s(1))*EQQQ(5,2,4)...
    + (PV(2,3)*ST(1,2)*ST(2,2)*s(1)-PV(2,2)*ST(1,2)*ST(2,3)*s(1)-PV(2,1)*ST(2,3)*ST(3,3)*s(3)+PV(2,3)*ST(2,3)*ST(3,1)*s(3))*EQQQ(5,3,3)...
    + (PV(2,2)*ST(1,2)*ST(2,3)*s(3)-PV(2,3)*ST(1,2)*ST(2,2)*s(3)+PV(2,1)*ST(2,3)*ST(3,3)*s(1)-PV(2,3)*ST(2,3)*ST(3,1)*s(1))*EQQQ(5,3,7)...
    + (PV(1,3)*ST(1,2)*ST(2,1)*s(2)-PV(1,1)*ST(1,2)*ST(2,3)*s(2)+PV(1,1)*ST(1,2)*ST(3,2)*s(3)-PV(1,2)*ST(1,2)*ST(3,1)*s(3)-PV(1,1)*ST(1,3)*ST(3,3)*s(3)+PV(1,3)*ST(1,3)*ST(3,1)*s(3))*EQQQ(5,6,6)...
    + (PV(1,1)*ST(1,2)*ST(2,3)*s(3)-PV(1,3)*ST(1,2)*ST(2,1)*s(3)-PV(1,1)*ST(1,2)*ST(3,2)*s(2)+PV(1,2)*ST(1,2)*ST(3,1)*s(2)+PV(1,1)*ST(1,3)*ST(3,3)*s(2)-PV(1,3)*ST(1,3)*ST(3,1)*s(2))*EQQQ(5,6,8)...
    + (PV(3,1)*ST(2,2)^2*s(2)+PV(3,1)*ST(1,1)*ST(2,2)*s(1)-PV(3,2)*ST(1,1)*ST(2,1)*s(1)-PV(3,2)*ST(2,1)*ST(2,2)*s(2))*EQQQ(9,2,2)...
    + (PV(3,2)*ST(1,1)*ST(2,1)*s(2)-PV(3,1)*ST(1,1)*ST(2,2)*s(2)-PV(3,1)*ST(2,2)^2*s(1)+PV(3,2)*ST(2,1)*ST(2,2)*s(1))*EQQQ(9,2,4)...
    + (PV(2,2)*ST(2,1)*ST(2,3)*s(3)-PV(2,1)*ST(2,2)*ST(2,3)*s(3))*EQQQ(9,3,3) +(PV(2,1)*ST(2,2)*ST(2,3)*s(1)-PV(2,2)*ST(2,1)*ST(2,3)*s(1))*EQQQ(9,3,7)...
    + (PV(1,2)*ST(1,3)*ST(2,1)*s(3)-PV(1,1)*ST(1,3)*ST(2,2)*s(3))*EQQQ(9,6,6) +(PV(1,1)*ST(1,3)*ST(2,2)*s(2)-PV(1,2)*ST(1,3)*ST(2,1)*s(2))*EQQQ(9,6,8)...
    + (PV(3,1)*ST(2,3)^2*s(1)-PV(1,3)*ST(2,2)^2*s(3)-PV(2,1)*ST(1,1)*ST(2,3)*s(3)+PV(2,3)*ST(1,1)*ST(2,1)*s(3)+PV(1,2)*ST(2,2)*ST(2,3)*s(3)+PV(1,2)*ST(2,3)*ST(3,3)*s(2)-PV(1,3)*ST(2,3)*ST(3,2)*s(2)-PV(3,2)*ST(1,3)*ST(2,3)*s(2)+PV(3,3)*ST(1,3)*ST(2,2)*s(2)-PV(2,1)*ST(2,2)*ST(3,2)*s(1)+PV(2,2)*ST(2,2)*ST(3,1)*s(1)-PV(3,3)*ST(2,1)*ST(2,3)*s(1))*EQQQ(2,6,7)...
    + (PV(1,3)*ST(2,2)^2*s(2)-PV(1,2)*ST(2,2)*ST(2,3)*s(2)-PV(2,1)*ST(1,1)*ST(3,2)*s(3)-PV(2,1)*ST(2,2)*ST(2,3)*s(1)+PV(2,2)*ST(1,1)*ST(3,1)*s(3)+PV(2,3)*ST(2,1)*ST(2,2)*s(1)-PV(1,2)*ST(2,3)*ST(3,3)*s(3)+PV(1,3)*ST(2,3)*ST(3,2)*s(3)-PV(2,2)*ST(1,3)*ST(3,3)*s(3)+PV(2,3)*ST(1,3)*ST(3,2)*s(3)+PV(3,1)*ST(2,3)*ST(3,2)*s(1)-PV(3,2)*ST(2,3)*ST(3,1)*s(1))*EQQQ(4,3,6)...
    + (PV(1,2)*ST(1,1)*ST(2,3)*s(2)-PV(1,3)*ST(1,1)*ST(2,2)*s(2)+PV(2,1)*ST(1,1)*ST(2,3)*s(1)-PV(2,3)*ST(1,1)*ST(2,1)*s(1)+PV(2,1)*ST(2,2)*ST(3,2)*s(3)-PV(2,2)*ST(2,2)*ST(3,1)*s(3)-PV(3,1)*ST(2,3)*ST(3,2)*s(2)+PV(3,2)*ST(2,3)*ST(3,1)*s(2))*EQQQ(2,6,3)...
    + (PV(1,3)*ST(1,1)*ST(2,2)*s(3)-PV(1,2)*ST(1,1)*ST(2,3)*s(3)-PV(3,1)*ST(2,3)^2*s(2)+PV(2,1)*ST(1,1)*ST(3,2)*s(1)-PV(2,2)*ST(1,1)*ST(3,1)*s(1)+PV(2,1)*ST(2,2)*ST(2,3)*s(3)+PV(2,2)*ST(1,3)*ST(3,3)*s(1)-PV(2,3)*ST(1,3)*ST(3,2)*s(1)-PV(2,3)*ST(2,1)*ST(2,2)*s(3)+PV(3,2)*ST(1,3)*ST(2,3)*s(1)-PV(3,3)*ST(1,3)*ST(2,2)*s(1)+PV(3,3)*ST(2,1)*ST(2,3)*s(2))*EQQQ(3,8,2);
EQ3b(3,2) = (PV(3,2)*ST(1,1)*ST(3,3)*s(1)-PV(3,3)*ST(1,1)*ST(3,2)*s(1)-PV(3,1)*ST(2,1)*ST(3,3)*s(2)+PV(3,3)*ST(2,1)*ST(3,1)*s(2)+PV(3,2)*ST(2,2)*ST(3,3)*s(2)-PV(3,3)*ST(2,2)*ST(3,2)*s(2))*EQQQ(1,2,2)...
    + (PV(3,3)*ST(1,1)*ST(3,2)*s(2)-PV(3,2)*ST(1,1)*ST(3,3)*s(2)+PV(3,1)*ST(2,1)*ST(3,3)*s(1)-PV(3,3)*ST(2,1)*ST(3,1)*s(1)-PV(3,2)*ST(2,2)*ST(3,3)*s(1)+PV(3,3)*ST(2,2)*ST(3,2)*s(1))*EQQQ(1,2,4)...
    + (PV(2,3)*ST(1,2)*ST(2,1)*s(1)-PV(2,2)*ST(1,3)*ST(2,1)*s(1)-PV(2,1)*ST(2,1)*ST(3,2)*s(3)+PV(2,2)*ST(2,1)*ST(3,1)*s(3)-PV(2,2)*ST(2,3)*ST(3,3)*s(3)+PV(2,3)*ST(2,3)*ST(3,2)*s(3))*EQQQ(1,3,3)...
    + (PV(2,2)*ST(1,3)*ST(2,1)*s(3)-PV(2,3)*ST(1,2)*ST(2,1)*s(3)+PV(2,1)*ST(2,1)*ST(3,2)*s(1)-PV(2,2)*ST(2,1)*ST(3,1)*s(1)+PV(2,2)*ST(2,3)*ST(3,3)*s(1)-PV(2,3)*ST(2,3)*ST(3,2)*s(1))*EQQQ(1,3,7)...
    + (PV(1,3)*ST(1,1)*ST(2,1)*s(2)-PV(1,1)*ST(1,3)*ST(2,1)*s(2)-PV(1,2)*ST(1,3)*ST(3,3)*s(3)+PV(1,3)*ST(1,3)*ST(3,2)*s(3))*EQQQ(1,6,6)...
    + (PV(1,1)*ST(1,3)*ST(2,1)*s(3)-PV(1,3)*ST(1,1)*ST(2,1)*s(3)+PV(1,2)*ST(1,3)*ST(3,3)*s(2)-PV(1,3)*ST(1,3)*ST(3,2)*s(2))*EQQQ(1,6,8)...
    + (PV(3,1)*ST(1,2)*ST(3,3)*s(2)-PV(3,3)*ST(1,2)*ST(3,1)*s(2))*EQQQ(5,2,2)...
    + (PV(3,3)*ST(1,2)*ST(3,1)*s(1)-PV(3,1)*ST(1,2)*ST(3,3)*s(1))*EQQQ(5,2,4)...
    + (PV(2,2)*ST(1,2)*ST(1,3)*s(1)-PV(2,3)*ST(1,2)^2*s(1)+PV(2,1)*ST(1,2)*ST(3,2)*s(3)-PV(2,2)*ST(1,2)*ST(3,1)*s(3))*EQQQ(5,3,3)...
    + (PV(2,3)*ST(1,2)^2*s(3)-PV(2,2)*ST(1,2)*ST(1,3)*s(3)-PV(2,1)*ST(1,2)*ST(3,2)*s(1)+PV(2,2)*ST(1,2)*ST(3,1)*s(1))*EQQQ(5,3,7)...
    + (PV(1,1)*ST(1,2)*ST(1,3)*s(2)-PV(1,3)*ST(1,1)*ST(1,2)*s(2))*EQQQ(5,6,6)...
    + (PV(1,3)*ST(1,1)*ST(1,2)*s(3)-PV(1,1)*ST(1,2)*ST(1,3)*s(3))*EQQQ(5,6,8)...
    + (PV(3,2)*ST(1,1)^2*s(1)-PV(3,1)*ST(1,1)*ST(1,2)*s(1)-PV(3,1)*ST(1,2)*ST(2,2)*s(2)+PV(3,2)*ST(1,1)*ST(2,2)*s(2))*EQQQ(9,2,2)...
    + (PV(3,1)*ST(1,1)*ST(1,2)*s(2)-PV(3,2)*ST(1,1)^2*s(2)+PV(3,1)*ST(1,2)*ST(2,2)*s(1)-PV(3,2)*ST(1,1)*ST(2,2)*s(1))*EQQQ(9,2,4)...
    + (PV(2,1)*ST(1,2)*ST(2,3)*s(3)-PV(2,2)*ST(1,1)*ST(2,3)*s(3))*EQQQ(9,3,3)...
    + (PV(2,2)*ST(1,1)*ST(2,3)*s(1)-PV(2,1)*ST(1,2)*ST(2,3)*s(1))*EQQQ(9,3,7)...
    + (PV(1,1)*ST(1,2)*ST(1,3)*s(3)-PV(1,2)*ST(1,1)*ST(1,3)*s(3))*EQQQ(9,6,6)...
    + (PV(1,2)*ST(1,1)*ST(1,3)*s(2)-PV(1,1)*ST(1,2)*ST(1,3)*s(2))*EQQQ(9,6,8)...
    + (PV(3,2)*ST(1,3)^2*s(2)-PV(2,3)*ST(1,1)^2*s(3)+PV(2,1)*ST(1,1)*ST(1,3)*s(3)-PV(1,2)*ST(1,3)*ST(2,2)*s(3)+PV(1,3)*ST(1,2)*ST(2,2)*s(3)+PV(1,1)*ST(1,1)*ST(3,2)*s(2)-PV(1,2)*ST(1,1)*ST(3,1)*s(2)-PV(3,3)*ST(1,2)*ST(1,3)*s(2)+PV(2,1)*ST(1,3)*ST(3,3)*s(1)-PV(2,3)*ST(1,3)*ST(3,1)*s(1)-PV(3,1)*ST(1,3)*ST(2,3)*s(1)+PV(3,3)*ST(1,1)*ST(2,3)*s(1))*EQQQ(2,6,7)...
    + (PV(1,2)*ST(1,3)*ST(2,2)*s(2)-PV(1,3)*ST(1,2)*ST(2,2)*s(2)-PV(1,1)*ST(1,1)*ST(3,2)*s(3)+PV(1,2)*ST(1,1)*ST(3,1)*s(3)+PV(2,1)*ST(1,3)*ST(2,2)*s(1)-PV(2,3)*ST(1,1)*ST(2,2)*s(1)+PV(3,1)*ST(1,3)*ST(3,2)*s(1)-PV(3,2)*ST(1,3)*ST(3,1)*s(1))*EQQQ(4,3,6)...
    + (PV(2,3)*ST(1,1)^2*s(1)-PV(1,2)*ST(1,1)*ST(1,3)*s(2)+PV(1,3)*ST(1,1)*ST(1,2)*s(2)-PV(2,1)*ST(1,1)*ST(1,3)*s(1)+PV(1,1)*ST(2,2)*ST(3,2)*s(3)-PV(1,2)*ST(2,2)*ST(3,1)*s(3)-PV(1,1)*ST(2,3)*ST(3,3)*s(3)+PV(1,3)*ST(2,3)*ST(3,1)*s(3)-PV(2,1)*ST(1,3)*ST(3,3)*s(3)+PV(2,3)*ST(1,3)*ST(3,1)*s(3)-PV(3,1)*ST(1,3)*ST(3,2)*s(2)+PV(3,2)*ST(1,3)*ST(3,1)*s(2))*EQQQ(2,6,3)...
    + (PV(1,2)*ST(1,1)*ST(1,3)*s(3)-PV(3,2)*ST(1,3)^2*s(1)-PV(1,3)*ST(1,1)*ST(1,2)*s(3)-PV(2,1)*ST(1,3)*ST(2,2)*s(3)+PV(2,3)*ST(1,1)*ST(2,2)*s(3)+PV(3,3)*ST(1,2)*ST(1,3)*s(1)-PV(1,1)*ST(2,2)*ST(3,2)*s(2)+PV(1,2)*ST(2,2)*ST(3,1)*s(2)+PV(1,1)*ST(2,3)*ST(3,3)*s(2)-PV(1,3)*ST(2,3)*ST(3,1)*s(2)+PV(3,1)*ST(1,3)*ST(2,3)*s(2)-PV(3,3)*ST(1,1)*ST(2,3)*s(2))*EQQQ(3,8,2);
EQ3b(3,3) = (PV(3,3)*ST(2,2)^2*s(2)-PV(3,3)*ST(2,1)^2*s(2)-PV(3,2)*ST(1,1)*ST(2,3)*s(1)-PV(3,2)*ST(1,3)*ST(2,1)*s(1)+PV(3,3)*ST(1,1)*ST(2,2)*s(1)+PV(3,3)*ST(1,2)*ST(2,1)*s(1)+PV(3,1)*ST(2,1)*ST(2,3)*s(2)-PV(3,2)*ST(2,2)*ST(2,3)*s(2))*EQQQ(1,2,2)...
    + (PV(3,3)*ST(2,1)^2*s(1)-PV(3,3)*ST(2,2)^2*s(1)+PV(3,2)*ST(1,1)*ST(2,3)*s(2)+PV(3,2)*ST(1,3)*ST(2,1)*s(2)-PV(3,3)*ST(1,1)*ST(2,2)*s(2)-PV(3,3)*ST(1,2)*ST(2,1)*s(2)-PV(3,1)*ST(2,1)*ST(2,3)*s(1)+PV(3,2)*ST(2,2)*ST(2,3)*s(1))*EQQQ(1,2,4)...
    + (PV(2,2)*ST(2,3)^2*s(3)-PV(2,2)*ST(2,1)^2*s(3)+PV(2,1)*ST(2,1)*ST(2,2)*s(3)-PV(2,3)*ST(2,2)*ST(2,3)*s(3))*EQQQ(1,3,3)...
    + (PV(2,2)*ST(2,1)^2*s(1)-PV(2,2)*ST(2,3)^2*s(1)-PV(2,1)*ST(2,1)*ST(2,2)*s(1)+PV(2,3)*ST(2,2)*ST(2,3)*s(1))*EQQQ(1,3,7)...
    + (PV(1,1)*ST(1,2)*ST(2,1)*s(3)-PV(1,2)*ST(1,1)*ST(2,1)*s(3)+PV(1,2)*ST(1,3)*ST(2,3)*s(3)-PV(1,3)*ST(1,3)*ST(2,2)*s(3))*EQQQ(1,6,6)...
    + (PV(1,2)*ST(1,1)*ST(2,1)*s(2)-PV(1,1)*ST(1,2)*ST(2,1)*s(2)-PV(1,2)*ST(1,3)*ST(2,3)*s(2)+PV(1,3)*ST(1,3)*ST(2,2)*s(2))*EQQQ(1,6,8)...
    + (PV(3,3)*ST(1,1)^2*s(1)-PV(3,3)*ST(1,2)^2*s(1)-PV(3,1)*ST(1,1)*ST(1,3)*s(1)+PV(3,2)*ST(1,2)*ST(1,3)*s(1)-PV(3,1)*ST(1,2)*ST(2,3)*s(2)-PV(3,1)*ST(1,3)*ST(2,2)*s(2)+PV(3,3)*ST(1,1)*ST(2,2)*s(2)+PV(3,3)*ST(1,2)*ST(2,1)*s(2))*EQQQ(5,2,2)...
    + (PV(3,3)*ST(1,2)^2*s(2)-PV(3,3)*ST(1,1)^2*s(2)+PV(3,1)*ST(1,1)*ST(1,3)*s(2)-PV(3,2)*ST(1,2)*ST(1,3)*s(2)+PV(3,1)*ST(1,2)*ST(2,3)*s(1)+PV(3,1)*ST(1,3)*ST(2,2)*s(1)-PV(3,3)*ST(1,1)*ST(2,2)*s(1)-PV(3,3)*ST(1,2)*ST(2,1)*s(1))*EQQQ(5,2,4)...
    + (PV(2,2)*ST(1,2)*ST(2,1)*s(3)-PV(2,1)*ST(1,2)*ST(2,2)*s(3)+PV(2,1)*ST(1,3)*ST(2,3)*s(3)-PV(2,3)*ST(1,1)*ST(2,3)*s(3))*EQQQ(5,3,3)...
    + (PV(2,1)*ST(1,2)*ST(2,2)*s(1)-PV(2,2)*ST(1,2)*ST(2,1)*s(1)-PV(2,1)*ST(1,3)*ST(2,3)*s(1)+PV(2,3)*ST(1,1)*ST(2,3)*s(1))*EQQQ(5,3,7)...
    + (PV(1,1)*ST(1,3)^2*s(3)-PV(1,1)*ST(1,2)^2*s(3)+PV(1,2)*ST(1,1)*ST(1,2)*s(3)-PV(1,3)*ST(1,1)*ST(1,3)*s(3))*EQQQ(5,6,6)...
    + (PV(1,1)*ST(1,2)^2*s(2)-PV(1,1)*ST(1,3)^2*s(2)-PV(1,2)*ST(1,1)*ST(1,2)*s(2)+PV(1,3)*ST(1,1)*ST(1,3)*s(2))*EQQQ(5,6,8)...
    + (PV(1,2)*ST(1,1)*ST(2,1)*s(2)-PV(1,1)*ST(1,1)*ST(2,2)*s(2)-PV(1,2)*ST(1,3)*ST(2,3)*s(2)+PV(1,3)*ST(1,2)*ST(2,3)*s(2)+PV(2,1)*ST(1,2)*ST(2,2)*s(1)-PV(2,2)*ST(1,1)*ST(2,2)*s(1)-PV(2,1)*ST(1,3)*ST(2,3)*s(1)+PV(2,3)*ST(1,3)*ST(2,1)*s(1))*EQQQ(2,6,7)...
    + (PV(2,2)*ST(1,3)^2*s(3)-PV(2,2)*ST(1,1)^2*s(3)+PV(1,1)*ST(1,1)*ST(2,2)*s(3)-PV(1,2)*ST(1,1)*ST(2,1)*s(3)+PV(2,1)*ST(1,1)*ST(1,2)*s(3)+PV(1,2)*ST(1,3)*ST(2,3)*s(3)-PV(1,3)*ST(1,2)*ST(2,3)*s(3)-PV(2,3)*ST(1,2)*ST(1,3)*s(3)-PV(3,1)*ST(1,2)*ST(2,3)*s(1)-PV(3,1)*ST(1,3)*ST(2,2)*s(1)+PV(3,2)*ST(1,1)*ST(2,3)*s(1)+PV(3,2)*ST(1,3)*ST(2,1)*s(1))*EQQQ(4,3,6)...
    + (PV(1,1)*ST(2,3)^2*s(3)-PV(1,1)*ST(2,2)^2*s(3)+PV(1,2)*ST(2,1)*ST(2,2)*s(3)-PV(2,1)*ST(1,2)*ST(2,2)*s(3)+PV(2,2)*ST(1,1)*ST(2,2)*s(3)-PV(1,3)*ST(2,1)*ST(2,3)*s(3)+PV(2,1)*ST(1,3)*ST(2,3)*s(3)-PV(2,3)*ST(1,3)*ST(2,1)*s(3)+PV(3,1)*ST(1,2)*ST(2,3)*s(2)+PV(3,1)*ST(1,3)*ST(2,2)*s(2)-PV(3,2)*ST(1,1)*ST(2,3)*s(2)-PV(3,2)*ST(1,3)*ST(2,1)*s(2))*EQQQ(2,6,3)...
    + (PV(2,2)*ST(1,1)^2*s(1)+PV(1,1)*ST(2,2)^2*s(2)-PV(1,1)*ST(2,3)^2*s(2)-PV(2,2)*ST(1,3)^2*s(1)-PV(2,1)*ST(1,1)*ST(1,2)*s(1)+PV(2,3)*ST(1,2)*ST(1,3)*s(1)-PV(1,2)*ST(2,1)*ST(2,2)*s(2)+PV(1,3)*ST(2,1)*ST(2,3)*s(2))*EQQQ(3,8,2);

EvRwpvRhatxwpt = UT*EQ3b*UT';

% EvRwpvRhatHWwpt
EQ3c(1,1) = (ST(3,2)*STT(3,2))*EQQ(5,5)+(-ST(2,3)*STT(3,2)-ST(3,2)*STT(2,3))*EQQ(5,9)+(ST(2,3)*STT(2,3))*EQQ(9,9)...
    +(ST(3,1)*STT(3,1))*EQQ(2,2)+(ST(2,1)*STT(2,1))*EQQ(3,3)+(ST(2,2)*STT(2,2)+ST(3,3)*STT(3,3))*EQQ(6,6)+(-ST(2,2)*STT(3,3)-ST(3,3)*STT(2,2))*EQQ(6,8);
EQ3c(1,2) = (-ST(3,2)*STT(3,1))*EQQ(1,5)+(ST(2,3)*STT(3,1))*EQQ(1,9)+(ST(3,2)*STT(1,3))*EQQ(5,9)+(-ST(2,3)*STT(1,3))*EQQ(9,9)...
    +(-ST(3,1)*STT(3,2))*EQQ(2,4)+(-ST(2,1)*STT(1,1))*EQQ(3,3)+(ST(2,1)*STT(3,3))*EQQ(3,7)+(-ST(2,2)*STT(1,2))*EQQ(6,6)+(ST(3,3)*STT(1,2))*EQQ(6,8);
EQ3c(1,3) = (ST(3,2)*STT(2,1))*EQQ(1,5)+(-ST(2,3)*STT(2,1))*EQQ(1,9)+(-ST(3,2)*STT(1,2))*EQQ(5,5)+(ST(2,3)*STT(1,2))*EQQ(5,9)...
    +(-ST(3,1)*STT(1,1))*EQQ(2,2)+(ST(3,1)*STT(2,2))*EQQ(2,4)+(-ST(2,1)*STT(2,3))*EQQ(3,7)+(-ST(3,3)*STT(1,3))*EQQ(6,6)+(ST(2,2)*STT(1,3))*EQQ(6,8);
EQ3c(2,1) = (-ST(3,1)*STT(3,2))*EQQ(1,5)+(ST(3,1)*STT(2,3))*EQQ(1,9)+(ST(1,3)*STT(3,2))*EQQ(5,9)+(-ST(1,3)*STT(2,3))*EQQ(9,9)...
    +(-ST(3,2)*STT(3,1))*EQQ(2,4)+(-ST(1,1)*STT(2,1))*EQQ(3,3)+(ST(3,3)*STT(2,1))*EQQ(3,7)+(-ST(1,2)*STT(2,2))*EQQ(6,6)+(ST(1,2)*STT(3,3))*EQQ(6,8);
EQ3c(2,2) = (ST(3,1)*STT(3,1))*EQQ(1,1)+(-ST(1,3)*STT(3,1)-ST(3,1)*STT(1,3))*EQQ(1,9)+(ST(1,3)*STT(1,3))*EQQ(9,9)...
    +(ST(3,2)*STT(3,2))*EQQ(2,2)+(ST(1,1)*STT(1,1)+ST(3,3)*STT(3,3))*EQQ(3,3)+(-ST(1,1)*STT(3,3)-ST(3,3)*STT(1,1))*EQQ(3,7)+(ST(1,2)*STT(1,2))*EQQ(6,6);
EQ3c(2,3) = (-ST(3,1)*STT(2,1))*EQQ(1,1)+(ST(3,1)*STT(1,2))*EQQ(1,5)+(ST(1,3)*STT(2,1))*EQQ(1,9)+(-ST(1,3)*STT(1,2))*EQQ(5,9)...
    +(-ST(3,2)*STT(2,2))*EQQ(2,2)+(ST(3,2)*STT(1,1))*EQQ(2,4)+(-ST(3,3)*STT(2,3))*EQQ(3,3)+(ST(1,1)*STT(2,3))*EQQ(3,7)+(-ST(1,2)*STT(1,3))*EQQ(6,8);
EQ3c(3,1) = (ST(2,1)*STT(3,2))*EQQ(1,5)+(-ST(2,1)*STT(2,3))*EQQ(1,9)+(-ST(1,2)*STT(3,2))*EQQ(5,5)+(ST(1,2)*STT(2,3))*EQQ(5,9)...
    +(-ST(1,1)*STT(3,1))*EQQ(2,2)+(ST(2,2)*STT(3,1))*EQQ(2,4)+(-ST(2,3)*STT(2,1))*EQQ(3,7)+(-ST(1,3)*STT(3,3))*EQQ(6,6)+(ST(1,3)*STT(2,2))*EQQ(6,8);
EQ3c(3,2) = (-ST(2,1)*STT(3,1))*EQQ(1,1)+(ST(1,2)*STT(3,1))*EQQ(1,5)+(ST(2,1)*STT(1,3))*EQQ(1,9)+(-ST(1,2)*STT(1,3))*EQQ(5,9)...
    +(-ST(2,2)*STT(3,2))*EQQ(2,2)+(ST(1,1)*STT(3,2))*EQQ(2,4)+(-ST(2,3)*STT(3,3))*EQQ(3,3)+(ST(2,3)*STT(1,1))*EQQ(3,7)+(-ST(1,3)*STT(1,2))*EQQ(6,8);
EQ3c(3,3) = (ST(2,1)*STT(2,1))*EQQ(1,1)+(-ST(1,2)*STT(2,1)-ST(2,1)*STT(1,2))*EQQ(1,5)+(ST(1,2)*STT(1,2))*EQQ(5,5)...
    +(ST(1,1)*STT(1,1)+ST(2,2)*STT(2,2))*EQQ(2,2)+(-ST(1,1)*STT(2,2)-ST(2,2)*STT(1,1))*EQQ(2,4)+(ST(2,3)*STT(2,3))*EQQ(3,3)+(ST(1,3)*STT(1,3))*EQQ(6,6);
EvRwpvRGwpt = UT*EQ3c*UT';

EvRwpvRhatHWwpt = dt*EvRwpvRGwpt - dt*trace(G)*EvRwpvRwpt;

% EvRhatHWwpvRhatHWwpt
GT = V'*G*V;

EQ3d(1,1) = (GT(1,1)*ST(3,3)^2+GT(3,3)*ST(3,1)^2-GT(1,3)*ST(3,1)*ST(3,3)-GT(3,1)*ST(3,1)*ST(3,3))*EQQ(5,5)...
    + (2*GT(1,1)*ST(2,2)*ST(3,3)-GT(1,2)*ST(2,1)*ST(3,3)-GT(1,3)*ST(2,2)*ST(3,1)-GT(2,1)*ST(2,1)*ST(3,3)+GT(2,3)*ST(2,1)*ST(3,1)-GT(3,1)*ST(2,2)*ST(3,1)+GT(3,2)*ST(2,1)*ST(3,1))*EQQ(5,9)...
    + (GT(1,1)*ST(2,2)^2+GT(2,2)*ST(2,1)^2-GT(1,2)*ST(2,1)*ST(2,2)-GT(2,1)*ST(2,1)*ST(2,2))*EQQ(9,9)...
    + (GT(2,2)*ST(3,3)^2+GT(3,3)*ST(3,2)^2-GT(2,3)*ST(3,2)*ST(3,3)-GT(3,2)*ST(3,2)*ST(3,3))*EQQ(2,2)...
    + (GT(2,2)*ST(2,3)^2+GT(3,3)*ST(2,2)^2-GT(2,3)*ST(2,2)*ST(2,3)-GT(3,2)*ST(2,2)*ST(2,3))*EQQ(3,3)...
    + (GT(1,1)*ST(2,3)^2+GT(1,1)*ST(3,2)^2+GT(2,2)*ST(3,1)^2+GT(3,3)*ST(2,1)^2-GT(1,3)*ST(2,1)*ST(2,3)-GT(1,2)*ST(3,1)*ST(3,2)-GT(3,1)*ST(2,1)*ST(2,3)-GT(2,1)*ST(3,1)*ST(3,2))*EQQ(6,6)...
    + (2*GT(1,1)*ST(2,3)*ST(3,2)-GT(1,2)*ST(2,3)*ST(3,1)-GT(1,3)*ST(2,1)*ST(3,2)-GT(2,1)*ST(2,3)*ST(3,1)+GT(2,3)*ST(2,1)*ST(3,1)-GT(3,1)*ST(2,1)*ST(3,2)+GT(3,2)*ST(2,1)*ST(3,1))*EQQ(6,8);
EQ3d(1,2) = (GT(1,2)*ST(3,3)^2-GT(1,3)*ST(3,2)*ST(3,3)-GT(3,2)*ST(3,1)*ST(3,3)+GT(3,3)*ST(3,1)*ST(3,2))*EQQ(1,5)...
    + (GT(1,2)*ST(2,2)*ST(3,3)-GT(1,3)*ST(2,2)*ST(3,2)-GT(2,2)*ST(2,1)*ST(3,3)+GT(2,3)*ST(2,1)*ST(3,2))*EQQ(1,9)...
    + (GT(1,2)*ST(1,1)*ST(3,3)-GT(1,1)*ST(1,2)*ST(3,3)+GT(3,1)*ST(1,2)*ST(3,1)-GT(3,2)*ST(1,1)*ST(3,1))*EQQ(5,9)...
    + (GT(1,2)*ST(1,1)*ST(2,2)-GT(1,1)*ST(1,2)*ST(2,2)+GT(2,1)*ST(1,2)*ST(2,1)-GT(2,2)*ST(1,1)*ST(2,1))*EQQ(9,9)...
    + (GT(2,1)*ST(3,3)^2-GT(2,3)*ST(3,1)*ST(3,3)-GT(3,1)*ST(3,2)*ST(3,3)+GT(3,3)*ST(3,1)*ST(3,2))*EQQ(2,4)...
    + (GT(2,3)*ST(1,2)*ST(2,3)-GT(2,2)*ST(1,3)*ST(2,3)+GT(3,2)*ST(1,3)*ST(2,2)-GT(3,3)*ST(1,2)*ST(2,2))*EQQ(3,3)...
    + (GT(2,1)*ST(2,3)*ST(3,2)-GT(2,2)*ST(2,3)*ST(3,1)-GT(3,1)*ST(2,2)*ST(3,2)+GT(3,2)*ST(2,2)*ST(3,1))*EQQ(3,7)...
    + (GT(1,3)*ST(1,1)*ST(2,3)-GT(1,1)*ST(1,3)*ST(2,3)+GT(3,1)*ST(1,3)*ST(2,1)-GT(3,3)*ST(1,1)*ST(2,1))*EQQ(6,6)...
    + (GT(1,3)*ST(1,1)*ST(3,2)-GT(1,1)*ST(1,3)*ST(3,2)+GT(2,1)*ST(1,3)*ST(3,1)-GT(2,3)*ST(1,1)*ST(3,1))*EQQ(6,8);
EQ3d(1,3) = (GT(1,3)*ST(2,2)*ST(3,3)-GT(1,2)*ST(2,3)*ST(3,3)+GT(3,2)*ST(2,3)*ST(3,1)-GT(3,3)*ST(2,2)*ST(3,1))*EQQ(1,5)...
    + (GT(1,3)*ST(2,2)^2-GT(1,2)*ST(2,2)*ST(2,3)+GT(2,2)*ST(2,1)*ST(2,3)-GT(2,3)*ST(2,1)*ST(2,2))*EQQ(1,9)...
    + (GT(1,3)*ST(1,1)*ST(3,3)-GT(1,1)*ST(1,3)*ST(3,3)+GT(3,1)*ST(1,3)*ST(3,1)-GT(3,3)*ST(1,1)*ST(3,1))*EQQ(5,5)...
    + (GT(1,3)*ST(1,1)*ST(2,2)-GT(1,1)*ST(1,3)*ST(2,2)+GT(2,1)*ST(1,3)*ST(2,1)-GT(2,3)*ST(1,1)*ST(2,1))*EQQ(5,9)...
    + (GT(2,3)*ST(1,2)*ST(3,3)-GT(2,2)*ST(1,3)*ST(3,3)+GT(3,2)*ST(1,3)*ST(3,2)-GT(3,3)*ST(1,2)*ST(3,2))*EQQ(2,2)...
    + (GT(2,3)*ST(2,1)*ST(3,3)-GT(2,1)*ST(2,3)*ST(3,3)+GT(3,1)*ST(2,3)*ST(3,2)-GT(3,3)*ST(2,1)*ST(3,2))*EQQ(2,4)...
    + (GT(3,1)*ST(2,2)^2-GT(2,1)*ST(2,2)*ST(2,3)+GT(2,2)*ST(2,1)*ST(2,3)-GT(3,2)*ST(2,1)*ST(2,2))*EQQ(3,7)...
    + (GT(1,2)*ST(1,1)*ST(3,2)-GT(1,1)*ST(1,2)*ST(3,2)+GT(2,1)*ST(1,2)*ST(3,1)-GT(2,2)*ST(1,1)*ST(3,1))*EQQ(6,6)...
    + (GT(1,2)*ST(1,1)*ST(2,3)-GT(1,1)*ST(1,2)*ST(2,3)+GT(3,1)*ST(1,2)*ST(2,1)-GT(3,2)*ST(1,1)*ST(2,1))*EQQ(6,8);
EQ3d(2,1) = (GT(2,1)*ST(3,3)^2-GT(2,3)*ST(3,1)*ST(3,3)-GT(3,1)*ST(3,2)*ST(3,3)+GT(3,3)*ST(3,1)*ST(3,2))*EQQ(1,5)...
    + (GT(2,1)*ST(2,2)*ST(3,3)-GT(2,2)*ST(2,1)*ST(3,3)-GT(3,1)*ST(2,2)*ST(3,2)+GT(3,2)*ST(2,1)*ST(3,2))*EQQ(1,9)...
    + (GT(1,3)*ST(1,2)*ST(3,1)-GT(1,1)*ST(1,2)*ST(3,3)+GT(2,1)*ST(1,1)*ST(3,3)-GT(2,3)*ST(1,1)*ST(3,1))*EQQ(5,9)...
    + (GT(1,2)*ST(1,2)*ST(2,1)-GT(1,1)*ST(1,2)*ST(2,2)+GT(2,1)*ST(1,1)*ST(2,2)-GT(2,2)*ST(1,1)*ST(2,1))*EQQ(9,9)...
    + (GT(1,2)*ST(3,3)^2-GT(1,3)*ST(3,2)*ST(3,3)-GT(3,2)*ST(3,1)*ST(3,3)+GT(3,3)*ST(3,1)*ST(3,2))*EQQ(2,4)...
    + (GT(2,3)*ST(1,3)*ST(2,2)-GT(2,2)*ST(1,3)*ST(2,3)+GT(3,2)*ST(1,2)*ST(2,3)-GT(3,3)*ST(1,2)*ST(2,2))*EQQ(3,3)...
    + (GT(1,2)*ST(2,3)*ST(3,2)-GT(1,3)*ST(2,2)*ST(3,2)-GT(2,2)*ST(2,3)*ST(3,1)+GT(2,3)*ST(2,2)*ST(3,1))*EQQ(3,7)...
    + (GT(1,3)*ST(1,3)*ST(2,1)-GT(1,1)*ST(1,3)*ST(2,3)+GT(3,1)*ST(1,1)*ST(2,3)-GT(3,3)*ST(1,1)*ST(2,1))*EQQ(6,6)...
    + (GT(1,2)*ST(1,3)*ST(3,1)-GT(1,1)*ST(1,3)*ST(3,2)+GT(3,1)*ST(1,1)*ST(3,2)-GT(3,2)*ST(1,1)*ST(3,1))*EQQ(6,8);
EQ3d(2,2) = (GT(2,2)*ST(3,3)^2+GT(3,3)*ST(3,2)^2-GT(2,3)*ST(3,2)*ST(3,3)-GT(3,2)*ST(3,2)*ST(3,3))*EQQ(1,1)...
    + (GT(1,3)*ST(1,2)*ST(3,2)-GT(1,2)*ST(1,2)*ST(3,3)-GT(2,1)*ST(1,2)*ST(3,3)+2*GT(2,2)*ST(1,1)*ST(3,3)-GT(2,3)*ST(1,1)*ST(3,2)+GT(3,1)*ST(1,2)*ST(3,2)-GT(3,2)*ST(1,1)*ST(3,2))*EQQ(1,9)...
    + (GT(1,1)*ST(1,2)^2+GT(2,2)*ST(1,1)^2-GT(1,2)*ST(1,1)*ST(1,2)-GT(2,1)*ST(1,1)*ST(1,2))*EQQ(9,9)...
    + (GT(1,1)*ST(3,3)^2+GT(3,3)*ST(3,1)^2-GT(1,3)*ST(3,1)*ST(3,3)-GT(3,1)*ST(3,1)*ST(3,3))*EQQ(2,2)...
    + (GT(2,2)*ST(1,3)^2+GT(1,1)*ST(3,2)^2+GT(3,3)*ST(1,2)^2+GT(2,2)*ST(3,1)^2-GT(2,3)*ST(1,2)*ST(1,3)-GT(3,2)*ST(1,2)*ST(1,3)-GT(1,2)*ST(3,1)*ST(3,2)-GT(2,1)*ST(3,1)*ST(3,2))*EQQ(3,3)...
    + (GT(1,3)*ST(1,2)*ST(3,2)-GT(1,2)*ST(1,3)*ST(3,2)-GT(2,1)*ST(1,3)*ST(3,2)+2*GT(2,2)*ST(1,3)*ST(3,1)-GT(2,3)*ST(1,2)*ST(3,1)+GT(3,1)*ST(1,2)*ST(3,2)-GT(3,2)*ST(1,2)*ST(3,1))*EQQ(3,7)...
    + (GT(1,1)*ST(1,3)^2+GT(3,3)*ST(1,1)^2-GT(1,3)*ST(1,1)*ST(1,3)-GT(3,1)*ST(1,1)*ST(1,3))*EQQ(6,6);
EQ3d(2,3) = (GT(2,3)*ST(2,2)*ST(3,3)-GT(2,2)*ST(2,3)*ST(3,3)+GT(3,2)*ST(2,3)*ST(3,2)-GT(3,3)*ST(2,2)*ST(3,2))*EQQ(1,1)...
    + (GT(2,3)*ST(1,1)*ST(3,3)-GT(2,1)*ST(1,3)*ST(3,3)+GT(3,1)*ST(1,3)*ST(3,2)-GT(3,3)*ST(1,1)*ST(3,2))*EQQ(1,5)...
    + (GT(1,2)*ST(1,2)*ST(2,3)-GT(1,3)*ST(1,2)*ST(2,2)-GT(2,2)*ST(1,1)*ST(2,3)+GT(2,3)*ST(1,1)*ST(2,2))*EQQ(1,9)...
    + (GT(2,3)*ST(1,1)^2+GT(1,1)*ST(1,2)*ST(1,3)-GT(1,3)*ST(1,1)*ST(1,2)-GT(2,1)*ST(1,1)*ST(1,3))*EQQ(5,9)...
    + (GT(1,3)*ST(2,1)*ST(3,3)-GT(1,1)*ST(2,3)*ST(3,3)+GT(3,1)*ST(2,3)*ST(3,1)-GT(3,3)*ST(2,1)*ST(3,1))*EQQ(2,2)...
    + (GT(1,3)*ST(1,2)*ST(3,3)-GT(1,2)*ST(1,3)*ST(3,3)+GT(3,2)*ST(1,3)*ST(3,1)-GT(3,3)*ST(1,2)*ST(3,1))*EQQ(2,4)...
    + (GT(1,2)*ST(2,1)*ST(3,2)-GT(1,1)*ST(2,2)*ST(3,2)+GT(2,1)*ST(2,2)*ST(3,1)-GT(2,2)*ST(2,1)*ST(3,1))*EQQ(3,3)...
    + (GT(2,1)*ST(1,3)*ST(2,2)-GT(2,2)*ST(1,3)*ST(2,1)-GT(3,1)*ST(1,2)*ST(2,2)+GT(3,2)*ST(1,2)*ST(2,1))*EQQ(3,7)...
    + (GT(3,2)*ST(1,1)^2+GT(1,1)*ST(1,2)*ST(1,3)-GT(1,2)*ST(1,1)*ST(1,3)-GT(3,1)*ST(1,1)*ST(1,2))*EQQ(6,8);
EQ3d(3,1) = (GT(2,3)*ST(2,3)*ST(3,1)-GT(2,1)*ST(2,3)*ST(3,3)+GT(3,1)*ST(2,2)*ST(3,3)-GT(3,3)*ST(2,2)*ST(3,1))*EQQ(1,5)...
    + (GT(3,1)*ST(2,2)^2-GT(2,1)*ST(2,2)*ST(2,3)+GT(2,2)*ST(2,1)*ST(2,3)-GT(3,2)*ST(2,1)*ST(2,2))*EQQ(1,9)...
    + (GT(1,3)*ST(1,3)*ST(3,1)-GT(1,1)*ST(1,3)*ST(3,3)+GT(3,1)*ST(1,1)*ST(3,3)-GT(3,3)*ST(1,1)*ST(3,1))*EQQ(5,5)...
    + (GT(1,2)*ST(1,3)*ST(2,1)-GT(1,1)*ST(1,3)*ST(2,2)+GT(3,1)*ST(1,1)*ST(2,2)-GT(3,2)*ST(1,1)*ST(2,1))*EQQ(5,9)...
    + (GT(2,3)*ST(1,3)*ST(3,2)-GT(2,2)*ST(1,3)*ST(3,3)+GT(3,2)*ST(1,2)*ST(3,3)-GT(3,3)*ST(1,2)*ST(3,2))*EQQ(2,2)...
    + (GT(1,3)*ST(2,3)*ST(3,2)-GT(1,2)*ST(2,3)*ST(3,3)+GT(3,2)*ST(2,1)*ST(3,3)-GT(3,3)*ST(2,1)*ST(3,2))*EQQ(2,4)...
    + (GT(1,3)*ST(2,2)^2-GT(1,2)*ST(2,2)*ST(2,3)+GT(2,2)*ST(2,1)*ST(2,3)-GT(2,3)*ST(2,1)*ST(2,2))*EQQ(3,7)...
    + (GT(1,2)*ST(1,2)*ST(3,1)-GT(1,1)*ST(1,2)*ST(3,2)+GT(2,1)*ST(1,1)*ST(3,2)-GT(2,2)*ST(1,1)*ST(3,1))*EQQ(6,6)...
    + (GT(1,3)*ST(1,2)*ST(2,1)-GT(1,1)*ST(1,2)*ST(2,3)+GT(2,1)*ST(1,1)*ST(2,3)-GT(2,3)*ST(1,1)*ST(2,1))*EQQ(6,8);
EQ3d(3,2) = (GT(2,3)*ST(2,3)*ST(3,2)-GT(2,2)*ST(2,3)*ST(3,3)+GT(3,2)*ST(2,2)*ST(3,3)-GT(3,3)*ST(2,2)*ST(3,2))*EQQ(1,1)...
    + (GT(1,3)*ST(1,3)*ST(3,2)-GT(1,2)*ST(1,3)*ST(3,3)+GT(3,2)*ST(1,1)*ST(3,3)-GT(3,3)*ST(1,1)*ST(3,2))*EQQ(1,5)...
    + (GT(2,1)*ST(1,2)*ST(2,3)-GT(2,2)*ST(1,1)*ST(2,3)-GT(3,1)*ST(1,2)*ST(2,2)+GT(3,2)*ST(1,1)*ST(2,2))*EQQ(1,9)...
    + (GT(3,2)*ST(1,1)^2+GT(1,1)*ST(1,2)*ST(1,3)-GT(1,2)*ST(1,1)*ST(1,3)-GT(3,1)*ST(1,1)*ST(1,2))*EQQ(5,9)...
    + (GT(1,3)*ST(2,3)*ST(3,1)-GT(1,1)*ST(2,3)*ST(3,3)+GT(3,1)*ST(2,1)*ST(3,3)-GT(3,3)*ST(2,1)*ST(3,1))*EQQ(2,2)...
    + (GT(2,3)*ST(1,3)*ST(3,1)-GT(2,1)*ST(1,3)*ST(3,3)+GT(3,1)*ST(1,2)*ST(3,3)-GT(3,3)*ST(1,2)*ST(3,1))*EQQ(2,4)...
    + (GT(1,2)*ST(2,2)*ST(3,1)-GT(1,1)*ST(2,2)*ST(3,2)+GT(2,1)*ST(2,1)*ST(3,2)-GT(2,2)*ST(2,1)*ST(3,1))*EQQ(3,3)...
    + (GT(1,2)*ST(1,3)*ST(2,2)-GT(1,3)*ST(1,2)*ST(2,2)-GT(2,2)*ST(1,3)*ST(2,1)+GT(2,3)*ST(1,2)*ST(2,1))*EQQ(3,7)...
    + (GT(2,3)*ST(1,1)^2+GT(1,1)*ST(1,2)*ST(1,3)-GT(1,3)*ST(1,1)*ST(1,2)-GT(2,1)*ST(1,1)*ST(1,3))*EQQ(6,8);
EQ3d(3,3) = (GT(2,2)*ST(2,3)^2+GT(3,3)*ST(2,2)^2-GT(2,3)*ST(2,2)*ST(2,3)-GT(3,2)*ST(2,2)*ST(2,3))*EQQ(1,1)...
    + (GT(1,2)*ST(1,3)*ST(2,3)-GT(1,3)*ST(1,3)*ST(2,2)+GT(2,1)*ST(1,3)*ST(2,3)-GT(2,3)*ST(1,1)*ST(2,3)-GT(3,1)*ST(1,3)*ST(2,2)-GT(3,2)*ST(1,1)*ST(2,3)+2*GT(3,3)*ST(1,1)*ST(2,2))*EQQ(1,5)...
    + (GT(1,1)*ST(1,3)^2+GT(3,3)*ST(1,1)^2-GT(1,3)*ST(1,1)*ST(1,3)-GT(3,1)*ST(1,1)*ST(1,3))*EQQ(5,5)...
    + (GT(1,1)*ST(2,3)^2+GT(2,2)*ST(1,3)^2+GT(3,3)*ST(1,2)^2+GT(3,3)*ST(2,1)^2-GT(2,3)*ST(1,2)*ST(1,3)-GT(1,3)*ST(2,1)*ST(2,3)-GT(3,2)*ST(1,2)*ST(1,3)-GT(3,1)*ST(2,1)*ST(2,3))*EQQ(2,2)...
    + (GT(1,2)*ST(1,3)*ST(2,3)-GT(1,3)*ST(1,2)*ST(2,3)+GT(2,1)*ST(1,3)*ST(2,3)-GT(2,3)*ST(1,3)*ST(2,1)-GT(3,1)*ST(1,2)*ST(2,3)-GT(3,2)*ST(1,3)*ST(2,1)+2*GT(3,3)*ST(1,2)*ST(2,1))*EQQ(2,4)...
    + (GT(1,1)*ST(2,2)^2+GT(2,2)*ST(2,1)^2-GT(1,2)*ST(2,1)*ST(2,2)-GT(2,1)*ST(2,1)*ST(2,2))*EQQ(3,3)...
    + (GT(1,1)*ST(1,2)^2+GT(2,2)*ST(1,1)^2-GT(1,2)*ST(1,1)*ST(1,2)-GT(2,1)*ST(1,1)*ST(1,2))*EQQ(6,6);

EvRhatHWwpvRhatHWwpt = dt*UT*EQ3d*UT';

% final result
EvRpvRptdt = EvRwpvRwpt + dt*(EvRwpvRhatxwpt+EvRwpvRhatxwpt')...
    + 0.5*(EvRwpvRhatHWwpt+EvRwpvRhatHWwpt') + EvRhatHWwpvRhatHWwpt;

%% maximum likelihood estimation
% other necessary moments
EvRvRt(1,1) = (s(2)^2+s(3)^2)*EQQ(6,6)-2*s(2)*s(3)*EQQ(6,8);
EvRvRt(2,2) = (s(1)^2+s(3)^2)*EQQ(3,3)-2*s(1)*s(3)*EQQ(3,7);
EvRvRt(3,3) = (s(1)^2+s(2)^2)*EQQ(2,2)-2*s(1)*s(2)*EQQ(2,4);
Exxt = Sigmac+Miu*Miu'+P*EvRvRt*P';
covxxtdt = Exxt-Miu*Miu';
covxvRptdt = ExvRptdt;
covvRpvRptdt = EvRpvRptdt;

% estimation
Ptdt = covxvRptdt*covvRpvRptdt^-1;
Miutdt = Miu;
Sigmatdt = covxxtdt-Ptdt*covxvRptdt'+Ptdt*(trace(Stdt)*eye(3)-Stdt)*Ptdt' + SigmaWx;

end

