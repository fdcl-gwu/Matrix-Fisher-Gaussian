\documentclass[10pt]{article}

\usepackage{amssymb,amsmath,amsthm}
\usepackage{bm}
\usepackage{graphicx,subcaption}
\usepackage[letterpaper, top=1in, left=1in, right=1in, bottom=1in]{geometry}

\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{remark}{Remark}

\title{\vspace{-4ex}\textbf{Second moments of Matrix Fisher distribution\vspace{-4ex}}}
\date{}

\graphicspath{{./figs/}}

\begin{document}

\maketitle

\section{Non-degenerative Case}
Let $M_Q(T) = \frac{c(S+T)}{c(S)}$ be the moment generating function of $Q$.
Then for $i \neq j$
\begin{equation}
	\mathrm{E}(Q_{ij}Q_{ij}) = \frac{\partial^2 M_Q(T)}{\partial T_{ij}^2}\bigg|_{T=0}, \qquad
	\mathrm{E}(Q_{ij}Q_{ji}) = \frac{\partial^2 M_Q(T)}{\partial T_{ij} \partial T_{ji}}\bigg|_{T=0}.
\end{equation}
Let $\tilde{s}_1, \tilde{s}_2, \tilde{s}_3$ be the eigenvalues of $S+T$, then
\begin{align} \label{eqn:MGFDeriv}
	\frac{\partial^2 M_Q(T)}{\partial T_{ij}^2}\bigg|_{T=0} &= \frac{1}{c(S)}\frac{\partial}{\partial T_{ij}} \left(\sum_{k=1}^3\left(\frac{\partial c(S+T)}{\partial\tilde{s}_k}\frac{\partial \tilde{s}_k}{\partial T_{ij}}\right)\right)\bigg|_{T=0} \nonumber \\
	&= \frac{1}{c(S)}\sum_{k=1}^3\sum_{l=1}^3\left(\frac{\partial c(S+T)}{\partial\tilde{s}_k\partial\tilde{s}_l}\frac{\partial\tilde{s}_l}{\partial T_{ij}}\frac{\partial\tilde{s}_k}{\partial T_{ij}}\right)\bigg|_{T=0} + \frac{1}{c(S)}\sum_{k=1}^3\left(\frac{\partial c(S+T)}{\partial\tilde{s}_k}\frac{\partial^2\tilde{s}_k}{\partial T_{ij}^2}\right)\bigg|_{T=0} \nonumber \\
	&= \frac{1}{c(S)}\sum_{k=1}^3\sum_{l=1}^3\left(\frac{\partial c(S)}{\partial s_k\partial s_l}\frac{\partial\tilde{s}_l}{\partial T_{ij}}\bigg|_{T=0}\frac{\partial\tilde{s}_k}{\partial T_{ij}}\bigg|_{T=0}\right) + \frac{1}{c(S)}\sum_{k=1}^3\left(\frac{\partial c(S)}{\partial s_k}\frac{\partial^2\tilde{s}_k}{\partial T_{ij}^2}\bigg|_{T=0}\right).
\end{align}
$S+T$ has singular value decomposition of $S=USV^T$ when $T=0$, where $U=V=I_{3\times 3}$.
The derivatives of singular value decomposition with respect to the entries of matrix can be found in \cite{papadopoulo2000estimating}.
So we have the following equations
\begin{align} \label{eqn:SDeriv}
	\frac{\partial\tilde{s}_k}{\partial T_{ij}}\bigg|_{T=0} &= U_{ik}V_{jk}\bigg|_{T=0} = 0 \nonumber \\
	\frac{\partial^2\tilde{s}_k}{\partial T_{ij}^2}\bigg|_{T=0} &= \frac{\partial U_{ik}V_{jk}}{\partial T_{ij}}\bigg|_{T=0} = V_{jk}\frac{\partial U_{ik}}{\partial T_{ij}}\bigg|_{T=0} + U_{ik}\frac{\partial V_{jk}}{\partial T_{ij}}\bigg|_{T=0} = \delta_j^k\frac{\partial U_{ij}}{\partial T_{ij}}\bigg|_{T=0} + \delta_i^k\frac{\partial V_{ji}}{\partial T_{ij}}\bigg|_{T=0}.
\end{align}
Substitute \eqref{eqn:SDeriv} into \eqref{eqn:MGFDeriv}, we get
\begin{equation} \label{eqn:MGFijij}
	\frac{\partial^2 M_Q(T)}{\partial T_{ij}^2}\bigg|_{T=0} = \frac{1}{c(S)}\left(\frac{\partial c(S)}{\partial s_i}\frac{\partial V_{ji}}{\partial T_{ij}}\bigg|_{T=0} + \frac{\partial c(S)}{\partial s_j}\frac{\partial U_{ij}}{\partial T_{ij}}\bigg|_{T=0}\right).
\end{equation}
Similarly,
\begin{equation} \label{eqn:MGFijji}
	\frac{\partial^2 M_Q(T)}{\partial T_{ij}\partial T_{ji}}\bigg|_{T=0} = \frac{1}{c(S)}\left(\frac{\partial c(S)}{\partial s_i}\frac{\partial V_{ji}}{\partial T_{ji}}\bigg|_{T=0} + \frac{\partial c(S)}{\partial s_j}\frac{\partial U_{ij}}{\partial T_{ji}}\bigg|_{T=0}\right).
\end{equation}
From \cite{papadopoulo2000estimating}, we also have $\frac{\partial U}{\partial T_{ij}} = U\Omega_U^{ij}$ and $\frac{\partial V}{\partial T_{ij}} = -V\Omega_V^{ij}$, where $\Omega_U^{ij}$ and $\Omega_V^{ij}$ are anti-symmetric matrices with non-diagonal elements given by the solutions of
\begin{align}
	s_l\Omega_{U_{kl}}^{ij} + s_k\Omega_{V_{kl}}^{ij} &= U_{ik}V_{jl} \nonumber \\
	s_k\Omega_{U_{kl}}^{ij} + s_l\Omega_{V_{kl}}^{ij} &= -U_{il}V_{jk},
\end{align}
If $s_k \neq s_l$, after some elementary algebra, we can get
\begin{equation}
	\frac{\partial V_{ij}}{\partial T_{ij}}\big|_{T=0} = -\frac{\partial V_{ji}}{\partial T_{ij}}\big|_{T=0} = \frac{s_i}{s_j^2-s_i^2}, \qquad
	\frac{\partial U_{ij}}{\partial T_{ij}}\big|_{T=0} = -\frac{\partial U_{ji}}{\partial T_{ij}}\big|_{T=0} = \frac{s_j}{s_j^2-s_i^2}
\end{equation}
Substitute these results into \eqref{eqn:MGFijij} and \eqref{eqn:MGFijji}, we get the final result:
\begin{align} \label{eqn:secondMoments}
	\frac{\partial^2 M_Q(T)}{\partial T_{ij}^2}\bigg|_{T=0} &= \frac{1}{c(S)}\left(-\frac{\partial c(S)}{\partial s_i}\frac{s_i}{s_j^2-s_i^2}+\frac{\partial c(S)}{\partial s_j}\frac{s_j}{s_j^2-s_i^2}\right) \nonumber \\
	\frac{\partial^2 M_Q(T)}{\partial T_{ij}\partial T_{ji}}\bigg|_{T=0} &= \frac{1}{c(S)}\left(-\frac{\partial c(S)}{\partial s_i}\frac{s_j}{s_j^2-s_i^2}+\frac{\partial c(S)}{\partial s_j}\frac{s_i}{s_j^2-s_i^2}\right).
\end{align}

\section{Degenerative case}
When $s_i=s_j$, \eqref{eqn:secondMoments} does not give valid results.
I have not found a rigorous proof for this, but taking the limits of \eqref{eqn:secondMoments} as $s_i$ approaching $s_j$ is the easiest method to deal with this degenerative case.
Let $s_j=s_i+\Delta$, $c(S) = c(s_i,s_j,s_k)$, and $\partial_{mn}c(S)$ denote taking derivative with the $m-$th and $n-$th variables.
Note that when $s_i=s_j$, $\partial_1c(S) = \partial_2c(S)$, and $\partial_{11}c(S) = \partial_{22}c(S) \neq \partial_{12}c(S)$, so
\begin{align} \label{eqn: dege-Qijij}
	\frac{\partial^2 M_Q(T)}{\partial T_{ij}^2}&\bigg|_{T=0} = \frac{1}{c(S)} \lim\limits_{\Delta\to 0} \frac{1}{2s_i+\Delta} \frac{ (s_i+\Delta)\partial_2s(s_i,s_i+\Delta,s_k) - s_i\partial_1s(s_i,s_i+\Delta,s_k)}{\Delta} \nonumber \\
	&= \frac{1}{c(S)}\frac{1}{2s_i} \lim\limits_{\Delta\to 0} \frac{\partial_2c(s_i,s_i+\Delta,s_k)\Delta + s_i \left(  \partial_2c(s_i,s_i+\Delta,s_k) - \partial_1c(s_i,s_i+\Delta,s_k) \right)}{\Delta} \nonumber \\
	&= \frac{1}{c(S)}\frac{1}{2s_i} \left( \frac{\partial c(S)}{\partial s_i} + \lim\limits_{\Delta\to 0} s_i\frac{\partial_2(s_i,s_i+\Delta,s_k) - \partial_2c(s_i,s_i,s_k) + \partial_1c(s_i,s_i,s_k) - \partial_1c(s_i,s_i+\Delta,s_k)}{\Delta} \right) \nonumber \\
	&= \frac{1}{c(S)}\frac{1}{2s_i} \left( \frac{\partial c(S)}{\partial s_i} + s_i\left( \frac{\partial^2 c(S)}{\partial s_i^2} - \frac{\partial^2 c(S)}{\partial s_i \partial s_j} \right) \right)
\end{align}
Similarly,
\begin{equation} \label{eqn: dege-Qijji}
	\frac{\partial^2 M_Q(T)}{\partial T_{ij}\partial T_{ji}}\bigg|_{T=0} = \frac{1}{c(S)}\frac{1}{2s_i}\left( -\frac{\partial c(S)}{s_i} + s_i\left( \frac{\partial^2 c(S)}{\partial s_i^2} - \frac{\partial^2 c(S)}{\partial s_i \partial s_j} \right) \right)
\end{equation}
These can be verified by Monte Carlo simulations to calculate moments numerically.
If $s_i=-s_j$, then the above two equations become
\begin{align}
	\left. \frac{\partial^2 M_Q(T)}{\partial T_{ij}^2} \right|_{T=0} &= \frac{1}{c(S)} \frac{1}{2s_i} \left( \frac{\partial c(S)}{\partial s_i}  + s_i\left( \frac{\partial^2 c(S)}{\partial s_i^2} + \frac{\partial^2 c(S)}{\partial s_i \partial s_j} \right) \right), \\
	\left. \frac{\partial^2 M_Q(T)}{\partial T_{ij} \partial T_{ji}} \right|_{T=0} &= \frac{1}{c(S)} \frac{1}{2s_i} \left( \frac{\partial c(S)}{\partial s_i} - s_i\left( \frac{\partial^2 c(S)}{\partial s_i^2} + \frac{\partial^2 c(S)}{\partial s_i \partial s_j} \right) \right).
\end{align}
If $s_i=s_j=0$, first we have
\begin{align}
	\lim\limits_{s_i\to 0} \frac{1}{s_i} \frac{\partial c(S)}{\partial s_i} &= \lim\limits_{s_i\to 0} \frac{\partial_1 c(s_i,s_i,s_k)}{s_i} = \lim\limits_{s_i\to 0} \frac{\partial_1 c(s_i,s_i,s_k) - \partial_1 c(0,0,s_k)}{s_i} \nonumber \\
	&= \lim\limits_{s_i\to 0} \frac{\partial_1 c(s_i,s_i,s_k) - \partial_1 c(s_i,0,s_k) + \partial_1 c(s_i,0,s_k) - \partial_1 c(0,0,s_k)}{s_i} \nonumber \\
	&= \partial_{12} c(0,0,s_k) + \partial_{11} c(0,0,s_k).
\end{align}
Substitute this into \eqref{eqn: dege-Qijij} and \eqref{eqn: dege-Qijji}, we get
\begin{align}
	\left. \frac{\partial^2 M_Q(T)}{\partial T_{ij}^2} \right|_{T=0} = \frac{1}{c(S)} \frac{\partial^2 c(S)}{\partial s_i^2}, \qquad
	\left. \frac{\partial^2 M_Q(T)}{\partial T_{ij}T_{ji}} \right|_{T=0} = -\frac{1}{c(S)} \frac{\partial^2 c(S)}{\partial s_i \partial s_j},
\end{align}


\bibliographystyle{plain}
\bibliography{second}

\end{document}

